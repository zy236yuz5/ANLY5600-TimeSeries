<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Time Series sfdsasdasd - ARMA/ARIMA/SARIMA Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles/layout.css">
<link rel="stylesheet" href="./styles/layout.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Time Series sfdsasdasd</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./about.html">
 <span class="menu-text">ABOUT ME</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Introduction.html">
 <span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./DataSources.html">
 <span class="menu-text">Data Sources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./DataVis.html">
 <span class="menu-text">Data Visualization</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./EDA.html">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./ARModels.html" aria-current="page">
 <span class="menu-text">ARMA/ARIMA/SARIMA Models</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./ASV.html">
 <span class="menu-text">ARIMAX/SARIMAX/VAR</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./SAF.html">
 <span class="menu-text">Spectral Analysis and Filtering</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./GARCH.html">
 <span class="menu-text">Financial Time Series Models (ARCH/GARCH)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./TS.html">
 <span class="menu-text">Deep Learning for TS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./conclusion.html">
 <span class="menu-text">Conclusions</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#armaarima-analysis" id="toc-armaarima-analysis" class="nav-link active" data-scroll-target="#armaarima-analysis">ARMA/ARIMA Analysis</a>
  <ul class="collapse">
  <li><a href="#the-household-saving-data-analysis" id="toc-the-household-saving-data-analysis" class="nav-link" data-scroll-target="#the-household-saving-data-analysis">The Household Saving Data Analysis</a>
  <ul class="collapse">
  <li><a href="#acf-pacf" id="toc-acf-pacf" class="nav-link" data-scroll-target="#acf-pacf">ACF &amp; PACF</a></li>
  <li><a href="#validation-with-adf-test" id="toc-validation-with-adf-test" class="nav-link" data-scroll-target="#validation-with-adf-test">Validation with ADF Test</a></li>
  <li><a href="#detrended-and-log-transformed" id="toc-detrended-and-log-transformed" class="nav-link" data-scroll-target="#detrended-and-log-transformed">Detrended and Log-transformed</a></li>
  <li><a href="#test-it-stationary-again" id="toc-test-it-stationary-again" class="nav-link" data-scroll-target="#test-it-stationary-again">Test it stationary again</a></li>
  <li><a href="#make-it-stationary-by-using-differencing" id="toc-make-it-stationary-by-using-differencing" class="nav-link" data-scroll-target="#make-it-stationary-by-using-differencing">Make it Stationary by using differencing</a></li>
  <li><a href="#third-differencing" id="toc-third-differencing" class="nav-link" data-scroll-target="#third-differencing">Third Differencing</a></li>
  <li><a href="#evaluate-the-values-for-p-q" id="toc-evaluate-the-values-for-p-q" class="nav-link" data-scroll-target="#evaluate-the-values-for-p-q">Evaluate the values for p &amp; q</a></li>
  <li><a href="#fit-model" id="toc-fit-model" class="nav-link" data-scroll-target="#fit-model">Fit Model</a></li>
  <li><a href="#equation-of-the-model" id="toc-equation-of-the-model" class="nav-link" data-scroll-target="#equation-of-the-model">Equation of the Model</a></li>
  <li><a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics">Model diagnostics</a></li>
  <li><a href="#model-compare" id="toc-model-compare" class="nav-link" data-scroll-target="#model-compare">Model Compare</a></li>
  <li><a href="#forecasting-for-the-dataset-using-the-best-parameters" id="toc-forecasting-for-the-dataset-using-the-best-parameters" class="nav-link" data-scroll-target="#forecasting-for-the-dataset-using-the-best-parameters">Forecasting for the dataset using the best parameters</a></li>
  <li><a href="#benchmark" id="toc-benchmark" class="nav-link" data-scroll-target="#benchmark">BENCHMARK</a></li>
  </ul></li>
  <li><a href="#the-median-house-sale-price-data-analysis" id="toc-the-median-house-sale-price-data-analysis" class="nav-link" data-scroll-target="#the-median-house-sale-price-data-analysis">The Median House Sale Price Data Analysis</a>
  <ul class="collapse">
  <li><a href="#acf-pacf-1" id="toc-acf-pacf-1" class="nav-link" data-scroll-target="#acf-pacf-1">ACF &amp; PACF</a></li>
  <li><a href="#validation-with-adf-test-1" id="toc-validation-with-adf-test-1" class="nav-link" data-scroll-target="#validation-with-adf-test-1">Validation with ADF Test</a></li>
  <li><a href="#detrended-and-log-transformed-1" id="toc-detrended-and-log-transformed-1" class="nav-link" data-scroll-target="#detrended-and-log-transformed-1">Detrended and Log-transformed</a></li>
  <li><a href="#test-it-stationary-again-1" id="toc-test-it-stationary-again-1" class="nav-link" data-scroll-target="#test-it-stationary-again-1">Test it stationary again</a></li>
  <li><a href="#make-it-stationary-by-using-differencing-1" id="toc-make-it-stationary-by-using-differencing-1" class="nav-link" data-scroll-target="#make-it-stationary-by-using-differencing-1">Make it Stationary by using differencing</a></li>
  <li><a href="#fit-model-1" id="toc-fit-model-1" class="nav-link" data-scroll-target="#fit-model-1">Fit model</a></li>
  <li><a href="#equation-of-the-model-1" id="toc-equation-of-the-model-1" class="nav-link" data-scroll-target="#equation-of-the-model-1">Equation of the Model</a></li>
  <li><a href="#model-diagnostics-1" id="toc-model-diagnostics-1" class="nav-link" data-scroll-target="#model-diagnostics-1">Model diagnostics</a></li>
  <li><a href="#model-compare-1" id="toc-model-compare-1" class="nav-link" data-scroll-target="#model-compare-1">Model Compare</a></li>
  <li><a href="#forecasting-for-the-dataset" id="toc-forecasting-for-the-dataset" class="nav-link" data-scroll-target="#forecasting-for-the-dataset">Forecasting for the dataset</a></li>
  <li><a href="#benchmark-1" id="toc-benchmark-1" class="nav-link" data-scroll-target="#benchmark-1">BENCHMARK</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#sarima-analysis" id="toc-sarima-analysis" class="nav-link" data-scroll-target="#sarima-analysis">SARIMA Analysis</a>
  <ul class="collapse">
  <li><a href="#gdp-deflator-sarima-analysis" id="toc-gdp-deflator-sarima-analysis" class="nav-link" data-scroll-target="#gdp-deflator-sarima-analysis">GDP Deflator SARIMA Analysis</a>
  <ul class="collapse">
  <li><a href="#before-covid-period" id="toc-before-covid-period" class="nav-link" data-scroll-target="#before-covid-period">Before Covid Period</a></li>
  <li><a href="#check-decomposition" id="toc-check-decomposition" class="nav-link" data-scroll-target="#check-decomposition">Check Decomposition</a></li>
  <li><a href="#check-lag-plot" id="toc-check-lag-plot" class="nav-link" data-scroll-target="#check-lag-plot">Check Lag Plot</a></li>
  <li><a href="#seasonal-difference-and-acf-pacf" id="toc-seasonal-difference-and-acf-pacf" class="nav-link" data-scroll-target="#seasonal-difference-and-acf-pacf">Seasonal Difference AND ACF &amp; PACF</a></li>
  <li><a href="#model-diagnostics-2" id="toc-model-diagnostics-2" class="nav-link" data-scroll-target="#model-diagnostics-2">Model Diagnostics</a></li>
  <li><a href="#compare-the-results" id="toc-compare-the-results" class="nav-link" data-scroll-target="#compare-the-results">Compare the results</a></li>
  <li><a href="#fit-model-forecasting" id="toc-fit-model-forecasting" class="nav-link" data-scroll-target="#fit-model-forecasting">Fit model &amp; Forecasting</a></li>
  <li><a href="#benchmark-comparsion" id="toc-benchmark-comparsion" class="nav-link" data-scroll-target="#benchmark-comparsion">BenchMark Comparsion</a></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation">Cross validation</a></li>
  </ul></li>
  <li><a href="#real-median-household-income-in-the-united-states-sarima-analsyis" id="toc-real-median-household-income-in-the-united-states-sarima-analsyis" class="nav-link" data-scroll-target="#real-median-household-income-in-the-united-states-sarima-analsyis">Real Median Household Income in the United States SARIMA Analsyis</a>
  <ul class="collapse">
  <li><a href="#before-covid-period-1" id="toc-before-covid-period-1" class="nav-link" data-scroll-target="#before-covid-period-1">Before Covid Period</a></li>
  <li><a href="#check-with-decomposition" id="toc-check-with-decomposition" class="nav-link" data-scroll-target="#check-with-decomposition">Check with decomposition</a></li>
  <li><a href="#check-seasonal-pattern-using-lag" id="toc-check-seasonal-pattern-using-lag" class="nav-link" data-scroll-target="#check-seasonal-pattern-using-lag">Check Seasonal Pattern using Lag</a></li>
  <li><a href="#seasonal-difference-and-acf-pacf-1" id="toc-seasonal-difference-and-acf-pacf-1" class="nav-link" data-scroll-target="#seasonal-difference-and-acf-pacf-1">Seasonal Difference and ACF, PACF</a></li>
  <li><a href="#model-diagnostic" id="toc-model-diagnostic" class="nav-link" data-scroll-target="#model-diagnostic">Model Diagnostic</a></li>
  <li><a href="#compare-results" id="toc-compare-results" class="nav-link" data-scroll-target="#compare-results">Compare Results</a></li>
  <li><a href="#fit-model-forecast" id="toc-fit-model-forecast" class="nav-link" data-scroll-target="#fit-model-forecast">Fit model &amp; Forecast</a></li>
  <li><a href="#benchmark-comparsion-1" id="toc-benchmark-comparsion-1" class="nav-link" data-scroll-target="#benchmark-comparsion-1">BenchMark Comparsion</a></li>
  <li><a href="#cross-validation-1" id="toc-cross-validation-1" class="nav-link" data-scroll-target="#cross-validation-1">Cross validation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#references-and-codes" id="toc-references-and-codes" class="nav-link" data-scroll-target="#references-and-codes">References and Codes</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ARMA/ARIMA/SARIMA Models</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>After Exploratory Data Analysis (EDA), we are going to have a deeper understanding of the time series data by applying different models. This section involves multiple medthods and datasets with different models such as ARMA, ARIMA, SARIMA for us to gain insights and understandings such as ACF, PACF, ADF tests, differencing, and comparision. For these methods, we are going to identify correlations, stationaries, and performance evaluation.</p>
<p>To be more specific, we need to understand the concepts about the models: Certainly! Here’s a brief overview of the ARMA, ARIMA, and SARIMA models with their associated equations:</p>
<ol type="1">
<li><p><strong>ARMA</strong>:</p>
<ul>
<li><strong>Components</strong>:
<ul>
<li><strong>AR(p)</strong>: AutoRegressive term of order ( p ). It describes the relationship of the current observation with its previous values.</li>
<li><strong>MA(q)</strong>: Moving Average term of order ( q ). It captures the relationship between an observation and the white noise or error terms from previous time points.</li>
</ul></li>
<li><strong>Equation</strong>: [ X_t = c + <em>1X</em>{t-1} + <em>2X</em>{t-2} + + <em>pX</em>{t-p} + <em>1a</em>{t-1} + <em>2a</em>{t-2} + + <em>qa</em>{t-q} + a_t ] where ( a_t ) is white noise.</li>
</ul></li>
<li><p><strong>ARIMA</strong>:</p>
<ul>
<li><strong>Components</strong>:
<ul>
<li><strong>AR(p)</strong>: AutoRegressive term.</li>
<li><strong>I(d)</strong>: Integrated term of order ( d ). It represents the number of differences needed to make the series stationary.</li>
<li><strong>MA(q)</strong>: Moving Average term.</li>
</ul></li>
<li><strong>Equation</strong>: Once the series is differenced ( d ) times and becomes stationary, its ARIMA representation becomes the same as ARMA, but applied to the differenced series.</li>
</ul></li>
<li><p><strong>SARIMA</strong>:</p>
<ul>
<li><strong>Components</strong>:
<ul>
<li><strong>AR(p)</strong>: AutoRegressive term.</li>
<li><strong>I(d)</strong>: Integrated term.</li>
<li><strong>MA(q)</strong>: Moving Average term.</li>
<li><strong>SAR(P)</strong>: Seasonal AutoRegressive term of order ( P ).</li>
<li><strong>SI(D)</strong>: Seasonal Integrated term of order ( D ). It indicates the number of seasonal differences required.</li>
<li><strong>SMA(Q)</strong>: Seasonal Moving Average term of order ( Q ).</li>
</ul></li>
<li><strong>Equation</strong>: The SARIMA model combines both non-seasonal and seasonal components. Once both seasonal and non-seasonal differencing are applied (if needed), the SARIMA equation becomes an extension of the ARMA equation but with additional seasonal terms. [ X_t = c + <em>1X</em>{t-1} + + <em>pX</em>{t-p} + <em>1a</em>{t-1} + + <em>qa</em>{t-q} + <em>1X</em>{t-P} + + <em>PX</em>{t-PS} + <em>1a</em>{t-Q} + + <em>Qa</em>{t-QS} + a_t ] where ( S ) represents the seasonal period and ( a_t ) is white noise.</li>
</ul></li>
</ol>
<section id="armaarima-analysis" class="level1">
<h1>ARMA/ARIMA Analysis</h1>
<section id="the-household-saving-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="the-household-saving-data-analysis">The Household Saving Data Analysis</h2>
<p>Due to the differencing methods should be used when the dataset is not stationary. Here, as in EDA section, the household income data analysis provides results that this dataset is not stationary. To have a brief recap, I have provided the orginal dataset and the acf and pacf plots.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="acf-pacf" class="level3">
<h3 class="anchored" data-anchor-id="acf-pacf">ACF &amp; PACF</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From here, we can see that the dataset has a correlation, which also means that it is not stationary. In order to prove this conclusion, we utilize the adf test to ensure the results are the same.</p>
</section>
<section id="validation-with-adf-test" class="level3">
<h3 class="anchored" data-anchor-id="validation-with-adf-test">Validation with ADF Test</h3>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning in adf.test(df$W398RC1A027NBEA): p-value greater than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  df$W398RC1A027NBEA
Dickey-Fuller = 0.038046, Lag order = 3, p-value = 0.99
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>Based on the result, we can see that the p-value is greater than the thershold value, this means that we fail to reject the Null hypothesis. The time series dataset is not stationary.</p>
<p>Then, to explore more, we utilize detrended and log-transformation to see about the patterns</p>
</section>
<section id="detrended-and-log-transformed" class="level3">
<h3 class="anchored" data-anchor-id="detrended-and-log-transformed">Detrended and Log-transformed</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From here, we can see that after detrending and transforming, the household Saving remains fluctuations espectially during 2020 period, which could be the cause of the Covid-19. In addition, Log-transformed time series, in order to remove the hetroscadastisity, we can see that the trend remains. I think the reason is possibly because log-transformation can assuage issues related to non-constant variance, which means that the inherent trend within the data may persist.</p>
</section>
<section id="test-it-stationary-again" class="level3">
<h3 class="anchored" data-anchor-id="test-it-stationary-again">Test it stationary again</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  log_transformed_data$LogTransformed
Dickey-Fuller = -1.934, Lag order = 3, p-value = 0.598
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>After the detrending and transformating, we can see that it is still not statinary. Which means that further action still needs to be done. I utilize differencing methods.</p>
<div class="cell">

</div>
</section>
<section id="make-it-stationary-by-using-differencing" class="level3">
<h3 class="anchored" data-anchor-id="make-it-stationary-by-using-differencing">Make it Stationary by using differencing</h3>
<p>We will try the second order differencing to see the result since the dataset seems to be overly not stationary.</p>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>After the second orders of differencing, we can see the changes regarding the plots as a whole.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  diff(df$W398RC1A027NBEA, differences = 2)
Dickey-Fuller = -2.9811, Lag order = 3, p-value = 0.1972
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>However, the second order of differencing still cannot make it stationary. We need to do more. However, we should reach the limit with the third order since we do not want to over differencing the dataset.</p>
</section>
<section id="third-differencing" class="level3">
<h3 class="anchored" data-anchor-id="third-differencing">Third Differencing</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  diff(df$W398RC1A027NBEA, differences = 3)
Dickey-Fuller = -5.488, Lag order = 2, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>Now, as we can see, the p-value is now smaller than the significant level. The dataset is stationary.</p>
</section>
<section id="evaluate-the-values-for-p-q" class="level3">
<h3 class="anchored" data-anchor-id="evaluate-the-values-for-p-q">Evaluate the values for p &amp; q</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Autocorrelations of series 'diff_series', by lag

     0      1      2      3      4      5      6      7      8      9     10 
 1.000 -0.340 -0.006  0.060 -0.087 -0.038  0.241 -0.349  0.214 -0.036 -0.050 
    11     12     13     14 
 0.007  0.065 -0.115  0.150 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Partial autocorrelations of series 'diff_series', by lag

     1      2      3      4      5      6      7      8      9     10     11 
-0.340 -0.137  0.013 -0.069 -0.100  0.211 -0.232  0.062 -0.004 -0.007 -0.053 
    12     13     14 
 0.017  0.015  0.007 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the PACF plot, it seems that after the 1st lag, the correlation values drop into insignificance. Thus, we might consider p = 1 for the AR component. From the ACF plot you provided, the correlation seems to cut off after the 1st lag as well. Hence, you might consider q = 2 for the MA component. And we use d = 3 since we utilized third orders of differencing.</p>
</section>
<section id="fit-model" class="level3">
<h3 class="anchored" data-anchor-id="fit-model">Fit Model</h3>
<p>After we determing our parameters, we can start fitting the models.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: diff 
ARIMA(1,3,2) 

Coefficients:
          ar1      ma1     ma2
      -0.7911  -1.8982  0.9996
s.e.   0.2096   0.4024  0.4155

sigma^2 = 919174:  log likelihood = -202.53
AIC=413.07   AICc=415.17   BIC=417.78

Training set error measures:
                    ME     RMSE      MAE      MPE     MAPE     MASE       ACF1
Training set -104.3663 845.5254 428.3458 153.1425 163.6866 0.695587 -0.3066825</code></pre>
</div>
</div>
<p>From here, we get a summary about the aic and bic values.</p>
</section>
<section id="equation-of-the-model" class="level3">
<h3 class="anchored" data-anchor-id="equation-of-the-model">Equation of the Model</h3>
<p>Given the specified values (p = 1), (q = 2), and (d = 3), we can write out the ARIMA(1,3,2) model equation using the general equation based on the results of the model:</p>
<p>[ X_t = c + <em>1X</em>{t-1} + <em>1a</em>{t-1} + <em>2a</em>{t-2} + a_t ]</p>
<p>In my case the third difference is represented as ( ^3 Y_t = Y_t - 0.7911Y_{t-1} - 1.8982Y_{t-2} + 0.9996Y_{t-3} ). The ARIMA equation provided is built upon this differenced series.</p>
</section>
<section id="model-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics">Model diagnostics</h3>
<p>Model diagnostics are very important for us to determine the performance of the parameters we choose. By setting different parameters, we can have a more general view and understanding regarding the model.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
arima(x = arma14, order = c(p, 3, q))

Coefficients:
          ar1      ma1      ma2
      -0.4402  -0.2544  -0.0395
s.e.   0.0377   0.0394   0.0262

sigma^2 estimated as 1.003:  log likelihood = -14202.19,  aic = 28412.39</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">422.0558</td>
<td style="text-align: right;">430.2596</td>
<td style="text-align: right;">425.8740</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">413.6960</td>
<td style="text-align: right;">420.3570</td>
<td style="text-align: right;">416.4232</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">405.0099</td>
<td style="text-align: right;">411.4891</td>
<td style="text-align: right;">407.8670</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">423.9044</td>
<td style="text-align: right;">433.4754</td>
<td style="text-align: right;">429.2377</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">411.0795</td>
<td style="text-align: right;">419.0727</td>
<td style="text-align: right;">415.0795</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">407.0239</td>
<td style="text-align: right;">414.7989</td>
<td style="text-align: right;">411.2239</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">425.8596</td>
<td style="text-align: right;">436.7980</td>
<td style="text-align: right;">433.0596</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">413.0766</td>
<td style="text-align: right;">422.4020</td>
<td style="text-align: right;">418.6766</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">423.9406</td>
<td style="text-align: right;">433.5117</td>
<td style="text-align: right;">429.2739</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">415.6154</td>
<td style="text-align: right;">423.6086</td>
<td style="text-align: right;">419.6154</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">406.9074</td>
<td style="text-align: right;">414.6824</td>
<td style="text-align: right;">411.1074</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">426.0532</td>
<td style="text-align: right;">436.9916</td>
<td style="text-align: right;">433.2532</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">413.0776</td>
<td style="text-align: right;">422.4030</td>
<td style="text-align: right;">418.6776</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">427.4187</td>
<td style="text-align: right;">439.7243</td>
<td style="text-align: right;">436.8923</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">425.4315</td>
<td style="text-align: right;">436.3699</td>
<td style="text-align: right;">432.6315</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">415.1668</td>
<td style="text-align: right;">424.4922</td>
<td style="text-align: right;">420.7668</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">427.4290</td>
<td style="text-align: right;">439.7347</td>
<td style="text-align: right;">436.9027</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>From the table, we can see that p=2, q=2 is the best, which are different from my assumption. The reason is that although there are spike and great change at lag 1. For lag 2, it also have correpondsing spike and change. Therefore, the new parameter sets are reasonable.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC    AICc
3 2 3 2 405.0099 411.4891 407.867</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC    AICc
3 2 3 2 405.0099 411.4891 407.867</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC    AICc
3 2 3 2 405.0099 411.4891 407.867</code></pre>
</div>
</div>
<p>In addition, we can see that for all AIC, BIC, and AICc values, these parameter sets are all the best.</p>
</section>
<section id="model-compare" class="level3">
<h3 class="anchored" data-anchor-id="model-compare">Model Compare</h3>
<p>Now, to be more specific, we compare the two different parameter sets: (2,3,2) and (1,3,2):</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here, we can see that the two fits are actuaclly simiarly within our expecations, but overall, the second fit is better as indicated from model diagoosis.</p>
</section>
<section id="forecasting-for-the-dataset-using-the-best-parameters" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-for-the-dataset-using-the-best-parameters">Forecasting for the dataset using the best parameters</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   Point Forecast    Lo 80     Hi 80    Lo 95     Hi 95
31       4278.130 3813.470  4742.791 3567.493  4988.767
32       3458.665 2921.482  3995.847 2637.115  4280.215
33       5473.540 4496.374  6450.705 3979.094  6967.985
34       4679.682 3529.482  5829.881 2920.603  6438.760
35       6742.303 5099.447  8385.159 4229.772  9254.834
36       5988.600 4080.957  7896.243 3071.112  8906.088
37       8093.980 5637.246 10550.714 4336.729 11851.230
38       7382.141 4577.705 10186.577 3093.127 11671.156
39       9529.693 6118.454 12940.932 4312.654 14746.732
40       8859.921 5024.086 12695.756 2993.518 14726.325</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above graph, we can note that the forecasted number follows a pattern with time period from (28 to 30). This performance is not what was expected and, hence, it is possible that the models are not able to capture the underlying patterns in the data. However, the model did capture the upward trending and certain seasonality. This can be due to a variety of reasons, such as insufficient data and the models not being complex enough. Therefore, further action such as benchmarking should be made to compare the models to see if the model performs well.</p>
</section>
<section id="benchmark" class="level3">
<h3 class="anchored" data-anchor-id="benchmark">BENCHMARK</h3>
<p>Now for benchmarking, we compare the model with the base models such as meanf, naive model, and rwf model.</p>
<div class="cell">

</div>
<section id="the-meanf-model-with-residual-plot" class="level4">
<h4 class="anchored" data-anchor-id="the-meanf-model-with-residual-plot">The meanf model with residual plot</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Mean
Q* = 42.947, df = 6, p-value = 1.195e-07

Model df: 0.   Total lags used: 6</code></pre>
</div>
</div>
</section>
<section id="the-arima-model" class="level4">
<h4 class="anchored" data-anchor-id="the-arima-model">The Arima model</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: df$W398RC1A027NBEA 
ARIMA(0,1,1)(0,0,1)[4] 

Coefficients:
          ma1     sma1
      -0.2008  -0.0093
s.e.   0.1702   0.2238

sigma^2 = 111877:  log likelihood = -208.7
AIC=423.4   AICc=424.36   BIC=427.5

Training set error measures:
                   ME     RMSE      MAE      MPE    MAPE      MASE      ACF1
Training set 83.97069 317.3154 158.0274 3.851463 17.2448 0.9308784 -0.111543</code></pre>
</div>
</div>
<div class="cell">

</div>
</section>
<section id="accuracy-of-the-fitted-models" class="level4">
<h4 class="anchored" data-anchor-id="accuracy-of-the-fitted-models">Accuracy of the fitted models</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                   ME     RMSE      MAE       MPE     MAPE     MASE        ACF1
Training set 32.73409 312.2898 183.7851 -1.612877 23.50814 1.082607 -0.08540118</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Time Series:
Start = 31 
End = 50 
Frequency = 1 
 [1]  4278.130  3458.665  5473.540  4679.682  6742.303  5988.600  8093.980
 [8]  7382.141  9529.693  8859.921 11049.575 10421.894 12653.642 12068.054
[15] 14341.896 13798.400 16114.336 15612.934 17970.962 17511.654</code></pre>
</div>
</div>
</section>
<section id="accuracy-of-the-based-models" class="level4">
<h4 class="anchored" data-anchor-id="accuracy-of-the-based-models">Accuracy of the based models</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                        ME     RMSE      MAE       MPE     MAPE MASE
Training set -2.643441e-14 635.2356 470.2565 -51.63239 78.34547    1</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                   ME     RMSE      MAE      MPE     MAPE MASE       ACF1
Training set 66.26655 330.1867 169.7616 2.867066 18.06051    1 -0.2730483</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                        ME     RMSE      MAE       MPE     MAPE      MASE
Training set -2.350993e-14 323.4687 166.4792 -9.624318 20.73922 0.9806647
                   ACF1
Training set -0.2730483</code></pre>
</div>
</div>
<p>Based on the results, it is clear that the fitted model has the lowest error. our fitted model is performing better than these simple benchmark methods.</p>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on the plot, we can see that Our fit is better than the benchmark methods by capturing more about the seaonal pattern and trending.</p>
</section>
</section>
</section>
<section id="the-median-house-sale-price-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="the-median-house-sale-price-data-analysis">The Median House Sale Price Data Analysis</h2>
<p>Due to the differencing methods should be used when the dataset is not stationary. Here, as in EDA section, the House Sale Price data analysis provides results that this dataset is not stationary. To have a brief recap, I have provided the orginal dataset and the acf and pacf plots.</p>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="acf-pacf-1" class="level3">
<h3 class="anchored" data-anchor-id="acf-pacf-1">ACF &amp; PACF</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From here, we can see that the dataset has a correlation, which also means that it is not stationary. In order to prove this conclusion, we utilize the adf test to ensure the results are the same.</p>
</section>
<section id="validation-with-adf-test-1" class="level3">
<h3 class="anchored" data-anchor-id="validation-with-adf-test-1">Validation with ADF Test</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  df$MSPUS
Dickey-Fuller = -2.6866, Lag order = 6, p-value = 0.287
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>Based on the result, we can see that the p-value is greater than the thershold value, this means that we fail to reject the Null hypothesis. The time series dataset is not stationary.</p>
<p>Then, to explore more, we utilize detrended and log-transformation to see about the patterns</p>
</section>
<section id="detrended-and-log-transformed-1" class="level3">
<h3 class="anchored" data-anchor-id="detrended-and-log-transformed-1">Detrended and Log-transformed</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From here, we can see that after detrending and dfferencing, the household sale price remains fluctuations espectially during 2020 period, which could be the cause of the Covid-19. In addition, Log-transformed time series, in order to remove the hetroscadastisity, we can see that the trend remains. I think the reason is possibly because log-transformation can assuage issues related to non-constant variance, which means that the inherent trend within the data may persist.</p>
</section>
<section id="test-it-stationary-again-1" class="level3">
<h3 class="anchored" data-anchor-id="test-it-stationary-again-1">Test it stationary again</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  log_transformed_data$LogTransformed
Dickey-Fuller = -1.7007, Lag order = 6, p-value = 0.7017
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>After the detrending and transformating, we can see that it is still not statinary. Which means that further action still needs to be done. I utilize differencing methods.</p>
</section>
<section id="make-it-stationary-by-using-differencing-1" class="level3">
<h3 class="anchored" data-anchor-id="make-it-stationary-by-using-differencing-1">Make it Stationary by using differencing</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>After the first order of differencing, we can see the changes regarding the plots as a whole.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  diff(df$MSPUS, differences = 1)
Dickey-Fuller = -6.3462, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>We can see that, after differencing, the dataset becomes stationary. Now, we can fit into the model with different parameters.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Autocorrelations of series 'diff_series', by lag

     0      1      2      3      4      5      6      7      8      9     10 
 1.000 -0.625  0.098  0.079 -0.054  0.021  0.024 -0.095  0.071  0.094 -0.222 
    11     12     13     14     15     16     17     18     19     20     21 
 0.106  0.112 -0.158  0.057  0.021 -0.059  0.114 -0.106 -0.050  0.225 -0.228 
    22     23 
 0.130 -0.083 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Partial autocorrelations of series 'diff_series', by lag

     1      2      3      4      5      6      7      8      9     10     11 
-0.625 -0.481 -0.278 -0.165 -0.069  0.047 -0.070 -0.119  0.136 -0.028 -0.186 
    12     13     14     15     16     17     18     19     20     21     22 
 0.022  0.044 -0.013  0.008 -0.042  0.052  0.040 -0.118  0.082 -0.035  0.115 
    23 
-0.010 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-48-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the PACF plot, it seems that after the 1st lag, the correlation values drop into insignificance. Thus, we might consider p = 1 for the AR component. From the ACF plot you provided, the correlation seems to cut off after the 1st lag as well. Hence, you might consider q = 1 for the MA component. And we use d = 1 since we utilized third orders of differencing.</p>
</section>
<section id="fit-model-1" class="level3">
<h3 class="anchored" data-anchor-id="fit-model-1">Fit model</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: diff 
ARIMA(1,1,1) 

Coefficients:
         ar1      ma1
      0.0092  -0.9827
s.e.  0.0663   0.0133

sigma^2 = 46013474:  log likelihood = -2458.55
AIC=4923.1   AICc=4923.2   BIC=4933.54

Training set error measures:
                   ME     RMSE      MAE  MPE MAPE      MASE        ACF1
Training set 542.7894 6740.971 3865.506 -Inf  Inf 0.6808965 -0.01153987</code></pre>
</div>
</div>
</section>
<section id="equation-of-the-model-1" class="level3">
<h3 class="anchored" data-anchor-id="equation-of-the-model-1">Equation of the Model</h3>
<p>Given the specified values (p = 1), (q = 1), and (d = 1), we can write out the ARIMA(1,1,1) model equation using the general equation based on the results of the model:</p>
<p>[ X_t = c + <em>1X</em>{t-1} + <em>1a</em>{t-1} + <em>2a</em>{t-2} + a_t ]</p>
<p>In my case the third difference is represented as ( ^1 X_t = X_t + 0.0092X_{t-1} - 0.9827Y_{t-1} ). The ARIMA equation provided is built upon this differenced series.</p>
</section>
<section id="model-diagnostics-1" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics-1">Model diagnostics</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
arima(x = arma14, order = c(p, 1, q))

Coefficients:
          ma1
      -0.1934
s.e.   0.0098

sigma^2 estimated as 1.003:  log likelihood = -14202.07,  aic = 28408.15</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4938.630</td>
<td style="text-align: right;">4952.569</td>
<td style="text-align: right;">4938.799</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4923.100</td>
<td style="text-align: right;">4933.542</td>
<td style="text-align: right;">4923.202</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4976.098</td>
<td style="text-align: right;">4986.528</td>
<td style="text-align: right;">4976.200</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4937.123</td>
<td style="text-align: right;">4954.547</td>
<td style="text-align: right;">4937.379</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4924.722</td>
<td style="text-align: right;">4938.645</td>
<td style="text-align: right;">4924.892</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4915.708</td>
<td style="text-align: right;">4929.614</td>
<td style="text-align: right;">4915.879</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4921.957</td>
<td style="text-align: right;">4942.866</td>
<td style="text-align: right;">4922.316</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4926.078</td>
<td style="text-align: right;">4943.482</td>
<td style="text-align: right;">4926.335</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4918.622</td>
<td style="text-align: right;">4936.004</td>
<td style="text-align: right;">4918.879</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4938.832</td>
<td style="text-align: right;">4956.256</td>
<td style="text-align: right;">4939.087</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4933.117</td>
<td style="text-align: right;">4947.039</td>
<td style="text-align: right;">4933.287</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4931.865</td>
<td style="text-align: right;">4945.771</td>
<td style="text-align: right;">4932.036</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4918.505</td>
<td style="text-align: right;">4939.414</td>
<td style="text-align: right;">4918.864</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4924.928</td>
<td style="text-align: right;">4942.331</td>
<td style="text-align: right;">4925.185</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4923.269</td>
<td style="text-align: right;">4940.651</td>
<td style="text-align: right;">4923.526</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4918.739</td>
<td style="text-align: right;">4943.132</td>
<td style="text-align: right;">4919.219</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4903.774</td>
<td style="text-align: right;">4924.657</td>
<td style="text-align: right;">4904.134</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4913.868</td>
<td style="text-align: right;">4934.727</td>
<td style="text-align: right;">4914.230</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>From the table, we can see that p=2, q=2 is the best, which are different from my assumption. The reason is that although there are spike and great change at lag 1. For lag 2, it also have correpondsing spike and change. In addition, since we used first order differencing, the value for d is not the same. By using higher d, the dataset can be more stationary for the model but has the potential of over differencing. Therefore, the new parameter sets are reasonable as well as the initial assumption.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC      BIC     AICc
17 2 2 3 4903.774 4924.657 4904.134</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC      BIC     AICc
17 2 2 3 4903.774 4924.657 4904.134</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC      BIC     AICc
17 2 2 3 4903.774 4924.657 4904.134</code></pre>
</div>
</div>
<p>Since we only used 1 differencing, we can see that for all AIC, BIC, and AICc values, these parameter sets are all the best.</p>
</section>
<section id="model-compare-1" class="level3">
<h3 class="anchored" data-anchor-id="model-compare-1">Model Compare</h3>
<p>Now, to be more specific, we compare the two different parameter sets: (2,2,3) and (1,1,1):</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here, we can see that the two fits are actuaclly simiarly within our expecations. The difference is that we used first order differencing but the model used second order.</p>
</section>
<section id="forecasting-for-the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-for-the-dataset">Forecasting for the dataset</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
243       415627.1 406980.8 424273.4 402403.7 428850.4
244       415720.2 403091.1 428349.3 396405.7 435034.7
245       416226.1 400354.8 432097.4 391953.1 440499.2
246       417033.1 398322.0 435744.1 388416.9 445649.2
247       418059.5 396783.9 439335.2 385521.2 450597.8
248       419246.0 395615.0 442877.1 383105.4 455386.6
249       420549.3 394731.0 446367.6 381063.5 460035.0
250       421937.7 394071.9 449803.4 379320.7 464554.7
251       423388.1 393593.8 453182.5 377821.6 468954.7
252       424883.9 393263.4 456504.3 376524.6 473243.1
253       426412.6 393055.6 459769.6 375397.5 477427.7
254       427965.4 392950.6 462980.2 374415.0 481515.9
255       429535.8 392933.2 466138.3 373557.0 485514.5
256       431118.9 392991.1 469246.7 372807.5 489430.4
257       432711.4 393114.6 472308.3 372153.3 493269.6
258       434310.7 393295.7 475325.8 371583.7 497037.8
259       435915.0 393528.0 478302.1 371089.6 500740.4
260       437522.9 393806.0 481239.8 370663.7 504382.1
261       439133.4 394125.3 484141.5 370299.5 507967.4
262       440745.9 394482.2 487009.6 369991.7 511500.1
263       442359.7 394873.3 489846.2 369735.5 514984.0
264       443974.6 395296.0 492653.3 369527.0 518422.2
265       445590.3 395747.7 495432.8 369362.6 521817.9
266       447206.4 396226.4 498186.4 369239.2 525173.6
267       448823.0 396730.3 500915.7 369154.1 528491.9
268       450439.9 397257.7 503622.1 369104.7 531775.0
269       452056.9 397807.1 506306.8 369089.0 535024.9
270       453674.2 398377.3 508971.1 369104.9 538243.5
271       455291.5 398967.0 511616.0 369150.6 541432.4
272       456908.9 399575.2 514242.7 369224.5 544593.3
273       458526.4 400200.9 516851.9 369325.2 547727.6
274       460143.9 400843.2 519444.6 369451.3 550836.5
275       461761.5 401501.3 522021.6 369601.6 553921.4
276       463379.1 402174.5 524583.6 369774.8 556983.3
277       464996.6 402862.1 527131.2 369970.0 560023.3
278       466614.3 403563.4 529665.1 370186.3 563042.3
279       468231.9 404277.8 532185.9 370422.6 566041.2
280       469849.5 405004.8 534694.2 370678.1 569020.9
281       471467.1 405743.9 537190.4 370952.1 571982.2
282       473084.8 406494.5 539675.0 371243.8 574925.7
283       474702.4 407256.4 542148.4 371552.6 577852.2
284       476320.0 408028.9 544611.1 371877.8 580762.3
285       477937.7 408811.8 547063.6 372218.7 583656.6
286       479555.3 409604.6 549506.0 372574.9 586535.7
287       481172.9 410407.0 551938.8 372945.8 589400.0
288       482790.6 411218.8 554362.4 373330.9 592250.2
289       484408.2 412039.5 556776.9 373729.8 595086.6
290       486025.8 412868.9 559182.8 374141.9 597909.8
291       487643.5 413706.7 561580.3 374566.9 600720.1
292       489261.1 414552.6 563969.7 375004.3 603518.0</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above graph, we can note that the forecasting captures the trending very well. This performance is within expectation. Now, we can determine whether the fit is actually better than the base models through benchmarking.</p>
</section>
<section id="benchmark-1" class="level3">
<h3 class="anchored" data-anchor-id="benchmark-1">BENCHMARK</h3>
<p>Now for benchmarking, we compare the model with the base models such as meanf, naive model, and rwf model.</p>
<div class="cell">

</div>
<section id="the-meanf-model-with-residual-plot-1" class="level4">
<h4 class="anchored" data-anchor-id="the-meanf-model-with-residual-plot-1">The meanf model with residual plot</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Mean
Q* = 1986.7, df = 10, p-value &lt; 2.2e-16

Model df: 0.   Total lags used: 10</code></pre>
</div>
</div>
</section>
<section id="the-arima-model-1" class="level4">
<h4 class="anchored" data-anchor-id="the-arima-model-1">The Arima model</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Series: df$MSPUS 
ARIMA(0,1,1)(0,0,1)[4] 

Coefficients:
         ma1    sma1
      0.0210  0.1671
s.e.  0.0665  0.0793

sigma^2 = 47248340:  log likelihood = -2470.36
AIC=4946.73   AICc=4946.83   BIC=4957.18

Training set error measures:
                   ME     RMSE      MAE      MPE     MAPE      MASE        ACF1
Training set 1355.307 6831.004 4055.777 1.052941 2.484314 0.9922265 -0.04153127</code></pre>
</div>
</div>
<div class="cell">

</div>
</section>
<section id="accuracy-of-the-fitted-models-1" class="level4">
<h4 class="anchored" data-anchor-id="accuracy-of-the-fitted-models-1">Accuracy of the fitted models</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                   ME     RMSE      MAE        MPE     MAPE      MASE
Training set 2.720481 6690.746 3914.234 -0.9087146 2.734111 0.9575986
                    ACF1
Training set -0.05135495</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Time Series:
Start = 243 
End = 262 
Frequency = 1 
 [1] 415627.1 415720.2 416226.1 417033.1 418059.5 419246.0 420549.3 421937.7
 [9] 423388.1 424883.9 426412.6 427965.4 429535.8 431118.9 432711.4 434310.7
[17] 435915.0 437522.9 439133.4 440745.9</code></pre>
</div>
</div>
</section>
<section id="accuracy-of-the-based-models-1" class="level4">
<h4 class="anchored" data-anchor-id="accuracy-of-the-based-models-1">Accuracy of the based models</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                       ME     RMSE      MAE       MPE     MAPE MASE
Training set 3.001896e-12 110997.1 92601.82 -122.4252 153.9077    1</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                   ME    RMSE      MAE    MPE     MAPE MASE      ACF1
Training set 1652.697 6932.02 4087.552 1.2553 2.554247    1 0.0208634</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                        ME     RMSE      MAE       MPE     MAPE      MASE
Training set -4.089888e-12 6732.124 4019.955 -1.162417 2.944873 0.9834627
                  ACF1
Training set 0.0208634</code></pre>
</div>
</div>
<p>Based on the results, it is clear that the fitted model has the lowest error. our fitted model is performing better than these simple benchmark methods.</p>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on the plot, we can see that Our fit is better than the benchmark methods by capturing more about the trending pattern.</p>
</section>
</section>
</section>
</section>
<section id="sarima-analysis" class="level1">
<h1>SARIMA Analysis</h1>
<section id="gdp-deflator-sarima-analysis" class="level2">
<h2 class="anchored" data-anchor-id="gdp-deflator-sarima-analysis">GDP Deflator SARIMA Analysis</h2>
<div class="cell">

</div>
<section id="before-covid-period" class="level3">
<h3 class="anchored" data-anchor-id="before-covid-period">Before Covid Period</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>gdp_df <span class="ot">&lt;-</span> <span class="fu">ts</span>(df<span class="sc">$</span>A191RI1Q225SBEA[<span class="dv">1</span><span class="sc">:</span><span class="dv">295</span>],<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>gdp_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Qtr1 Qtr2 Qtr3 Qtr4
1   5.8  6.9 10.2  3.2
2   3.6  7.6  1.2 -2.1
3  -3.9 -1.8  0.0 -0.6
4   1.3  9.0  7.7 15.3
5   2.7  0.2  4.7 -0.2
6   0.5  4.6  1.1  0.1
7   0.8  1.7  0.7  1.3
8   0.4  0.5  1.1  1.9
9   1.7  2.8  4.0  4.1
10  2.4  5.1  1.6  5.6
11  2.8  2.4  0.3  4.4
12  1.2  2.5  1.9  0.9
13  0.6  1.5  1.6  1.6
14  1.0  1.4  1.2  0.9
15  0.9  1.0  1.3  2.1
16  0.7  0.8  0.8  1.8
17  0.7  0.5  3.3  1.3
18  0.9  1.6  1.8  2.0
19  1.8  1.6  2.8  2.6
20  3.3  3.9  3.4  1.7
21  2.1  3.9  4.5  4.5
22  4.3  4.0  5.8  4.2
23  5.2  5.7  5.3  5.7
24  5.7  3.3  5.4  6.2
25  5.4  4.1  3.4  6.2
26  2.5  3.9  5.2  4.7
27  6.3  8.0  8.2  7.8
28  9.8 12.2 12.3  9.4
29  6.1  7.3  6.9  4.3
30  4.1  5.3  7.4  6.6
31  5.8  5.0  8.9  6.0
32  7.9  7.0  8.4  7.5
33 10.2  9.0  7.6  8.7
34  9.9  9.2 10.8 11.0
35  8.2  7.7  7.1  5.6
36  5.3  5.8  4.2  3.1
37  3.0  4.3  3.1  4.1
38  3.5  3.6  3.0  4.0
39  2.6  2.4  2.3  2.0
40  1.5  1.7  2.2  2.6
41  2.8  3.1  3.2  3.2
42  4.0  4.9  3.5  4.2
43  4.3  3.0  2.9  4.4
44  4.6  3.5  3.0  4.0
45  3.0  3.2  2.4  1.5
46  2.4  2.0  2.8  2.3
47  2.4  2.4  2.2  1.9
48  1.9  2.3  2.2  2.2
49  1.9  2.0  1.9  1.9
50  1.7  1.3  2.2  2.4
51  0.8  1.7  1.3  0.6
52  0.9  1.7  1.1  1.3
53  1.5  1.4  2.2  2.7
54  2.5  2.4  2.2  2.6
55  2.4  1.6  1.3  1.3
56  1.4  1.9  2.3  2.0
57  1.4  2.3  2.5  2.9
58  3.3  2.6  3.1  3.2
59  2.9  3.7  3.3  2.8
60  3.6  2.8  1.5  3.9
61  2.7  2.1  1.7  1.4
62  2.0  3.1  1.0 -0.2
63 -0.7  0.4  1.3  1.1
64  2.0  1.2  2.4  2.1
65  2.7  2.5  0.5  2.4
66  1.6  2.1  2.0  1.6
67  1.1  1.9  2.4  1.7
68  2.3  1.8  0.7 -0.1
69  2.2  1.2  0.0 -0.3
70  2.9  1.1  2.1  2.1
71  1.3  2.0  2.8  2.5
72  3.5  1.4  1.8  1.6
73  2.2  1.3  1.5  1.6
74 -1.5  3.5  2.6     </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> DATE, <span class="at">y =</span> A191RI1Q225SBEA)) <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"DarkViolet"</span>) <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Time Series Plot of GDP Deflator"</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date"</span>, </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"GDP Deflator"</span>) <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="fl">0.1</span>),</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="fl">0.05</span>),</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="check-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="check-decomposition">Check Decomposition</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Decompose the time series data</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>dec <span class="ot">&lt;-</span> <span class="fu">decompose</span>(gdp_df, <span class="at">type =</span> <span class="st">"multiplicative"</span>)  <span class="co"># Choose either "additive" or "multiplicative"</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the graphical parameters for the plot</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"#E0E0E0"</span>, <span class="at">col.axis =</span> <span class="st">"#E0E0E0"</span>, <span class="at">col.lab =</span> <span class="st">"black"</span>, <span class="at">col.main =</span> <span class="st">"black"</span>, <span class="at">col.sub =</span> <span class="st">"black"</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the decomposed object</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset the graphical parameters to default</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">col.axis =</span> <span class="st">"black"</span>, <span class="at">col.lab =</span> <span class="st">"black"</span>, <span class="at">col.main =</span> <span class="st">"black"</span>, <span class="at">col.sub =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="check-lag-plot" class="level3">
<h3 class="anchored" data-anchor-id="check-lag-plot">Check Lag Plot</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gglagplot</span>(gdp_df, <span class="at">do.lines=</span><span class="cn">FALSE</span>, <span class="at">set.lags =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">16</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="seasonal-difference-and-acf-pacf" class="level3">
<h3 class="anchored" data-anchor-id="seasonal-difference-and-acf-pacf">Seasonal Difference AND ACF &amp; PACF</h3>
<p>This shows seasonality. Also the lag plot shows higher correlation at Seasonal lag 4 relatively.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>ts_plot <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(gdp_df) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Time Series Plot "</span>) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the ACF and PACF plots without the theme</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>acf_plot <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(<span class="fu">diff</span>(<span class="fu">diff</span>(gdp_df, <span class="at">lag=</span><span class="dv">4</span>), <span class="at">differences =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ACF for first Order of Differencing and Seasonal Differenceing"</span>) <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>pacf_plot <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(<span class="fu">diff</span>(<span class="fu">diff</span>(gdp_df, <span class="at">lag=</span><span class="dv">4</span>), <span class="at">differences =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"PACF for first Orders of Differencing and Seasonal Differenceing"</span>) <span class="sc">+</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(ts_plot, acf_plot, pacf_plot, <span class="at">ncol =</span> <span class="dv">1</span>)             </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Most spikes are within range, it is stationary. ACF Plot :</p>
<p>The sharp drop after lag 1 and some lags across the range. This gives us q = 1,2. Since there’s a noticeable autocorrelation at lag 4, this suggests a seasonal component. The seasonal component in the ACF plot shows a sharp decline after lag 4, which implies Q = 1. PACF Plot:</p>
<p>The sharp drop after lag 1 in the PACF plot indicates a possible AR(1) process. This gives us p = 1. The seasonal component in the PACF plot also has a significant spike at lag 4, which implies P = 1. Order of Differencing:</p>
<p>You mentioned that you applied first order differencing, so d = 1. You also mentioned seasonal differencing with a lag of 4, so D = 1. Combining these, we get:</p>
<p>Non-seasonal parameters: p = 1, d = 1, q = 1,2 Seasonal parameters: P = 1, D = 1, Q = 1, and the seasonal period (or frequency) is 4. Therefore, the ARIMA model can be represented as ARIMA(1,1,1)(1,1,1)[4].</p>
<p>WE can continue analysis</p>
</section>
<section id="model-diagnostics-2" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics-2">Model Diagnostics</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################## Check for different combinations ########</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,data){</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">35</span>),<span class="at">nrow=</span><span class="dv">35</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">9</span>)</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>))</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Based on the analysis:</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">2</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">3</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">2</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">2</span>,<span class="at">data=</span>gdp_df)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;">D</th>
<th style="text-align: right;">Q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1353.815</td>
<td style="text-align: right;">1357.485</td>
<td style="text-align: right;">1353.829</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1168.495</td>
<td style="text-align: right;">1175.834</td>
<td style="text-align: right;">1168.536</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1257.004</td>
<td style="text-align: right;">1264.344</td>
<td style="text-align: right;">1257.046</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1168.185</td>
<td style="text-align: right;">1179.194</td>
<td style="text-align: right;">1168.269</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1321.946</td>
<td style="text-align: right;">1329.286</td>
<td style="text-align: right;">1321.988</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1129.920</td>
<td style="text-align: right;">1140.930</td>
<td style="text-align: right;">1130.004</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1232.655</td>
<td style="text-align: right;">1243.665</td>
<td style="text-align: right;">1232.739</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1129.375</td>
<td style="text-align: right;">1144.054</td>
<td style="text-align: right;">1129.515</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1288.080</td>
<td style="text-align: right;">1299.090</td>
<td style="text-align: right;">1288.164</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1131.369</td>
<td style="text-align: right;">1146.049</td>
<td style="text-align: right;">1131.510</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1233.896</td>
<td style="text-align: right;">1248.575</td>
<td style="text-align: right;">1234.036</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1325.569</td>
<td style="text-align: right;">1332.909</td>
<td style="text-align: right;">1325.611</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1138.391</td>
<td style="text-align: right;">1149.401</td>
<td style="text-align: right;">1138.475</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1237.785</td>
<td style="text-align: right;">1248.794</td>
<td style="text-align: right;">1237.868</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1138.442</td>
<td style="text-align: right;">1153.122</td>
<td style="text-align: right;">1138.583</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1275.876</td>
<td style="text-align: right;">1286.886</td>
<td style="text-align: right;">1275.960</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1127.620</td>
<td style="text-align: right;">1142.300</td>
<td style="text-align: right;">1127.760</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1204.062</td>
<td style="text-align: right;">1218.741</td>
<td style="text-align: right;">1204.202</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1271.665</td>
<td style="text-align: right;">1286.345</td>
<td style="text-align: right;">1271.805</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="compare-the-results" class="level3">
<h3 class="anchored" data-anchor-id="compare-the-results">Compare the results</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q     AIC    BIC    AICc
17 1 1 1 0 1 1 1127.62 1142.3 1127.76</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q P D Q     AIC     BIC     AICc
6 0 1 1 0 1 1 1129.92 1140.93 1130.004</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q     AIC    BIC    AICc
17 1 1 1 0 1 1 1127.62 1142.3 1127.76</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">236</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>model_output1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(gdp_df, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>model_output2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(gdp_df, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-83-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The second one is a little better.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output1[<span class="dv">50</span><span class="sc">:</span><span class="dv">80</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$fit

Call:
arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
    include.mean = !no.constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
        REPORT = 1, reltol = tol))

Coefficients:
         ar1      ma1     sma1
      0.5197  -0.8775  -0.9535
s.e.  0.0810   0.0497   0.0279

sigma^2 estimated as 2.671:  log likelihood = -559.81,  aic = 1127.62

$degrees_of_freedom
[1] 287

$ttable
     Estimate     SE  t.value p.value
ar1    0.5197 0.0810   6.4164       0
ma1   -0.8775 0.0497 -17.6718       0
sma1  -0.9535 0.0279 -34.1752       0

$AIC
[1] 3.888345

$AICc
[1] 3.888634

$BIC
[1] 3.938964</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output2[<span class="dv">40</span><span class="sc">:</span><span class="dv">55</span>], model_output2[<span class="fu">length</span>(model_output2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 288

$ttable
     Estimate     SE  t.value p.value
ma1   -0.4017 0.0579  -6.9345       0
sma1  -0.9579 0.0242 -39.6386       0

$AIC
[1] 3.896277

$AICc
[1] 3.896421

$BIC
[1] 3.934241</code></pre>
</div>
</div>
<p>The Standard Residual Plot appears good, displaying okay stationarity with a nearly constant mean and variation.</p>
<p>The Autocorrelation Function (ACF) plot shows almost no correlation indicating that the model has harnessed everything that left is white noise. This indicates a good model fit.</p>
<p>The Quantile-Quantile (Q-Q) Plot still demonstrates near-normality.</p>
<p>The Ljung-Box test results reveal values below the 0.05 (5% significance) threshold, indicating there’s some significant correlation left.</p>
<p>$ttable: all coefficients are significant.</p>
</section>
<section id="fit-model-forecasting" class="level3">
<h3 class="anchored" data-anchor-id="fit-model-forecasting">Fit model &amp; Forecasting</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>fit2<span class="ot">=</span><span class="fu">arima</span>(gdp_df, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">4</span>) )</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
arima(x = gdp_df, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1), period = 4))

Coefficients:
          ma1     sma1
      -0.4017  -0.9579
s.e.   0.0579   0.0242

sigma^2 estimated as 2.725:  log likelihood = -561.96,  aic = 1129.92

Training set error measures:
                     ME     RMSE      MAE MPE MAPE      MASE        ACF1
Training set 0.08485662 1.636759 1.074369 NaN  Inf 0.9718906 0.006601766</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autoplot with custom colors</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>plot_fit_ <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(<span class="fu">forecast</span>(fit2,<span class="dv">120</span>)) <span class="sc">+</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_fit_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima.for</span>(gdp_df, <span class="dv">36</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$pred
       Qtr1     Qtr2     Qtr3     Qtr4
74                            2.263270
75 2.221820 2.403705 2.324961 2.241627
76 2.200177 2.382062 2.303318 2.219983
77 2.178533 2.360419 2.281674 2.198340
78 2.156890 2.338775 2.260031 2.176696
79 2.135247 2.317132 2.238388 2.155053
80 2.113603 2.295488 2.216744 2.133410
81 2.091960 2.273845 2.195101 2.111766
82 2.070316 2.252202 2.173457 2.090123
83 2.048673 2.230558 2.151814         

$se
       Qtr1     Qtr2     Qtr3     Qtr4
74                            1.650936
75 1.923859 2.162607 2.377500 2.602077
76 2.798329 2.981682 3.154396 3.340432
77 3.507987 3.667883 3.821094 3.987789
78 4.140176 4.287134 4.429218 4.584383
79 4.727550 4.866489 5.001569 5.149237
80 5.286381 5.420036 5.550474 5.693022
81 5.826077 5.956138 6.083420 6.222379
82 6.352607 6.480195 6.605319 6.741734
83 6.870006 6.995903 7.119573         </code></pre>
</div>
</div>
</section>
<section id="benchmark-comparsion" class="level3">
<h3 class="anchored" data-anchor-id="benchmark-comparsion">BenchMark Comparsion</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(gdp_df) <span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(fit2,<span class="dv">36</span>), </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"fit"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(gdp_df, <span class="at">h=</span><span class="dv">36</span>),</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(gdp_df, <span class="at">h=</span><span class="dv">36</span>),</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(gdp_df, <span class="at">h=</span><span class="dv">36</span>),</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(gdp_df, <span class="at">h=</span><span class="dv">36</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">snaive</span>(gdp_df, <span class="at">h=</span><span class="dv">36</span>) </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(f2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      ME     RMSE     MAE  MPE MAPE MASE      ACF1
Training set -0.06838488 2.442416 1.45945 -Inf  Inf    1 0.4805284</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
arima(x = gdp_df, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1), period = 4))

Coefficients:
          ma1     sma1
      -0.4017  -0.9579
s.e.   0.0579   0.0242

sigma^2 estimated as 2.725:  log likelihood = -561.96,  aic = 1129.92

Training set error measures:
                     ME     RMSE      MAE MPE MAPE      MASE        ACF1
Training set 0.08485662 1.636759 1.074369 NaN  Inf 0.9718906 0.006601766</code></pre>
</div>
</div>
<p>Our model fitting is much better than benchmark methods</p>
</section>
<section id="cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation">Cross validation</h3>
<section id="one-step-ahead" class="level4">
<h4 class="anchored" data-anchor-id="one-step-ahead">One Step ahead</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(gdp_df)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>n </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 295</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">89</span> <span class="co"># Use enough number of data for model: 30% of my whole dataset</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>n<span class="sc">-</span>k <span class="co"># rest of the observations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 206</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>err1 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>err2 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k))</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> gdp_df[<span class="dv">1</span><span class="sc">:</span>(k<span class="dv">-1</span>)<span class="sc">+</span>i] <span class="co">#observations from 1 to 75</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> gdp_df[k<span class="sc">+</span>i] <span class="co">#76th observation as the test set</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">arima</span>(xtrain, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">4</span>) )</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">arima</span>(xtrain, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">4</span>) )</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#capture error for each iteration</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This is mean absolute error</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>  err1 <span class="ot">=</span> <span class="fu">c</span>(err1, <span class="fu">abs</span>(fcast1<span class="sc">$</span>mean<span class="sc">-</span>xtest)) </span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>  err2 <span class="ot">=</span> <span class="fu">c</span>(err2, <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest))</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This is mean squared error</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>  err3 <span class="ot">=</span> <span class="fu">c</span>(err1, (fcast1<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>  err4 <span class="ot">=</span> <span class="fu">c</span>(err2, (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>MAE1<span class="ot">=</span><span class="fu">mean</span>(err1) </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>MAE2<span class="ot">=</span><span class="fu">mean</span>(err2)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>MSE1<span class="ot">=</span><span class="fu">mean</span>(err3)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>MSE2<span class="ot">=</span><span class="fu">mean</span>(err4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>error_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAE1 =</span> MAE1,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAE2 =</span> MAE2,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">MSE1 =</span> MSE1,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">MSE2 =</span> MSE2</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View the dataframe</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(error_metrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       MAE1      MAE2      MSE1      MSE2
1 0.8997526 0.8742994 0.9035127 0.8766414</code></pre>
</div>
</div>
<p>We can see that the corresponding results for model 2: (0,1,1)(0,1,1) is slightly better.</p>
</section>
<section id="step-ahead-in-my-case" class="level4">
<h4 class="anchored" data-anchor-id="step-ahead-in-my-case">4 step ahead in my case</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">arima</span>(x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">4</span>) ),<span class="at">h=</span>h)}</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 4 steps ahead</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(gdp_df, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">4</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(e) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1180</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the MSE values and remove missing values</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From here we can see that the one step ahead has lower MSE, which is better than four step ahead in my case.</p>
</section>
</section>
</section>
<section id="real-median-household-income-in-the-united-states-sarima-analsyis" class="level2">
<h2 class="anchored" data-anchor-id="real-median-household-income-in-the-united-states-sarima-analsyis">Real Median Household Income in the United States SARIMA Analsyis</h2>
<div class="cell">

</div>
<section id="before-covid-period-1" class="level3">
<h3 class="anchored" data-anchor-id="before-covid-period-1">Before Covid Period</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>rmhi <span class="ot">&lt;-</span> <span class="fu">ts</span>(df<span class="sc">$</span>MEHOINUSA672N,<span class="at">frequency =</span> <span class="dv">2</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>rmhi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Time Series:
Start = c(1, 1) 
End = c(19, 2) 
Frequency = 2 
 [1] 55828 56871 58920 59624 60115 61153 60370 58607 58153 57843 58515 60348
[13] 61225 62484 64781 66385 66248 64779 64047 63967 63745 64427 64930 65801
[25] 63455 63011 61364 60428 60313 62425 61468 64631 66657 67571 68168 72808
[37] 71186 70784</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> DATE, <span class="at">y =</span> MEHOINUSA672N)) <span class="sc">+</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"DarkViolet"</span>) <span class="sc">+</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Time Series Plot of Household Income"</span>,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date"</span>, </span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Household Income"</span>) <span class="sc">+</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="fl">0.1</span>),</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="fl">0.05</span>),</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="check-with-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="check-with-decomposition">Check with decomposition</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Decompose the time series data</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>dec <span class="ot">&lt;-</span> <span class="fu">decompose</span>(rmhi, <span class="at">type =</span> <span class="st">"multiplicative"</span>)  <span class="co"># Choose either "additive" or "multiplicative"</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the graphical parameters for the plot</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"#E0E0E0"</span>, <span class="at">col.axis =</span> <span class="st">"#E0E0E0"</span>, <span class="at">col.lab =</span> <span class="st">"black"</span>, <span class="at">col.main =</span> <span class="st">"black"</span>, <span class="at">col.sub =</span> <span class="st">"black"</span>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the decomposed object</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset the graphical parameters to default</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">col.axis =</span> <span class="st">"black"</span>, <span class="at">col.lab =</span> <span class="st">"black"</span>, <span class="at">col.main =</span> <span class="st">"black"</span>, <span class="at">col.sub =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="check-seasonal-pattern-using-lag" class="level3">
<h3 class="anchored" data-anchor-id="check-seasonal-pattern-using-lag">Check Seasonal Pattern using Lag</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gglagplot</span>(rmhi, <span class="at">do.lines=</span><span class="cn">FALSE</span>, <span class="at">set.lags =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="seasonal-difference-and-acf-pacf-1" class="level3">
<h3 class="anchored" data-anchor-id="seasonal-difference-and-acf-pacf-1">Seasonal Difference and ACF, PACF</h3>
<p>This shows seasonality. Also the lag plot shows higher correlation at Seasonal lag 2 relatively.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>ts_plot <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(rmhi) <span class="sc">+</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Time Series Plot "</span>) <span class="sc">+</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the ACF and PACF plots without the theme</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>acf_plot <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(<span class="fu">diff</span>(<span class="fu">diff</span>(rmhi, <span class="at">lag=</span><span class="dv">2</span>), <span class="at">differences =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ACF for first Order of Differencing and Seasonal Differenceing"</span>) <span class="sc">+</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>pacf_plot <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(<span class="fu">diff</span>(<span class="fu">diff</span>(rmhi, <span class="at">lag=</span><span class="dv">2</span>), <span class="at">differences =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"PACF for first Orders of Differencing and Seasonal Differenceing"</span>) <span class="sc">+</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(ts_plot, acf_plot, pacf_plot, <span class="at">ncol =</span> <span class="dv">1</span>)             </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Most spikes are within range, it is stationary. ACF Plot (Autocorrelation Function Plot):</p>
<p>The sharp drop after lag 2. This gives us q = 1,2. Since there’s a noticeable autocorrelation at lag 2,5, this suggests a seasonal component. The seasonal component in the ACF plot shows a sharp decline after lag 1, which implies Q = 1,2. PACF Plot (Partial Autocorrelation Function Plot):</p>
<p>The sharp drop after lag 2 in the PACF plot indicates a possible AR(1) process. This gives us p = 1,2. The seasonal component in the PACF plot also has a significant spike at lag 4, which implies P = 1. However, the dataset did not have a strong seasonal pattern. We can also consider P to be 0 Order of Differencing:</p>
<p>We applied first order differencing, so d = 1. You also mentioned seasonal differencing with a lag of 4, so D = 1. Combining these, we get:</p>
<p>Non-seasonal parameters: p = 1,2, d = 1, q = 1,2 Seasonal parameters: P = 0,1 D = 1, Q = 1, and the seasonal period (or frequency) is 2. Therefore, the ARIMA model can be represented as ARIMA(2,1,1)(0,1,1)[2].</p>
<p>WE can continue analysis</p>
</section>
<section id="model-diagnostic" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostic">Model Diagnostic</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################## Check for different combinations ########</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,data){</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">23</span>),<span class="at">nrow=</span><span class="dv">23</span>)</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">9</span>)</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>))</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="compare-results" class="level3">
<h3 class="anchored" data-anchor-id="compare-results">Compare Results</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Based on the analysis:</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">3</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">3</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">2</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">2</span>,<span class="at">data=</span>rmhi)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;">D</th>
<th style="text-align: right;">Q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">629.7060</td>
<td style="text-align: right;">631.2613</td>
<td style="text-align: right;">629.8272</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">618.0458</td>
<td style="text-align: right;">621.1565</td>
<td style="text-align: right;">618.4208</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">626.3264</td>
<td style="text-align: right;">629.4371</td>
<td style="text-align: right;">626.7014</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619.6015</td>
<td style="text-align: right;">624.2676</td>
<td style="text-align: right;">620.3757</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">622.7853</td>
<td style="text-align: right;">625.8960</td>
<td style="text-align: right;">623.1603</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">615.4804</td>
<td style="text-align: right;">620.1464</td>
<td style="text-align: right;">616.2546</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">618.5424</td>
<td style="text-align: right;">623.2084</td>
<td style="text-align: right;">619.3166</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">617.1456</td>
<td style="text-align: right;">623.3670</td>
<td style="text-align: right;">618.4789</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">620.1165</td>
<td style="text-align: right;">624.7825</td>
<td style="text-align: right;">620.8907</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">617.2042</td>
<td style="text-align: right;">623.4256</td>
<td style="text-align: right;">618.5375</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">619.5969</td>
<td style="text-align: right;">625.8183</td>
<td style="text-align: right;">620.9302</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">631.0309</td>
<td style="text-align: right;">634.1416</td>
<td style="text-align: right;">631.4059</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">616.4825</td>
<td style="text-align: right;">621.1486</td>
<td style="text-align: right;">617.2567</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">623.7348</td>
<td style="text-align: right;">628.4008</td>
<td style="text-align: right;">624.5090</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">617.5213</td>
<td style="text-align: right;">623.7427</td>
<td style="text-align: right;">618.8547</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">622.7940</td>
<td style="text-align: right;">627.4601</td>
<td style="text-align: right;">623.5682</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">617.2456</td>
<td style="text-align: right;">623.4670</td>
<td style="text-align: right;">618.5790</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">619.8546</td>
<td style="text-align: right;">626.0760</td>
<td style="text-align: right;">621.1880</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">617.1006</td>
<td style="text-align: right;">623.3219</td>
<td style="text-align: right;">618.4339</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">627.3197</td>
<td style="text-align: right;">631.9857</td>
<td style="text-align: right;">628.0938</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">618.3728</td>
<td style="text-align: right;">624.5942</td>
<td style="text-align: right;">619.7062</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">624.6816</td>
<td style="text-align: right;">630.9030</td>
<td style="text-align: right;">626.0149</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">616.9212</td>
<td style="text-align: right;">623.1426</td>
<td style="text-align: right;">618.2545</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q P D Q      AIC      BIC     AICc
6 0 1 1 0 1 1 615.4804 620.1464 616.2546</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q P D Q      AIC      BIC     AICc
6 0 1 1 0 1 1 615.4804 620.1464 616.2546</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q P D Q      AIC      BIC     AICc
6 0 1 1 0 1 1 615.4804 620.1464 616.2546</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">236</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>model_output1 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(rmhi, <span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>model_output2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(rmhi, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-110-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The second one is a little better.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output1[<span class="dv">50</span><span class="sc">:</span><span class="dv">67</span>], model_output1[<span class="fu">length</span>(model_output1)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31

$ttable
     Estimate     SE t.value p.value
ar1   -0.1325 0.2471 -0.5362  0.5956
ar2   -0.1839 0.3213 -0.5723  0.5712
ma1    0.6255 0.2393  2.6142  0.0137
sma1  -0.5330 0.3657 -1.4576  0.1550

$AIC
[1] 17.68248

$AICc
[1] 17.72058

$BIC
[1] 17.90468</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output2[<span class="dv">40</span><span class="sc">:</span><span class="dv">55</span>], model_output2[<span class="fu">length</span>(model_output2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
$ttable
     Estimate     SE t.value p.value
ma1    0.4932 0.2136  2.3085  0.0274
sma1  -0.6924 0.1661 -4.1678  0.0002

$AIC
[1] 17.58515

$AICc
[1] 17.59587

$BIC
[1] 17.71847

NA</code></pre>
</div>
</div>
<p>The Standard Residual Plot appears good, displaying okay stationarity with a nearly constant mean and variation.</p>
<p>The Autocorrelation Function (ACF) plot shows almost no correlation indicating that the model has harnessed everything that left is white noise. This indicates a good model fit.</p>
<p>The Quantile-Quantile (Q-Q) Plot still demonstrates near-normality.</p>
<p>The Ljung-Box test results reveal values below the 0.05 (5% significance) threshold, indicating there’s some significant correlation left.</p>
<p>$ttable: all coefficients are significant. The second one is better indeed.</p>
</section>
<section id="fit-model-forecast" class="level3">
<h3 class="anchored" data-anchor-id="fit-model-forecast">Fit model &amp; Forecast</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>fit2<span class="ot">=</span><span class="fu">arima</span>(rmhi, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">2</span>) )</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
arima(x = rmhi, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1), period = 2))

Coefficients:
         ma1     sma1
      0.4932  -0.6924
s.e.  0.2136   0.1661

sigma^2 estimated as 2022906:  log likelihood = -304.74,  aic = 615.48

Training set error measures:
                   ME     RMSE      MAE        MPE     MAPE      MASE
Training set -72.4368 1365.071 1031.092 -0.1227066 1.603226 0.8711332
                    ACF1
Training set -0.03840144</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Autoplot with custom colors</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>plot_fit_ <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(<span class="fu">forecast</span>(fit2,<span class="dv">36</span>)) <span class="sc">+</span> </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_fit_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="benchmark-comparsion-1" class="level3">
<h3 class="anchored" data-anchor-id="benchmark-comparsion-1">BenchMark Comparsion</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima.for</span>(rmhi, <span class="dv">36</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$pred
Time Series:
Start = c(20, 1) 
End = c(37, 2) 
Frequency = 2 
 [1] 69952.81 71400.41 70921.82 72369.41 71890.82 73338.42 72859.82 74307.42
 [9] 73828.83 75276.43 74797.83 76245.43 75766.84 77214.43 76735.84 78183.44
[17] 77704.84 79152.44 78673.85 80121.44 79642.85 81090.45 80611.86 82059.45
[25] 81580.86 83028.46 82549.86 83997.46 83518.87 84966.46 84487.87 85935.47
[33] 85456.87 86904.47 86425.88 87873.47

$se
Time Series:
Start = c(20, 1) 
End = c(37, 2) 
Frequency = 2 
 [1]  1422.290  2555.981  3618.397  4561.172  5580.054  6550.064  7606.739
 [8]  8633.488  9745.571 10835.708 12007.705 13161.940 14394.301 15611.416
[15] 16903.132 18181.267 19530.792 20867.921 22273.543 23667.660 25127.664
[22] 26576.861 28089.590 29592.080 31155.970 32710.092 34323.673 35927.889
[29] 37589.789 39242.674 40951.612 42651.843 44406.626 46152.975 47952.485
[36] 49743.807</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(rmhi) <span class="sc">+</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(fit2,<span class="dv">36</span>), </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"fit"</span>) <span class="sc">+</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(rmhi, <span class="at">h=</span><span class="dv">36</span>),</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(rmhi, <span class="at">h=</span><span class="dv">36</span>),</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(rmhi, <span class="at">h=</span><span class="dv">36</span>),</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(rmhi, <span class="at">h=</span><span class="dv">36</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">meanf</span>(rmhi, <span class="at">h=</span><span class="dv">36</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">snaive</span>(rmhi, <span class="at">h=</span><span class="dv">36</span>) </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span><span class="fu">naive</span>(rmhi, <span class="at">h=</span><span class="dv">36</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(f1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                       ME     RMSE      MAE        MPE     MAPE     MASE
Training set 1.914539e-12 3930.345 3192.816 -0.3813871 5.052014 1.549179
                  ACF1
Training set 0.8332796</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(f2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   ME     RMSE      MAE      MPE     MAPE MASE      ACF1
Training set 813.0833 2378.943 2060.972 1.213902 3.223489    1 0.6130337</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(f3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   ME     RMSE      MAE      MPE     MAPE      MASE      ACF1
Training set 404.2162 1503.922 1183.622 0.614466 1.854535 0.5743026 0.1656062</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
arima(x = rmhi, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1), period = 2))

Coefficients:
         ma1     sma1
      0.4932  -0.6924
s.e.  0.2136   0.1661

sigma^2 estimated as 2022906:  log likelihood = -304.74,  aic = 615.48

Training set error measures:
                   ME     RMSE      MAE        MPE     MAPE      MASE
Training set -72.4368 1365.071 1031.092 -0.1227066 1.603226 0.8711332
                    ACF1
Training set -0.03840144</code></pre>
</div>
</div>
<p>Our model fitting is better than benchmark methods with smaller RMSE</p>
</section>
<section id="cross-validation-1" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-1">Cross validation</h3>
<section id="one-step-ahead-1" class="level4">
<h4 class="anchored" data-anchor-id="one-step-ahead-1">One Step ahead</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(rmhi)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>n <span class="sc">*</span> <span class="fl">0.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.4</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="co"># Use enough number of data for model: 30% of my whole dataset</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>n<span class="sc">-</span>k <span class="co"># rest of the observations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 26</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>err1 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>err2 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k))</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> rmhi[<span class="dv">1</span><span class="sc">:</span>(k<span class="dv">-1</span>)<span class="sc">+</span>i] </span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> rmhi[k<span class="sc">+</span>i] </span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">arima</span>(xtrain, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">2</span>) )</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">arima</span>(xtrain, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">2</span>) )</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#capture error for each iteration</span></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This is mean absolute error</span></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>  err1 <span class="ot">=</span> <span class="fu">c</span>(err1, <span class="fu">abs</span>(fcast1<span class="sc">$</span>mean<span class="sc">-</span>xtest)) </span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>  err2 <span class="ot">=</span> <span class="fu">c</span>(err2, <span class="fu">abs</span>(fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest))</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This is mean squared error</span></span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>  err3 <span class="ot">=</span> <span class="fu">c</span>(err1, (fcast1<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>  err4 <span class="ot">=</span> <span class="fu">c</span>(err2, (fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>MAE1<span class="ot">=</span><span class="fu">mean</span>(err1) </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>MAE2<span class="ot">=</span><span class="fu">mean</span>(err2)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>MSE1<span class="ot">=</span><span class="fu">mean</span>(err3)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>MSE2<span class="ot">=</span><span class="fu">mean</span>(err4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>error_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAE1 =</span> MAE1,</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAE2 =</span> MAE2,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">MSE1 =</span> MSE1,</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">MSE2 =</span> MSE2</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View the dataframe</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(error_metrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     MAE1     MAE2     MSE1     MSE2
1 1415.04 1494.363 410152.8 801771.5</code></pre>
</div>
</div>
<p>We can see that the corresponding results for model 2: (2,1,1)(0,1,1) is slightly better. Which is not the same as the conclusion from above, the reason could be that the data points are relatively small. The train and test split can not capture the datasets effectively, which can cause the different conclusion. The model diagnotics from previsou section indicates that the (0,1,1)(0,1,1) is better with smaller errors.</p>
</section>
<section id="step-ahead-in-my-case-1" class="level4">
<h4 class="anchored" data-anchor-id="step-ahead-in-my-case-1">2 step ahead in my case</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">arima</span>(x, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">period=</span><span class="dv">2</span>) ),<span class="at">h=</span>h)}</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 2 steps ahead</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(rmhi, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">2</span>)</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(e) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the MSE values and remove missing values</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">MSE =</span> mse) <span class="sc">%&gt;%</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> MSE)) <span class="sc">+</span> <span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARModels_files/figure-html/unnamed-chunk-125-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From here we can see that the one step ahead has lower MSE, which is better than two step ahead in my case.</p>
</section>
</section>
</section>
</section>
<section id="references-and-codes" class="level1">
<h1>References and Codes</h1>
<ul>
<li>Codes: <a href="https://github.com/zy236yuz5/ANLY5600-TimeSeries">Rmd, Python &amp; Qmd</a></li>
<li>U.S. Bureau of Economic Analysis, Household saving [W398RC1A027NBEA], retrieved from FRED, Federal Reserve Bank of St.&nbsp;Louis; https://fred.stlouisfed.org/series/W398RC1A027NBEA, September 19, 2023.</li>
<li>U.S. Census Bureau, Real Median Household Income in the United States [MEHOINUSA672N], retrieved from FRED, Federal Reserve Bank of St.&nbsp;Louis; https://fred.stlouisfed.org/series/MEHOINUSA672N, September 19, 2023.</li>
<li>U.S. Bureau of Economic Analysis, Gross Domestic Product: Implicit Price Deflator [A191RI1Q225SBEA], retrieved from FRED, Federal Reserve Bank of St.&nbsp;Louis; https://fred.stlouisfed.org/series/A191RI1Q225SBEA, September 18, 2023.</li>
<li>Zillow Group. Accessed April 19, 2023. “Zillow Research Data.” https://www.zillow.com/research/data/.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>