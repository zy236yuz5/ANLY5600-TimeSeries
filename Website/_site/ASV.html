<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Time Series sfdsasdasd - ARIMAX/SARIMAX/VAR</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles/layout.css">
<link rel="stylesheet" href="./styles/layout.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Time Series sfdsasdasd</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./about.html">
 <span class="menu-text">ABOUT ME</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Introduction.html">
 <span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./DataSources.html">
 <span class="menu-text">Data Sources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./DataVis.html">
 <span class="menu-text">Data Visualization</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./EDA.html">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./ARModels.html">
 <span class="menu-text">ARMA/ARIMA/SARIMA Models</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./ASV.html" aria-current="page">
 <span class="menu-text">ARIMAX/SARIMAX/VAR</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./SAF.html">
 <span class="menu-text">Spectral Analysis and Filtering</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./GARCH.html">
 <span class="menu-text">Financial Time Series Models (ARCH/GARCH)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./TS.html">
 <span class="menu-text">Deep Learning for TS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./conclusion.html">
 <span class="menu-text">Conclusions</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#literatue-review-to-choose-variables-and-models" id="toc-literatue-review-to-choose-variables-and-models" class="nav-link active" data-scroll-target="#literatue-review-to-choose-variables-and-models">Literatue Review to choose variables and models</a></li>
  <li><a href="#arimax-home-value-sale-price-rental-price" id="toc-arimax-home-value-sale-price-rental-price" class="nav-link" data-scroll-target="#arimax-home-value-sale-price-rental-price">1. (ARIMAX) Home value ~ Sale price + Rental price</a>
  <ul class="collapse">
  <li><a href="#set-up-the-variables" id="toc-set-up-the-variables" class="nav-link" data-scroll-target="#set-up-the-variables">Set Up The Variables</a></li>
  <li><a href="#auto-fit-the-model" id="toc-auto-fit-the-model" class="nav-link" data-scroll-target="#auto-fit-the-model">Auto Fit The Model</a></li>
  <li><a href="#manual-fit-the-model" id="toc-manual-fit-the-model" class="nav-link" data-scroll-target="#manual-fit-the-model">Manual Fit The Model</a></li>
  <li><a href="#check-the-residuals" id="toc-check-the-residuals" class="nav-link" data-scroll-target="#check-the-residuals">Check The Residuals</a></li>
  <li><a href="#check-acf-and-pacf" id="toc-check-acf-and-pacf" class="nav-link" data-scroll-target="#check-acf-and-pacf">Check ACF and PACF</a></li>
  <li><a href="#differencing-acf-and-pacf" id="toc-differencing-acf-and-pacf" class="nav-link" data-scroll-target="#differencing-acf-and-pacf">Differencing ACF and PACF</a></li>
  <li><a href="#model-diagnotistics" id="toc-model-diagnotistics" class="nav-link" data-scroll-target="#model-diagnotistics">Model Diagnotistics</a></li>
  <li><a href="#compare-the-models" id="toc-compare-the-models" class="nav-link" data-scroll-target="#compare-the-models">Compare The models</a></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation">Cross validation</a></li>
  <li><a href="#fit-the-model" id="toc-fit-the-model" class="nav-link" data-scroll-target="#fit-the-model">Fit the model</a></li>
  <li><a href="#write-down-the-equation" id="toc-write-down-the-equation" class="nav-link" data-scroll-target="#write-down-the-equation">Write Down The equation:</a></li>
  <li><a href="#forecasting" id="toc-forecasting" class="nav-link" data-scroll-target="#forecasting">Forecasting</a></li>
  </ul></li>
  <li><a href="#arimax-saving-rate-household-income-household-saving" id="toc-arimax-saving-rate-household-income-household-saving" class="nav-link" data-scroll-target="#arimax-saving-rate-household-income-household-saving">2. (ARIMAX) Saving Rate ~ Household Income + Household Saving</a>
  <ul class="collapse">
  <li><a href="#creating-ts-objects-for-variables" id="toc-creating-ts-objects-for-variables" class="nav-link" data-scroll-target="#creating-ts-objects-for-variables">Creating Ts Objects For Variables</a></li>
  <li><a href="#combine-the-varaibles" id="toc-combine-the-varaibles" class="nav-link" data-scroll-target="#combine-the-varaibles">Combine the Varaibles</a></li>
  <li><a href="#make-a-log-transformation-for-seasonal-pattern" id="toc-make-a-log-transformation-for-seasonal-pattern" class="nav-link" data-scroll-target="#make-a-log-transformation-for-seasonal-pattern">Make a Log transformation For Seasonal Pattern</a></li>
  <li><a href="#auto-fit-the-model-1" id="toc-auto-fit-the-model-1" class="nav-link" data-scroll-target="#auto-fit-the-model-1">Auto Fit The Model</a></li>
  <li><a href="#manual-fit-the-model-1" id="toc-manual-fit-the-model-1" class="nav-link" data-scroll-target="#manual-fit-the-model-1">Manual Fit The model</a></li>
  <li><a href="#manual-fit-again-without-insignificant-variable" id="toc-manual-fit-again-without-insignificant-variable" class="nav-link" data-scroll-target="#manual-fit-again-without-insignificant-variable">Manual Fit Again Without Insignificant Variable</a></li>
  <li><a href="#check-residuals" id="toc-check-residuals" class="nav-link" data-scroll-target="#check-residuals">Check residuals</a></li>
  <li><a href="#acf-and-pacf-check" id="toc-acf-and-pacf-check" class="nav-link" data-scroll-target="#acf-and-pacf-check">ACF and PACF Check</a></li>
  <li><a href="#no-need-for-seasonal-differencing" id="toc-no-need-for-seasonal-differencing" class="nav-link" data-scroll-target="#no-need-for-seasonal-differencing">No Need For Seasonal Differencing</a></li>
  <li><a href="#model-diagnotistics-1" id="toc-model-diagnotistics-1" class="nav-link" data-scroll-target="#model-diagnotistics-1">Model Diagnotistics</a></li>
  <li><a href="#compare-the-models-1" id="toc-compare-the-models-1" class="nav-link" data-scroll-target="#compare-the-models-1">Compare The Models</a></li>
  <li><a href="#cross-validation-1" id="toc-cross-validation-1" class="nav-link" data-scroll-target="#cross-validation-1">Cross validation</a></li>
  <li><a href="#fit-the-model-with-the-best-one" id="toc-fit-the-model-with-the-best-one" class="nav-link" data-scroll-target="#fit-the-model-with-the-best-one">Fit the model With The Best One</a></li>
  <li><a href="#write-doen-the-equation" id="toc-write-doen-the-equation" class="nav-link" data-scroll-target="#write-doen-the-equation">Write Doen The equation:</a></li>
  <li><a href="#forecasting-1" id="toc-forecasting-1" class="nav-link" data-scroll-target="#forecasting-1">Forecasting</a></li>
  </ul></li>
  <li><a href="#var-sale-price-saving-rate-gdp-deflator" id="toc-var-sale-price-saving-rate-gdp-deflator" class="nav-link" data-scroll-target="#var-sale-price-saving-rate-gdp-deflator">3. (VAR) Sale Price &amp; Saving Rate &amp; Gdp Deflator</a>
  <ul class="collapse">
  <li><a href="#transform-all-to-time-series" id="toc-transform-all-to-time-series" class="nav-link" data-scroll-target="#transform-all-to-time-series">Transform all to time series</a></li>
  <li><a href="#prepare-variables-saving-rate-sale-price-gdp-deflator" id="toc-prepare-variables-saving-rate-sale-price-gdp-deflator" class="nav-link" data-scroll-target="#prepare-variables-saving-rate-sale-price-gdp-deflator">Prepare Variables: saving rate, sale price, gdp deflator</a></li>
  <li><a href="#combine-variables" id="toc-combine-variables" class="nav-link" data-scroll-target="#combine-variables">Combine Variables</a></li>
  <li><a href="#plot-the-variables-together" id="toc-plot-the-variables-together" class="nav-link" data-scroll-target="#plot-the-variables-together">Plot the Variables Together</a></li>
  <li><a href="#finding-out-the-best-p" id="toc-finding-out-the-best-p" class="nav-link" data-scroll-target="#finding-out-the-best-p">Finding out the best p:</a></li>
  <li><a href="#fitting-a-var-model-with-different-p" id="toc-fitting-a-var-model-with-different-p" class="nav-link" data-scroll-target="#fitting-a-var-model-with-different-p">Fitting a VAR model with different p:</a></li>
  <li><a href="#cross-validations" id="toc-cross-validations" class="nav-link" data-scroll-target="#cross-validations">Cross Validations</a>
  <ul class="collapse">
  <li><a href="#define-length" id="toc-define-length" class="nav-link" data-scroll-target="#define-length">Define length</a></li>
  <li><a href="#cross-validation-for-gdp-deflator" id="toc-cross-validation-for-gdp-deflator" class="nav-link" data-scroll-target="#cross-validation-for-gdp-deflator">Cross Validation For gdp deflator</a></li>
  <li><a href="#cross-validation-for-saving-rate" id="toc-cross-validation-for-saving-rate" class="nav-link" data-scroll-target="#cross-validation-for-saving-rate">Cross Validation For Saving rate</a></li>
  <li><a href="#cross-validation-for-sale-price" id="toc-cross-validation-for-sale-price" class="nav-link" data-scroll-target="#cross-validation-for-sale-price">Cross Validation For Sale price</a></li>
  </ul></li>
  <li><a href="#forecasting-2" id="toc-forecasting-2" class="nav-link" data-scroll-target="#forecasting-2">Forecasting</a>
  <ul class="collapse">
  <li><a href="#check-corresponind-forecasting" id="toc-check-corresponind-forecasting" class="nav-link" data-scroll-target="#check-corresponind-forecasting">Check Corresponind Forecasting</a></li>
  </ul></li>
  <li><a href="#forecast-results" id="toc-forecast-results" class="nav-link" data-scroll-target="#forecast-results">Forecast Results</a></li>
  </ul></li>
  <li><a href="#arimax-gini-index-household-income-household-saving-sale-price" id="toc-arimax-gini-index-household-income-household-saving-sale-price" class="nav-link" data-scroll-target="#arimax-gini-index-household-income-household-saving-sale-price">4. (ARIMAX) GINI Index ~ Household Income + Household Saving + Sale Price</a>
  <ul class="collapse">
  <li><a href="#prepare-the-variables" id="toc-prepare-the-variables" class="nav-link" data-scroll-target="#prepare-the-variables">Prepare the Variables</a></li>
  <li><a href="#combine-the-variables" id="toc-combine-the-variables" class="nav-link" data-scroll-target="#combine-the-variables">Combine the Variables</a></li>
  <li><a href="#auto-fit-the-model-2" id="toc-auto-fit-the-model-2" class="nav-link" data-scroll-target="#auto-fit-the-model-2">Auto Fit the Model</a></li>
  <li><a href="#manual-fit-the-model-2" id="toc-manual-fit-the-model-2" class="nav-link" data-scroll-target="#manual-fit-the-model-2">Manual Fit The Model</a></li>
  <li><a href="#manual-fit-again" id="toc-manual-fit-again" class="nav-link" data-scroll-target="#manual-fit-again">Manual Fit Again</a></li>
  <li><a href="#check-residuals-1" id="toc-check-residuals-1" class="nav-link" data-scroll-target="#check-residuals-1">Check Residuals</a></li>
  <li><a href="#check-acf-and-pacf-1" id="toc-check-acf-and-pacf-1" class="nav-link" data-scroll-target="#check-acf-and-pacf-1">Check ACF and PACF</a></li>
  <li><a href="#no-need-to-differencing" id="toc-no-need-to-differencing" class="nav-link" data-scroll-target="#no-need-to-differencing">NO Need To Differencing</a></li>
  <li><a href="#model-diagnotistics-2" id="toc-model-diagnotistics-2" class="nav-link" data-scroll-target="#model-diagnotistics-2">Model Diagnotistics</a></li>
  <li><a href="#compare-with-the-two-models" id="toc-compare-with-the-two-models" class="nav-link" data-scroll-target="#compare-with-the-two-models">Compare with the two models</a></li>
  <li><a href="#cross-validation-2" id="toc-cross-validation-2" class="nav-link" data-scroll-target="#cross-validation-2">Cross validation</a></li>
  <li><a href="#fit-the-model-1" id="toc-fit-the-model-1" class="nav-link" data-scroll-target="#fit-the-model-1">Fit the model</a></li>
  <li><a href="#forecast" id="toc-forecast" class="nav-link" data-scroll-target="#forecast">Forecast</a></li>
  </ul></li>
  <li><a href="#var-home-value-saving-rate-gdp-deflator-sale-price" id="toc-var-home-value-saving-rate-gdp-deflator-sale-price" class="nav-link" data-scroll-target="#var-home-value-saving-rate-gdp-deflator-sale-price">5. (VAR) Home Value ~ Saving Rate + Gdp Deflator + Sale Price</a>
  <ul class="collapse">
  <li><a href="#time-series-transformation" id="toc-time-series-transformation" class="nav-link" data-scroll-target="#time-series-transformation">Time Series Transformation</a></li>
  <li><a href="#select-the-variables-with-common-dates" id="toc-select-the-variables-with-common-dates" class="nav-link" data-scroll-target="#select-the-variables-with-common-dates">Select the Variables with common Dates</a></li>
  <li><a href="#combine-the-variables-1" id="toc-combine-the-variables-1" class="nav-link" data-scroll-target="#combine-the-variables-1">Combine the Variables</a></li>
  <li><a href="#plot-the-figure-together" id="toc-plot-the-figure-together" class="nav-link" data-scroll-target="#plot-the-figure-together">Plot the Figure Together</a></li>
  <li><a href="#fitting-a-var-model" id="toc-fitting-a-var-model" class="nav-link" data-scroll-target="#fitting-a-var-model">Fitting a VAR model</a></li>
  <li><a href="#cross-validations-1" id="toc-cross-validations-1" class="nav-link" data-scroll-target="#cross-validations-1">Cross Validations</a>
  <ul class="collapse">
  <li><a href="#cross-validation-for-home-value" id="toc-cross-validation-for-home-value" class="nav-link" data-scroll-target="#cross-validation-for-home-value">Cross Validation For Home Value</a></li>
  <li><a href="#cross-validation-for-saving-rate-1" id="toc-cross-validation-for-saving-rate-1" class="nav-link" data-scroll-target="#cross-validation-for-saving-rate-1">Cross Validation For Saving Rate</a></li>
  <li><a href="#cross-validation-for-gdp-deflator-1" id="toc-cross-validation-for-gdp-deflator-1" class="nav-link" data-scroll-target="#cross-validation-for-gdp-deflator-1">Cross Validation For GDP Deflator</a></li>
  <li><a href="#cross-validation-for-sale-price-1" id="toc-cross-validation-for-sale-price-1" class="nav-link" data-scroll-target="#cross-validation-for-sale-price-1">Cross Validation For Sale Price</a></li>
  </ul></li>
  <li><a href="#forecasts" id="toc-forecasts" class="nav-link" data-scroll-target="#forecasts">Forecasts</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ARIMAX/SARIMAX/VAR</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Discription:</p>
<section id="literatue-review-to-choose-variables-and-models" class="level1">
<h1>Literatue Review to choose variables and models</h1>
<p>The key of my project big picture is to identify the impacts and correlations among Incomes and Housing Prices. Therefore, houseing prices such as home values, sale prices, and rental prices are very crucial to utilize models. Different aspects of the feature will be included such as the housing prices, incomes, gdp, gini index to check the affordability. By using the datasets and factors, we can evaluate the correlations and impacts among them to better help us understand the effect and gain insights about the disparities and inbalance of the wealth. In addition, it can also help us to make predictions for the future such that we can act now to solve the potential global issues.</p>
<p>Therefore, my models would be:</p>
<ol type="1">
<li>ARIMAX Model for Home Value ~ Sale Price + Rental Price</li>
</ol>
<p>The reason is that I think that Sale and rental prices are directly linked to home values. The sale price is an immediate indicator of market valuation, while rental prices reflect ongoing demand and income potential from properties. I expect a strong correlation between these variables and home value. By utilizing the ARIMAX Model, it can help me capture both the time series nature of housing data and the sale and rental prices to get a better understanding of the situation.</p>
<p>Then, the first model focus on the Housing Prices, the second model will focus on the income parts. The goal of my project is to find correlations and impacts among these features. Therefore, in this case, for personal income, saving rate and household savings are important factors that I should include in my analsyis.</p>
<ol start="2" type="1">
<li>ARIMAX Model for Saving Rate ~ Household Income + Household Saving</li>
</ol>
<p>The reason for chooing these three variables is that Household income and savings are fundamental determinants of the saving rate. Increased income typically leads to higher saving rates. Household savings directly contribute to the overall saving rate. And with more savings, there are more chances to look for a new home or look for a higher home prices. Which can also be connected to me first model.</p>
<p>Then, I must also evaluate the economic as a whole. Tehrefore, gdp deflator would be a good choice. By using, gdp, sale price, and saving rate, I combine the bigger effect of economic, individual aspect, and the market sale price together to evaluate the correlations and impacts.</p>
<ol start="3" type="1">
<li>VAR Model for Sale Price, Saving Rate, GDP Deflator</li>
</ol>
<p>I choose (VAR) model because I think that it is suitable for multivariate time series data where variables are interdependent. Since I want to look for connections among these three features, VAR allows for the examination of how a variable is affected by its own lagged values and the lagged values of others, crucial in studying economic systems.</p>
<ol start="4" type="1">
<li>ARIMAX Model for GINI Index (Household Income + Household Saving + Sale Price)</li>
</ol>
<p>Then, I decide to use the GINI index as my fourth major objective in ARIMAX model. It is a measure of income inequality, which also be affected by household income, savings, and property values. Higher income and savings typically indicate more wealth but there are many people that do not have high wealth which make the inequality. The sale price of homes can reflect wealth disparities as well. Therefore, the usage of the three variables and ARIMAX model can help capturing both the influences of these specific among each other and the time series nature of the GINI index. This model helps understand how current and past economic conditions impact income inequality.</p>
<p>Finally, I plan to use var model on home value, saving rate, gdp deflator, and sale price. The reason: Home values are also influenced by overall economic conditions, represented by the GDP deflator, and directly by the housing market dynamics, represented by sale prices. And by adding the saving rate, we can see that what are the total impacts of these varaibles as a whole.</p>
<ol start="5" type="1">
<li>VAR Model for Home Value (Saving Rate + GDP Deflator + Sale Price)</li>
</ol>
<p>A VAR model is very suitable for understanding the interactions as a whole. It allows for the assessment of how each variable influences and is influenced by the others over time, crucial in real estate economics.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>saving <span class="ot">=</span><span class="fu">ts</span>(df1<span class="sc">$</span>W398RC1A027NBEA)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>income <span class="ot">=</span><span class="fu">ts</span>(df2<span class="sc">$</span>MEHOINUSA672N)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>gini <span class="ot">=</span><span class="fu">ts</span>(df4<span class="sc">$</span>SIPOVGINIUSA)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>afford <span class="ot">=</span><span class="fu">ts</span>(df5<span class="sc">$</span>FIXHAI)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>saverate <span class="ot">=</span><span class="fu">ts</span>(df6<span class="sc">$</span>PSAVERT)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>gdp <span class="ot">=</span><span class="fu">ts</span>(df7<span class="sc">$</span>A191RI1Q225SBEA)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>saleprice <span class="ot">=</span><span class="fu">ts</span>(df8<span class="sc">$</span>Mean.Sale.Price)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>homevalue <span class="ot">=</span><span class="fu">ts</span>(df8<span class="sc">$</span>Mean.Home.Value)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>rentalprice <span class="ot">=</span><span class="fu">ts</span>(df8<span class="sc">$</span>mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="arimax-home-value-sale-price-rental-price" class="level1">
<h1>1. (ARIMAX) Home value ~ Sale price + Rental price</h1>
<section id="set-up-the-variables" class="level2">
<h2 class="anchored" data-anchor-id="set-up-the-variables">Set Up The Variables</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dd1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(homevalue,saleprice,rentalprice,df8<span class="sc">$</span>date)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dd1)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"homevalue"</span>,<span class="st">"saleprice"</span>,<span class="st">"rentalprice"</span>,<span class="st">'date'</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dd1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">homevalue</th>
<th style="text-align: right;">saleprice</th>
<th style="text-align: right;">rentalprice</th>
<th style="text-align: left;">date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">381885.7</td>
<td style="text-align: right;">394588</td>
<td style="text-align: right;">1489.368</td>
<td style="text-align: left;">2018-08-31</td>
</tr>
<tr class="even">
<td style="text-align: right;">383510.8</td>
<td style="text-align: right;">396351</td>
<td style="text-align: right;">1495.171</td>
<td style="text-align: left;">2018-09-30</td>
</tr>
<tr class="odd">
<td style="text-align: right;">384594.7</td>
<td style="text-align: right;">391015</td>
<td style="text-align: right;">1492.019</td>
<td style="text-align: left;">2018-10-31</td>
</tr>
<tr class="even">
<td style="text-align: right;">385442.7</td>
<td style="text-align: right;">385500</td>
<td style="text-align: right;">1483.661</td>
<td style="text-align: left;">2018-11-30</td>
</tr>
<tr class="odd">
<td style="text-align: right;">387043.6</td>
<td style="text-align: right;">384032</td>
<td style="text-align: right;">1482.177</td>
<td style="text-align: left;">2018-12-31</td>
</tr>
<tr class="even">
<td style="text-align: right;">389061.8</td>
<td style="text-align: right;">385450</td>
<td style="text-align: right;">1477.878</td>
<td style="text-align: left;">2019-01-31</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>lg.dd1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"date"</span> <span class="ot">=</span>dd1<span class="sc">$</span>date,<span class="st">"homevalue"</span><span class="ot">=</span><span class="fu">log</span>(dd1<span class="sc">$</span>homevalue),<span class="st">"saleprice"</span><span class="ot">=</span><span class="fu">log</span>(dd1<span class="sc">$</span>saleprice),</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"rentalprice"</span><span class="ot">=</span><span class="fu">log</span>(dd1<span class="sc">$</span>rentalprice))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="do">#### converting to time series component #########</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>lg.dd.ts1<span class="ot">&lt;-</span><span class="fu">ts</span>(lg.dd1,<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="do">##### Facet Plot #######################</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(lg.dd.ts1[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"The Household Prices in USA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="auto-fit-the-model" class="level2">
<h2 class="anchored" data-anchor-id="auto-fit-the-model">Auto Fit The Model</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>xreg1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">saleprice =</span> lg.dd.ts1[, <span class="st">"saleprice"</span>],</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">rentalprice =</span> lg.dd.ts1[, <span class="st">"rentalprice"</span>])</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(lg.dd.ts1[, <span class="st">"homevalue"</span>], <span class="at">xreg =</span> xreg1)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lg.dd.ts1[, "homevalue"] 
Regression with ARIMA(2,1,2) errors 

Coefficients:
         ar1     ar2     ma1      ma2  saleprice  rentalprice
      0.0357  0.4180  -0.463  -0.4912     0.8765       0.1160
s.e.  0.1418  0.0786   0.147   0.1386     0.0422       0.0354

sigma^2 = 0.007652:  log likelihood = 1100.12
AIC=-2186.23   AICc=-2186.13   BIC=-2151.35

Training set error measures:
                      ME       RMSE        MAE        MPE      MAPE      MASE
Training set 0.001968005 0.08719397 0.02695833 0.01034377 0.2024629 0.3681705
                    ACF1
Training set 0.002220954</code></pre>
</div>
</div>
</section>
<section id="manual-fit-the-model" class="level2">
<h2 class="anchored" data-anchor-id="manual-fit-the-model">Manual Fit The Model</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fit.reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( homevalue <span class="sc">~</span> saleprice<span class="sc">+</span> rentalprice, <span class="at">data=</span>lg.dd.ts1)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.reg1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = homevalue ~ saleprice + rentalprice, data = lg.dd.ts1)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.68312 -0.03521 -0.00042  0.03629  0.27205 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.49700    0.18542   2.680  0.00747 ** 
saleprice    0.93209    0.01680  55.472  &lt; 2e-16 ***
rentalprice  0.05678    0.01422   3.993 6.96e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1184 on 1077 degrees of freedom
Multiple R-squared:  0.823, Adjusted R-squared:  0.8227 
F-statistic:  2504 on 2 and 1077 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>We can see that the variables are pretty significant.</p>
</section>
<section id="check-the-residuals" class="level2">
<h2 class="anchored" data-anchor-id="check-the-residuals">Check The Residuals</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(2,1,2) errors
Q* = 8.9982, df = 4, p-value = 0.06114

Model df: 4.   Total lags used: 8</code></pre>
</div>
</div>
<p>Based on the output, there’s no indication that seasonal terms are being used and the datasets did not have too much seasonal pattern. Therefore, this is an ARIMAX model.</p>
</section>
<section id="check-acf-and-pacf" class="level2">
<h2 class="anchored" data-anchor-id="check-acf-and-pacf">Check ACF and PACF</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">########### Converting to Time Series component #######</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>res.fit1<span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">residuals</span>(fit.reg1),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="do">############## Then look at the residuals ############</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(res.fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggPacf</span>(res.fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Since there is no major seasonal pattern. We use differencing directly</p>
</section>
<section id="differencing-acf-and-pacf" class="level2">
<h2 class="anchored" data-anchor-id="differencing-acf-and-pacf">Differencing ACF and PACF</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the ACF and PACF plots without the theme</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>acf_plot <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(<span class="fu">diff</span>(res.fit1, <span class="at">differences =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ACF for first Order of Differencing and Seasonal Differenceing"</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>pacf_plot <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(<span class="fu">diff</span>(res.fit1, <span class="at">differences =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"PACF for first Orders of Differencing and Seasonal Differenceing"</span>) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(acf_plot, pacf_plot, <span class="at">ncol =</span> <span class="dv">1</span>)             </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now, it is mostly stationary for us to continue From ACF and PACF, it seems that we can consider: p = 1,2,3 q = 1,2,3. We use first order of differencing so d = 1. There is no major seasonal pattern, therefore, no P,Q,D in this case.</p>
</section>
<section id="model-diagnotistics" class="level2">
<h2 class="anchored" data-anchor-id="model-diagnotistics">Model Diagnotistics</h2>
<p>Finding the model parameters.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">23</span>),<span class="at">nrow=</span><span class="dv">23</span>) <span class="co"># roughly nrow = 3x4x2</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>)<span class="co"># p=1,2,3 : 3</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>)<span class="co"># q=1,2,3,4 :4</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)<span class="co"># d=1,2 :2</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(res.fit1,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>) </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-2185.822</td>
<td style="text-align: right;">-2155.919</td>
<td style="text-align: right;">-2185.743</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-2163.551</td>
<td style="text-align: right;">-2138.637</td>
<td style="text-align: right;">-2163.495</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-2031.719</td>
<td style="text-align: right;">-2006.809</td>
<td style="text-align: right;">-2031.663</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-2183.857</td>
<td style="text-align: right;">-2148.971</td>
<td style="text-align: right;">-2183.753</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-2168.936</td>
<td style="text-align: right;">-2139.039</td>
<td style="text-align: right;">-2168.858</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-2024.416</td>
<td style="text-align: right;">-1994.525</td>
<td style="text-align: right;">-2024.338</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-2194.287</td>
<td style="text-align: right;">-2154.417</td>
<td style="text-align: right;">-2194.153</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-2166.447</td>
<td style="text-align: right;">-2131.567</td>
<td style="text-align: right;">-2166.343</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-2183.841</td>
<td style="text-align: right;">-2148.954</td>
<td style="text-align: right;">-2183.736</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-2164.637</td>
<td style="text-align: right;">-2134.740</td>
<td style="text-align: right;">-2164.558</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-2075.699</td>
<td style="text-align: right;">-2045.808</td>
<td style="text-align: right;">-2075.621</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-2183.029</td>
<td style="text-align: right;">-2143.159</td>
<td style="text-align: right;">-2182.895</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-2167.183</td>
<td style="text-align: right;">-2132.303</td>
<td style="text-align: right;">-2167.078</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-2192.632</td>
<td style="text-align: right;">-2147.778</td>
<td style="text-align: right;">-2192.464</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-2192.881</td>
<td style="text-align: right;">-2153.011</td>
<td style="text-align: right;">-2192.747</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-2171.137</td>
<td style="text-align: right;">-2136.257</td>
<td style="text-align: right;">-2171.032</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-2190.880</td>
<td style="text-align: right;">-2146.026</td>
<td style="text-align: right;">-2190.712</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q       AIC       BIC      AICc
7 2 1 4 -2194.287 -2154.417 -2194.153</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q       AIC       BIC      AICc
1 2 1 2 -2185.822 -2155.919 -2185.743</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q       AIC       BIC      AICc
7 2 1 4 -2194.287 -2154.417 -2194.153</code></pre>
</div>
</div>
<p>From here, we have two potential ones: (2,1,2) and (2,1,4)</p>
</section>
<section id="compare-the-models" class="level2">
<h2 class="anchored" data-anchor-id="compare-the-models">Compare The models</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">236</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>model_output11 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit1, <span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>model_output12 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit1, <span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output11[<span class="dv">90</span><span class="sc">:</span><span class="dv">123</span>], model_output11[<span class="fu">length</span>(model_output11)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
    xreg = constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
        REPORT = 1, reltol = tol))

Coefficients:
         ar1     ar2      ma1     ma2      ma3     ma4  constant
      0.8239  0.0553  -1.2526  0.1997  -0.1235  0.1795     1e-04
s.e.  0.1938  0.1511   0.1916  0.2323   0.0649  0.0393     1e-04

sigma^2 estimated as 0.007533:  log likelihood = 1105.14,  aic = -2194.29

$degrees_of_freedom
[1] 1072

$ttable
         Estimate     SE t.value p.value
ar1        0.8239 0.1938  4.2522  0.0000
ar2        0.0553 0.1511  0.3662  0.7143
ma1       -1.2526 0.1916 -6.5386  0.0000
ma2        0.1997 0.2323  0.8597  0.3901
ma3       -0.1235 0.0649 -1.9028  0.0573
ma4        0.1795 0.0393  4.5726  0.0000
constant   0.0001 0.0001  0.6131  0.5399

$AIC
[1] -2.03363

$AICc
[1] -2.033534

$BIC
[1] -1.996679</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output12[<span class="dv">40</span><span class="sc">:</span><span class="dv">70</span>], model_output12[<span class="fu">length</span>(model_output12)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
    xreg = constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
        REPORT = 1, reltol = tol))

Coefficients:
         ar1     ar2      ma1      ma2  constant
      0.0580  0.4279  -0.4812  -0.4893     1e-04
s.e.  0.1428  0.0806   0.1486   0.1408     2e-04

sigma^2 estimated as 0.007625:  log likelihood = 1098.91,  aic = -2185.82

$degrees_of_freedom
[1] 1074

$ttable
         Estimate     SE t.value p.value
ar1        0.0580 0.1428  0.4063  0.6846
ar2        0.4279 0.0806  5.3077  0.0000
ma1       -0.4812 0.1486 -3.2384  0.0012
ma2       -0.4893 0.1408 -3.4748  0.0005
constant   0.0001 0.0002  0.6602  0.5093

$AIC
[1] -2.025785

$AICc
[1] -2.025733

$BIC
[1] -1.998071</code></pre>
</div>
</div>
<p>Based on this, I think the second one (2,1,4) is slightly better with less correlation and smaller AIC value.</p>
</section>
<section id="cross-validation" class="level2">
<h2 class="anchored" data-anchor-id="cross-validation">Cross validation</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(res.fit1)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>n <span class="sc">*</span><span class="fl">0.3</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 324</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">324</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">53</span>,<span class="dv">4</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>rmse2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">53</span>,<span class="dv">4</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>rmse3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">53</span>,<span class="dv">4</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(res.fit1)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">4</span> </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">53</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(res.fit1, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(res.fit1, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>),</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  rmse1[i,<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(xtest)]  <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>  rmse2[i,<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(xtest)] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">colMeans</span>(rmse1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">colMeans</span>(rmse2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"fit1"</span>,<span class="st">"fit2"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>( rmse1,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01282484 0.01701977 0.02336799 0.02397791</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>( rmse2,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01368543 0.02028240 0.02719078 0.02635619</code></pre>
</div>
</div>
<p>Based on the cross validation, we can see that the conclusion aligns, the fit1 which is (2,1,4) performs better with smaller errors.</p>
</section>
<section id="fit-the-model" class="level2">
<h2 class="anchored" data-anchor-id="fit-the-model">Fit the model</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>xreg1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">saleprice =</span> lg.dd.ts1[, <span class="st">"saleprice"</span>],</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">rentalprice =</span> lg.dd.ts1[, <span class="st">"rentalprice"</span>])</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(lg.dd.ts1[, <span class="st">"homevalue"</span>],<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>),<span class="at">xreg=</span>xreg1)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lg.dd.ts1[, "homevalue"] 
Regression with ARIMA(2,1,4) errors 

Coefficients:
         ar1     ar2      ma1     ma2      ma3     ma4  saleprice  rentalprice
      0.8151  0.0766  -1.2454  0.1814  -0.1233  0.1903     0.8651       0.1058
s.e.  0.1952  0.1493   0.1934  0.2331   0.0684  0.0400     0.0433       0.0358

sigma^2 = 0.007576:  log likelihood = 1106.15
AIC=-2194.31   AICc=-2194.14   BIC=-2149.45

Training set error measures:
                      ME       RMSE        MAE        MPE      MAPE      MASE
Training set 0.002244825 0.08667672 0.02677427 0.01221504 0.2010633 0.3656567
                     ACF1
Training set -0.001078051</code></pre>
</div>
</div>
</section>
<section id="write-down-the-equation" class="level2">
<h2 class="anchored" data-anchor-id="write-down-the-equation">Write Down The equation:</h2>
<p>Given that <code>y_t</code> represents the log-transformed <code>homevalue</code> at time <code>t</code>, the ARIMA(2,1,4) can be:</p>
<p>(1 - φ₁B - φ₂B²)(1 - B)yₜ = α + β₁ * salepriceₜ + β₂ * rentalpriceₜ + (1 + θ₁B + θ₂B² + θ₃B³ + θ₄B⁴)εₜ</p>
<p>Based on the summary, my equation is</p>
<p>(1 - 0.8151B - 0.0766B²)(1 - B)yₜ = α + 0.8651 * salepriceₜ + 0.1058 * rentalpriceₜ + (1 - 1.2454B + 0.1814B² - 0.1233B³ + 0.1903B⁴)εₜ</p>
</section>
<section id="forecasting" class="level2">
<h2 class="anchored" data-anchor-id="forecasting">Forecasting</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>spfit<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(lg.dd.ts1[, <span class="st">"saleprice"</span>]) </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(spfit) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lg.dd.ts1[, "saleprice"] 
ARIMA(0,1,0) 

sigma^2 = 0.004229:  log likelihood = 1417.77
AIC=-2833.53   AICc=-2833.53   BIC=-2828.55

Training set error measures:
                       ME       RMSE        MAE         MPE      MAPE      MASE
Training set 0.0005143487 0.06500146 0.02430292 0.002720093 0.1819437 0.3527218
                   ACF1
Training set 0.05157596</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fsp<span class="ot">&lt;-</span><span class="fu">forecast</span>(spfit,<span class="dv">80</span>) <span class="co">#obtaining forecasts</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>rpfit<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(lg.dd.ts1[, <span class="st">"rentalprice"</span>]) <span class="co">#fitting an ARIMA model to the Import variable</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rpfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lg.dd.ts1[, "rentalprice"] 
ARIMA(0,1,1) 

Coefficients:
          ma1
      -0.1423
s.e.   0.0308

sigma^2 = 0.006889:  log likelihood = 1155.01
AIC=-2306.01   AICc=-2306   BIC=-2296.05

Training set error measures:
                     ME       RMSE        MAE         MPE      MAPE      MASE
Training set 0.00063182 0.08292248 0.02052085 0.001505318 0.2698055 0.3434587
                    ACF1
Training set 0.001944753</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>frp<span class="ot">&lt;-</span><span class="fu">forecast</span>(rpfit,<span class="dv">80</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>fxreg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">saleprice =</span> fsp<span class="sc">$</span>mean, </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">rentalprice =</span> frp<span class="sc">$</span>mean) <span class="co">#fimp$mean gives the forecasted values</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit1, <span class="at">xreg=</span>fxreg,<span class="dv">80</span>) </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast, <span class="at">main=</span><span class="st">"Forecast of Home Values"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Home"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on the forecast, we can see that the model did capture the seasonal contents where it predict the downfall of the data.</p>
</section>
</section>
<section id="arimax-saving-rate-household-income-household-saving" class="level1">
<h1>2. (ARIMAX) Saving Rate ~ Household Income + Household Saving</h1>
<section id="creating-ts-objects-for-variables" class="level2">
<h2 class="anchored" data-anchor-id="creating-ts-objects-for-variables">Creating Ts Objects For Variables</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define start and end dates</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"1992-01-01"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-12-31"</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data frames to include only data from 1992 through 2020</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>df1_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(df1, DATE <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end_date)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>df2_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(df2, DATE <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end_date)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>df6_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(df6, DATE <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end_date)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming the data is annual for this example. If it's quarterly, you'd use frequency = 4; if monthly, frequency = 12.</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>frequency <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ts objects</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>saving <span class="ot">&lt;-</span> <span class="fu">ts</span>(df1_sub<span class="sc">$</span>W398RC1A027NBEA, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1992</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">ts</span>(df2_sub<span class="sc">$</span>MEHOINUSA672N, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1992</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fu">ts</span>(df6_sub<span class="sc">$</span>PSAVERT, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1992</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>saving rate, income, saveing can be interesting to be evaluated</p>
</section>
<section id="combine-the-varaibles" class="level2">
<h2 class="anchored" data-anchor-id="combine-the-varaibles">Combine the Varaibles</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>dd2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(rate,saving,income,df1_sub<span class="sc">$</span>DATE)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dd2)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"saving_rate"</span>,<span class="st">"household_saving"</span>,<span class="st">"household_income"</span>,<span class="st">'date'</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dd2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">saving_rate</th>
<th style="text-align: right;">household_saving</th>
<th style="text-align: right;">household_income</th>
<th style="text-align: left;">date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">9.4</td>
<td style="text-align: right;">431.693</td>
<td style="text-align: right;">58153</td>
<td style="text-align: left;">1992-01-01</td>
</tr>
<tr class="even">
<td style="text-align: right;">9.8</td>
<td style="text-align: right;">377.899</td>
<td style="text-align: right;">57843</td>
<td style="text-align: left;">1993-01-01</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9.7</td>
<td style="text-align: right;">345.198</td>
<td style="text-align: right;">58515</td>
<td style="text-align: left;">1994-01-01</td>
</tr>
<tr class="even">
<td style="text-align: right;">9.9</td>
<td style="text-align: right;">366.774</td>
<td style="text-align: right;">60348</td>
<td style="text-align: left;">1995-01-01</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9.9</td>
<td style="text-align: right;">353.639</td>
<td style="text-align: right;">61225</td>
<td style="text-align: left;">1996-01-01</td>
</tr>
<tr class="even">
<td style="text-align: right;">10.1</td>
<td style="text-align: right;">339.566</td>
<td style="text-align: right;">62484</td>
<td style="text-align: left;">1997-01-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="make-a-log-transformation-for-seasonal-pattern" class="level2">
<h2 class="anchored" data-anchor-id="make-a-log-transformation-for-seasonal-pattern">Make a Log transformation For Seasonal Pattern</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>lg.dd2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"date"</span> <span class="ot">=</span>dd2<span class="sc">$</span>date,<span class="st">"saving_rate"</span><span class="ot">=</span><span class="fu">log</span>(dd2<span class="sc">$</span>saving_rate),<span class="st">"household_saving"</span><span class="ot">=</span><span class="fu">log</span>(dd2<span class="sc">$</span>household_saving),</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"household_income"</span><span class="ot">=</span><span class="fu">log</span>(dd2<span class="sc">$</span>household_income))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="do">#### converting to time series component #########</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>lg.dd.ts2<span class="ot">&lt;-</span><span class="fu">ts</span>(lg.dd2,<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="do">##### Facet Plot #######################</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(lg.dd.ts2[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"The Household Prices in USA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="auto-fit-the-model-1" class="level2">
<h2 class="anchored" data-anchor-id="auto-fit-the-model-1">Auto Fit The Model</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>xreg2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">household_income =</span> lg.dd.ts2[, <span class="st">"household_income"</span>],</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">household_saving =</span> lg.dd.ts2[, <span class="st">"household_saving"</span>])</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(lg.dd.ts2[, <span class="st">"saving_rate"</span>], <span class="at">xreg =</span> xreg2)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lg.dd.ts2[, "saving_rate"] 
Regression with ARIMA(0,0,0) errors 

Coefficients:
      household_income  household_saving
                0.3057           -0.1981
s.e.            0.0191            0.0328

sigma^2 = 0.01216:  log likelihood = 23.83
AIC=-41.66   AICc=-40.7   BIC=-37.56

Training set error measures:
                       ME      RMSE        MAE        MPE     MAPE      MASE
Training set 0.0001058585 0.1063899 0.08808777 -0.2509742 4.206073 0.7528751
                  ACF1
Training set 0.1430342</code></pre>
</div>
</div>
</section>
<section id="manual-fit-the-model-1" class="level2">
<h2 class="anchored" data-anchor-id="manual-fit-the-model-1">Manual Fit The model</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fit.reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>( saving_rate <span class="sc">~</span>  household_saving <span class="sc">+</span> household_income, <span class="at">data=</span>lg.dd.ts2)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.reg2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = saving_rate ~ household_saving + household_income, 
    data = lg.dd.ts2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.20674 -0.06359 -0.01653  0.06697  0.23007 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       5.24855    4.53045   1.159    0.257    
household_saving -0.18141    0.03676  -4.934    4e-05 ***
household_income -0.17843    0.41833  -0.427    0.673    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1096 on 26 degrees of freedom
Multiple R-squared:  0.5556,    Adjusted R-squared:  0.5214 
F-statistic: 16.25 on 2 and 26 DF,  p-value: 2.637e-05</code></pre>
</div>
</div>
<p>It seems that the household income did not play any important role. Therefore, We can consider to remove it.</p>
</section>
<section id="manual-fit-again-without-insignificant-variable" class="level2">
<h2 class="anchored" data-anchor-id="manual-fit-again-without-insignificant-variable">Manual Fit Again Without Insignificant Variable</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>fit.reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>( saving_rate <span class="sc">~</span>  household_saving, <span class="at">data=</span>lg.dd.ts2)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.reg2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = saving_rate ~ household_saving, data = lg.dd.ts2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.20039 -0.07323 -0.01942  0.07709  0.22147 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        3.3183     0.2097  15.828 3.48e-15 ***
household_saving  -0.1882     0.0326  -5.774 3.85e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1079 on 27 degrees of freedom
Multiple R-squared:  0.5525,    Adjusted R-squared:  0.5359 
F-statistic: 33.33 on 1 and 27 DF,  p-value: 3.85e-06</code></pre>
</div>
</div>
<p>We can see that the variables are pretty significant.</p>
</section>
<section id="check-residuals" class="level2">
<h2 class="anchored" data-anchor-id="check-residuals">Check residuals</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(0,0,0) errors
Q* = 5.2247, df = 6, p-value = 0.5153

Model df: 0.   Total lags used: 6</code></pre>
</div>
</div>
<p>Based on the output, there’s no indication that seasonal terms are being used and the datasets did not have too much seasonal pattern. Therefore, this is an ARIMAX model.</p>
</section>
<section id="acf-and-pacf-check" class="level2">
<h2 class="anchored" data-anchor-id="acf-and-pacf-check">ACF and PACF Check</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">########### Converting to Time Series component #######</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>res.fit2<span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">residuals</span>(fit.reg2),<span class="at">frequency =</span> <span class="dv">2</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="do">############## Then look at the residuals ############</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(res.fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggPacf</span>(res.fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Since there is no major seasonal pattern. And it seems that the data is already stationary</p>
</section>
<section id="no-need-for-seasonal-differencing" class="level2">
<h2 class="anchored" data-anchor-id="no-need-for-seasonal-differencing">No Need For Seasonal Differencing</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the ACF and PACF plots without the theme</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>acf_plot <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(res.fit2) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ACF for data"</span>) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>pacf_plot <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(res.fit2) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"PACF for data"</span>) <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(acf_plot, pacf_plot, <span class="at">ncol =</span> <span class="dv">1</span>)             </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now, it is mostly stationary for us to continue From ACF and PACF, it seems that we can consider: p = 1,2 q = 1,2. We use first order of differencing so d = 0. There is no major seasonal pattern, therefore, no P,Q,D in this case.</p>
</section>
<section id="model-diagnotistics-1" class="level2">
<h2 class="anchored" data-anchor-id="model-diagnotistics-1">Model Diagnotistics</h2>
<p>Finding the model parameters.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">23</span>),<span class="at">nrow=</span><span class="dv">23</span>) <span class="co"># roughly nrow = 3x4x2</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>)<span class="co"># p=1,2,3 : 3</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>)<span class="co"># q=1,2,3,4 :4</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)<span class="co"># d=1,2 :2</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(res.fit2,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>) </span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-35.62908</td>
<td style="text-align: right;">-27.635848</td>
<td style="text-align: right;">-31.629075</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-30.44483</td>
<td style="text-align: right;">-23.965644</td>
<td style="text-align: right;">-27.587686</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-14.32464</td>
<td style="text-align: right;">-8.034157</td>
<td style="text-align: right;">-11.324640</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-34.33747</td>
<td style="text-align: right;">-25.012041</td>
<td style="text-align: right;">-28.737473</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-27.95423</td>
<td style="text-align: right;">-20.179204</td>
<td style="text-align: right;">-23.754225</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-11.59444</td>
<td style="text-align: right;">-4.045857</td>
<td style="text-align: right;">-7.173384</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-32.35833</td>
<td style="text-align: right;">-21.700692</td>
<td style="text-align: right;">-24.779380</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-27.40495</td>
<td style="text-align: right;">-18.334089</td>
<td style="text-align: right;">-21.510210</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-34.29408</td>
<td style="text-align: right;">-24.968649</td>
<td style="text-align: right;">-28.694081</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-29.01339</td>
<td style="text-align: right;">-21.238370</td>
<td style="text-align: right;">-24.813392</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-13.51554</td>
<td style="text-align: right;">-5.966961</td>
<td style="text-align: right;">-9.094488</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-32.86641</td>
<td style="text-align: right;">-22.208777</td>
<td style="text-align: right;">-25.287466</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-27.18329</td>
<td style="text-align: right;">-18.112427</td>
<td style="text-align: right;">-21.288549</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-33.13762</td>
<td style="text-align: right;">-21.147775</td>
<td style="text-align: right;">-23.137616</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-34.88942</td>
<td style="text-align: right;">-24.231784</td>
<td style="text-align: right;">-27.310473</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-27.67647</td>
<td style="text-align: right;">-18.605616</td>
<td style="text-align: right;">-21.781737</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-33.00327</td>
<td style="text-align: right;">-21.013431</td>
<td style="text-align: right;">-23.003272</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q       AIC       BIC      AICc
1 2 1 2 -35.62907 -27.63585 -31.62907</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q       AIC       BIC      AICc
1 2 1 2 -35.62907 -27.63585 -31.62907</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q       AIC       BIC      AICc
1 2 1 2 -35.62907 -27.63585 -31.62907</code></pre>
</div>
</div>
<p>From here, we have two potential ones: (2,1,2) and (0,0,0) from part 1</p>
</section>
<section id="compare-the-models-1" class="level2">
<h2 class="anchored" data-anchor-id="compare-the-models-1">Compare The Models</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">236</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>model_output21 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit2, <span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>model_output22 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit2, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-39-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output21[<span class="dv">145</span><span class="sc">:</span><span class="dv">160</span>], model_output21[<span class="fu">length</span>(model_output21)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$ttable
         Estimate     SE t.value p.value
ar1       -0.5752 0.3322 -1.7319  0.0967
ar2       -0.1902 0.2359 -0.8064  0.4283
ma1       -0.2555 0.2865 -0.8917  0.3818
ma2       -0.7445 0.2726 -2.7308  0.0119
constant  -0.0032 0.0022 -1.4586  0.1582

$AIC
[1] -1.272467

$AICc
[1] -1.175064

$BIC
[1] -0.9869946</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output22[<span class="dv">20</span><span class="sc">:</span><span class="dv">38</span>], model_output22[<span class="fu">length</span>(model_output22)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
sigma^2 estimated as 0.01084:  log likelihood = 24.46,  aic = -44.92

$degrees_of_freedom
[1] 28

$ttable
      Estimate     SE t.value p.value
xmean        0 0.0193       0       1

$AIC
[1] -1.548841

$AICc
[1] -1.543732

$BIC
[1] -1.454545</code></pre>
</div>
</div>
<p>Based on this, I think the first one (2,1,2) is slightly better with less correlation and closer to the significant level.</p>
</section>
<section id="cross-validation-1" class="level2">
<h2 class="anchored" data-anchor-id="cross-validation-1">Cross validation</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(res.fit2)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>n <span class="sc">*</span><span class="fl">0.3</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.7</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">9</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">40</span>,<span class="dv">2</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>rmse2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">40</span>,<span class="dv">2</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>rmse3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">40</span>,<span class="dv">2</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(res.fit1)[<span class="dv">1</span>]<span class="sc">+</span>(k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">4</span> </span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(res.fit2, <span class="at">end=</span>st <span class="sc">+</span> i<span class="dv">-1</span>)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(res.fit2, <span class="at">start=</span>st <span class="sc">+</span> (i<span class="dv">-1</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">end=</span>st <span class="sc">+</span> i)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">include.drift=</span><span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">"ML"</span>)</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>  rmse1[i,<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(xtest)]  <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>  rmse2[i,<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(xtest)] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>mean<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="fu">colMeans</span>(rmse1,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"horizon"</span>, <span class="at">ylab=</span><span class="st">"RMSE"</span>)</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="fu">colMeans</span>(rmse2,<span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"fit1"</span>,<span class="st">"fit2"</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here, although</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>( rmse1,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09762763 0.10927137</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>( rmse2,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09827109 0.07812204</code></pre>
</div>
</div>
<p>Based on the cross validation, overall, the two method is simiarly within expectation. We can see that although model (0,0,0) has smaller errors after, the dataset is relatively biased due to the size of the date overlapping. We should still use the fit1 which is (2,1,2) to perform later analysis.</p>
</section>
<section id="fit-the-model-with-the-best-one" class="level2">
<h2 class="anchored" data-anchor-id="fit-the-model-with-the-best-one">Fit the model With The Best One</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>xreg2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">household_income =</span> lg.dd.ts2[, <span class="st">"household_income"</span>],</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">household_saving =</span> lg.dd.ts2[, <span class="st">"household_saving"</span>])</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(lg.dd.ts2[, <span class="st">"saving_rate"</span>],<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">xreg=</span>xreg2)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lg.dd.ts2[, "saving_rate"] 
Regression with ARIMA(2,1,2) errors 

Coefficients:
         ar1      ar2      ma1     ma2  household_income  household_saving
      0.4885  -0.4602  -1.2187  0.5136            0.1188           -0.1330
s.e.  0.3344   0.2419   0.3265  0.3180            0.3668            0.0648

sigma^2 = 0.0124:  log likelihood = 24.41
AIC=-34.81   AICc=-29.21   BIC=-25.48

Training set error measures:
                      ME      RMSE        MAE        MPE     MAPE      MASE
Training set -0.01566954 0.0969955 0.06932111 -0.8864638 3.345804 0.5924788
                    ACF1
Training set -0.07898355</code></pre>
</div>
</div>
</section>
<section id="write-doen-the-equation" class="level2">
<h2 class="anchored" data-anchor-id="write-doen-the-equation">Write Doen The equation:</h2>
<p>Given that <code>y_t</code> represents the log-transformed <code>homevalue</code> at time <code>t</code>, the ARIMA(2,1,4) can be:</p>
<p>(1 - φ₁B - φ₂B²)(1 - B)yₜ = α + β₁ * salepriceₜ + β₂ * rentalpriceₜ + (1 + θ₁B + θ₂B² + θ₃B³ + θ₄B⁴)εₜ</p>
<p>Based on the summary, my equation for this model is</p>
<p>(1 - 0.4885B - (-0.4602)B^2)(1 - B)y_t = + 0.1188 _t - 0.1330 _t + (1 - 1.2187B + 0.5136B^2)_t</p>
</section>
<section id="forecasting-1" class="level2">
<h2 class="anchored" data-anchor-id="forecasting-1">Forecasting</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>hsfit<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(lg.dd.ts2[, <span class="st">"household_saving"</span>]) </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hsfit) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lg.dd.ts2[, "household_saving"] 
ARIMA(0,1,0) with drift 

Coefficients:
       drift
      0.0701
s.e.  0.0447

sigma^2 = 0.05808:  log likelihood = 0.62
AIC=2.76   AICc=3.24   BIC=5.42

Training set error measures:
                       ME      RMSE       MAE        MPE     MAPE      MASE
Training set 0.0002068136 0.2325379 0.1666254 -0.1667371 2.642544 0.4511904
                    ACF1
Training set -0.04495977</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>fhs<span class="ot">&lt;-</span><span class="fu">forecast</span>(hsfit,<span class="dv">12</span>) <span class="co">#obtaining forecasts</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>hifit<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(lg.dd.ts2[, <span class="st">"household_income"</span>]) <span class="co">#fitting an ARIMA model to the Import variable</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rpfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lg.dd.ts1[, "rentalprice"] 
ARIMA(0,1,1) 

Coefficients:
          ma1
      -0.1423
s.e.   0.0308

sigma^2 = 0.006889:  log likelihood = 1155.01
AIC=-2306.01   AICc=-2306   BIC=-2296.05

Training set error measures:
                     ME       RMSE        MAE         MPE      MAPE      MASE
Training set 0.00063182 0.08292248 0.02052085 0.001505318 0.2698055 0.3434587
                    ACF1
Training set 0.001944753</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>fhi<span class="ot">&lt;-</span><span class="fu">forecast</span>(hifit,<span class="dv">12</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>fxreg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">household_income =</span> fhi<span class="sc">$</span>mean,<span class="at">household_saving =</span> fhs<span class="sc">$</span>mean</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>              ) <span class="co">#fimp$mean gives the forecasted values</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">xreg=</span>fxreg,<span class="dv">12</span>) </span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast, <span class="at">main=</span><span class="st">"Forecast of Saving Rate"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Saving Rate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on the forecast, we can see that the model did capture the seasonal patterns where it predict the fluctuations and downfall of the data in the future.</p>
</section>
</section>
<section id="var-sale-price-saving-rate-gdp-deflator" class="level1">
<h1>3. (VAR) Sale Price &amp; Saving Rate &amp; Gdp Deflator</h1>
<section id="transform-all-to-time-series" class="level2">
<h2 class="anchored" data-anchor-id="transform-all-to-time-series">Transform all to time series</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>saving <span class="ot">=</span><span class="fu">ts</span>(df1<span class="sc">$</span>W398RC1A027NBEA)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>income <span class="ot">=</span><span class="fu">ts</span>(df2<span class="sc">$</span>MEHOINUSA672N)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>sale <span class="ot">=</span> <span class="fu">ts</span>(df3<span class="sc">$</span>MSPUS)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>gini <span class="ot">=</span><span class="fu">ts</span>(df4<span class="sc">$</span>SIPOVGINIUSA)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>afford <span class="ot">=</span><span class="fu">ts</span>(df5<span class="sc">$</span>FIXHAI)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>saverate <span class="ot">=</span><span class="fu">ts</span>(df6<span class="sc">$</span>PSAVERT)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>gdp <span class="ot">=</span><span class="fu">ts</span>(df7<span class="sc">$</span>A191RI1Q225SBEA)</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>saleprice <span class="ot">=</span><span class="fu">ts</span>(df8<span class="sc">$</span>Mean.Sale.Price)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>homevalue <span class="ot">=</span><span class="fu">ts</span>(df8<span class="sc">$</span>Mean.Home.Value)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>rentalprice <span class="ot">=</span><span class="fu">ts</span>(df8<span class="sc">$</span>mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="prepare-variables-saving-rate-sale-price-gdp-deflator" class="level2">
<h2 class="anchored" data-anchor-id="prepare-variables-saving-rate-sale-price-gdp-deflator">Prepare Variables: saving rate, sale price, gdp deflator</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define start and end dates</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"1965-01-01"</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-12-31"</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data frames to include only data from 1992 through 2020</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>df3_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(df3, DATE <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end_date)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>df6_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(df6, DATE <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end_date)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>df7_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(df7, DATE <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end_date)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming the data is annual for this example. If it's quarterly, you'd use frequency = 4; if monthly, frequency = 12.</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>frequency <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ts objects</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>sale_price <span class="ot">&lt;-</span> <span class="fu">ts</span>(df3_sub<span class="sc">$</span>MSPUS, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1965</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>saving_rate <span class="ot">&lt;-</span> <span class="fu">ts</span>(df6_sub<span class="sc">$</span>PSAVERT, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1965</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>gdp <span class="ot">&lt;-</span> <span class="fu">ts</span>(df7_sub<span class="sc">$</span>A191RI1Q225SBEA, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1965</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>DATE <span class="ot">&lt;-</span> <span class="fu">ts</span>(df7_sub<span class="sc">$</span>DATE, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1965</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combine-variables" class="level2">
<h2 class="anchored" data-anchor-id="combine-variables">Combine Variables</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>dd3<span class="ot">&lt;-</span><span class="fu">data.frame</span>(sale_price,saving_rate,gdp,DATE)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dd3)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"sale_price"</span>,<span class="st">"saving_rate"</span>,<span class="st">"gdp_deflator"</span>,<span class="st">'date'</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dd3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">sale_price</th>
<th style="text-align: right;">saving_rate</th>
<th style="text-align: right;">gdp_deflator</th>
<th style="text-align: right;">date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">20200</td>
<td style="text-align: right;">12.1</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">-1826</td>
</tr>
<tr class="even">
<td style="text-align: right;">19800</td>
<td style="text-align: right;">10.7</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">-1736</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20200</td>
<td style="text-align: right;">10.8</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">-1645</td>
</tr>
<tr class="even">
<td style="text-align: right;">20300</td>
<td style="text-align: right;">10.2</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">-1553</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21000</td>
<td style="text-align: right;">11.2</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">-1461</td>
</tr>
<tr class="even">
<td style="text-align: right;">22100</td>
<td style="text-align: right;">12.1</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">-1371</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="plot-the-variables-together" class="level2">
<h2 class="anchored" data-anchor-id="plot-the-variables-together">Plot the Variables Together</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>lg.dd3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"date"</span> <span class="ot">=</span>dd3<span class="sc">$</span>date,<span class="st">"sale_price"</span><span class="ot">=</span><span class="fu">log</span>(dd3<span class="sc">$</span>sale_price),<span class="st">"saving_rate"</span><span class="ot">=</span><span class="fu">log</span>(dd3<span class="sc">$</span>saving_rate),</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"gdp_deflator"</span><span class="ot">=</span><span class="fu">log</span>(dd3<span class="sc">$</span>gdp_deflator))</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="do">#### converting to time series component #########</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>lg.dd.ts3<span class="ot">&lt;-</span><span class="fu">ts</span>(lg.dd3,<span class="at">frequency =</span> <span class="dv">5</span>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="do">##### Facet Plot #######################</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(lg.dd.ts3[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"The GDP Deflator, Sale Price, Saving Rate in USA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="finding-out-the-best-p" class="level2">
<h2 class="anchored" data-anchor-id="finding-out-the-best-p">Finding out the best p:</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VARselect</span>(dd3[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">lag.max=</span><span class="dv">10</span>, <span class="at">type=</span><span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$selection
AIC(n)  HQ(n)  SC(n) FPE(n) 
     3      1      1      3 

$criteria
                  1            2            3            4            5
AIC(n) 1.398087e+01 1.398082e+01 1.391871e+01 1.393094e+01 1.395240e+01
HQ(n)  1.406205e+01 1.411071e+01 1.409731e+01 1.415825e+01 1.422842e+01
SC(n)  1.418295e+01 1.430414e+01 1.436328e+01 1.449676e+01 1.463946e+01
FPE(n) 1.179834e+06 1.179822e+06 1.108866e+06 1.122687e+06 1.147305e+06
                  6            7            8            9           10
AIC(n) 1.398304e+01 1.403364e+01 1.406570e+01 1.408240e+01 1.412592e+01
HQ(n)  1.430777e+01 1.440708e+01 1.448785e+01 1.455325e+01 1.464549e+01
SC(n)  1.479134e+01 1.496320e+01 1.511650e+01 1.525444e+01 1.541922e+01
FPE(n) 1.183385e+06 1.245368e+06 1.286686e+06 1.309306e+06 1.368790e+06</code></pre>
</div>
</div>
<p>From the results, we can see that 3,4 have relatively smaller criterias: We can fit several models with p=1, 3, and 4.=&gt; VAR(1), VAR(3), VAR(4)</p>
</section>
<section id="fitting-a-var-model-with-different-p" class="level2">
<h2 class="anchored" data-anchor-id="fitting-a-var-model-with-different-p">Fitting a VAR model with different p:</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(dd3[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">p=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: saving_rate, gdp_deflator, date 
Deterministic variables: both 
Sample size: 275 
Log Likelihood: -3075.874 
Roots of the characteristic polynomial:
0.9816 0.8407 0.7771
Call:
vars::VAR(y = dd3[, c(2:4)], p = 1, type = "both")


Estimation results for equation saving_rate: 
============================================ 
saving_rate = saving_rate.l1 + gdp_deflator.l1 + date.l1 + const + trend 

                  Estimate Std. Error t value Pr(&gt;|t|)    
saving_rate.l1   8.296e-01  3.447e-02  24.070  &lt; 2e-16 ***
gdp_deflator.l1 -1.619e-02  2.129e-02  -0.761  0.44760    
date.l1          9.867e-06  9.057e-06   1.089  0.27692    
const            2.241e+00  4.772e-01   4.696 4.23e-06 ***
trend           -2.320e-03  7.247e-04  -3.202  0.00153 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.7166 on 270 degrees of freedom
Multiple R-Squared: 0.8099, Adjusted R-squared: 0.807 
F-statistic: 287.5 on 4 and 270 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation gdp_deflator: 
============================================= 
gdp_deflator = saving_rate.l1 + gdp_deflator.l1 + date.l1 + const + trend 

                  Estimate Std. Error t value Pr(&gt;|t|)    
saving_rate.l1  -8.763e-02  5.740e-02  -1.527  0.12803    
gdp_deflator.l1  8.022e-01  3.545e-02  22.625  &lt; 2e-16 ***
date.l1         -4.714e-05  1.508e-05  -3.126  0.00197 ** 
const            2.191e+00  7.946e-01   2.757  0.00623 ** 
trend           -7.055e-04  1.207e-03  -0.585  0.55934    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.193 on 270 degrees of freedom
Multiple R-Squared: 0.7827, Adjusted R-squared: 0.7795 
F-statistic: 243.1 on 4 and 270 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation date: 
===================================== 
date = saving_rate.l1 + gdp_deflator.l1 + date.l1 + const + trend 

                  Estimate Std. Error t value Pr(&gt;|t|)    
saving_rate.l1    90.19249   59.02459   1.528    0.128    
gdp_deflator.l1  -16.61672   36.45826  -0.456    0.649    
date.l1            0.96759    0.01551  62.390   &lt;2e-16 ***
const           -811.20104  817.15553  -0.993    0.322    
trend              0.63544    1.24101   0.512    0.609    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1227 on 270 degrees of freedom
Multiple R-Squared: 0.961,  Adjusted R-squared: 0.9605 
F-statistic:  1665 on 4 and 270 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
             saving_rate gdp_deflator       date
saving_rate     0.513560    -0.007928 -8.194e+00
gdp_deflator   -0.007928     1.424116  3.316e+01
date           -8.193763    33.159659  1.506e+06

Correlation matrix of residuals:
             saving_rate gdp_deflator      date
saving_rate     1.000000    -0.009271 -0.009317
gdp_deflator   -0.009271     1.000000  0.022643
date           -0.009317     0.022643  1.000000</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(dd3[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">p=</span><span class="dv">3</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: saving_rate, gdp_deflator, date 
Deterministic variables: both 
Sample size: 273 
Log Likelihood: -3025.413 
Roots of the characteristic polynomial:
0.9806 0.9118 0.8704 0.4113 0.4113 0.3397 0.3397 0.2947 0.2947
Call:
vars::VAR(y = dd3[, c(2:4)], p = 3, type = "both")


Estimation results for equation saving_rate: 
============================================ 
saving_rate = saving_rate.l1 + gdp_deflator.l1 + date.l1 + saving_rate.l2 + gdp_deflator.l2 + date.l2 + saving_rate.l3 + gdp_deflator.l3 + date.l3 + const + trend 

                  Estimate Std. Error t value Pr(&gt;|t|)    
saving_rate.l1   6.770e-01  6.060e-02  11.172  &lt; 2e-16 ***
gdp_deflator.l1 -1.671e-02  3.692e-02  -0.452 0.651324    
date.l1         -4.871e-06  3.464e-05  -0.141 0.888274    
saving_rate.l2   9.846e-02  7.264e-02   1.356 0.176419    
gdp_deflator.l2  8.798e-02  4.378e-02   2.010 0.045496 *  
date.l2         -2.431e-05  4.825e-05  -0.504 0.614747    
saving_rate.l3   9.630e-02  6.066e-02   1.588 0.113581    
gdp_deflator.l3 -9.371e-02  3.629e-02  -2.582 0.010364 *  
date.l3          3.352e-05  3.475e-05   0.965 0.335646    
const            1.786e+00  5.123e-01   3.487 0.000573 ***
trend           -2.034e-03  7.360e-04  -2.763 0.006128 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.6969 on 262 degrees of freedom
Multiple R-Squared: 0.8253, Adjusted R-squared: 0.8187 
F-statistic: 123.8 on 10 and 262 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation gdp_deflator: 
============================================= 
gdp_deflator = saving_rate.l1 + gdp_deflator.l1 + date.l1 + saving_rate.l2 + gdp_deflator.l2 + date.l2 + saving_rate.l3 + gdp_deflator.l3 + date.l3 + const + trend 

                  Estimate Std. Error t value Pr(&gt;|t|)    
saving_rate.l1  -2.610e-03  1.015e-01  -0.026  0.97949    
gdp_deflator.l1  6.218e-01  6.182e-02  10.059  &lt; 2e-16 ***
date.l1          2.358e-05  5.799e-05   0.407  0.68463    
saving_rate.l2  -1.154e-01  1.216e-01  -0.949  0.34333    
gdp_deflator.l2  4.379e-02  7.330e-02   0.597  0.55073    
date.l2         -7.619e-06  8.078e-05  -0.094  0.92493    
saving_rate.l3   6.686e-03  1.016e-01   0.066  0.94756    
gdp_deflator.l3  1.687e-01  6.076e-02   2.776  0.00591 ** 
date.l3         -5.886e-05  5.817e-05  -1.012  0.31256    
const            2.347e+00  8.578e-01   2.736  0.00663 ** 
trend           -8.907e-04  1.232e-03  -0.723  0.47040    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.167 on 262 degrees of freedom
Multiple R-Squared: 0.7974, Adjusted R-squared: 0.7897 
F-statistic: 103.1 on 10 and 262 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation date: 
===================================== 
date = saving_rate.l1 + gdp_deflator.l1 + date.l1 + saving_rate.l2 + gdp_deflator.l2 + date.l2 + saving_rate.l3 + gdp_deflator.l3 + date.l3 + const + trend 

                  Estimate Std. Error t value Pr(&gt;|t|)    
saving_rate.l1   5.357e+01  1.048e+02   0.511  0.60968    
gdp_deflator.l1 -7.718e+00  6.386e+01  -0.121  0.90389    
date.l1          9.861e-01  5.990e-02  16.464  &lt; 2e-16 ***
saving_rate.l2  -5.835e+01  1.256e+02  -0.464  0.64269    
gdp_deflator.l2 -2.332e+02  7.571e+01  -3.080  0.00229 ** 
date.l2         -7.233e-03  8.344e-02  -0.087  0.93099    
saving_rate.l3   1.095e+02  1.049e+02   1.044  0.29752    
gdp_deflator.l3  2.502e+02  6.276e+01   3.987 8.69e-05 ***
date.l3         -8.317e-03  6.009e-02  -0.138  0.89003    
const           -1.124e+03  8.860e+02  -1.269  0.20574    
trend            8.568e-01  1.273e+00   0.673  0.50141    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1205 on 262 degrees of freedom
Multiple R-Squared: 0.963,  Adjusted R-squared: 0.9616 
F-statistic: 681.9 on 10 and 262 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
             saving_rate gdp_deflator       date
saving_rate      0.48565      0.01418      20.31
gdp_deflator     0.01418      1.36133     -14.92
date            20.30792    -14.91718 1452449.04

Correlation matrix of residuals:
             saving_rate gdp_deflator     date
saving_rate      1.00000      0.01744  0.02418
gdp_deflator     0.01744      1.00000 -0.01061
date             0.02418     -0.01061  1.00000</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(dd3[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">p=</span><span class="dv">4</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: saving_rate, gdp_deflator, date 
Deterministic variables: both 
Sample size: 272 
Log Likelihood: -3007.166 
Roots of the characteristic polynomial:
0.9868 0.9304 0.8686 0.5835 0.5835 0.5395 0.4834 0.4834 0.416 0.416 0.1904 0.1904
Call:
vars::VAR(y = dd3[, c(2:4)], p = 4, type = "both")


Estimation results for equation saving_rate: 
============================================ 
saving_rate = saving_rate.l1 + gdp_deflator.l1 + date.l1 + saving_rate.l2 + gdp_deflator.l2 + date.l2 + saving_rate.l3 + gdp_deflator.l3 + date.l3 + saving_rate.l4 + gdp_deflator.l4 + date.l4 + const + trend 

                  Estimate Std. Error t value Pr(&gt;|t|)    
saving_rate.l1   6.421e-01  6.088e-02  10.546  &lt; 2e-16 ***
gdp_deflator.l1 -1.304e-02  3.695e-02  -0.353  0.72434    
date.l1          1.551e-06  3.519e-05   0.044  0.96487    
saving_rate.l2   8.610e-02  7.251e-02   1.187  0.23615    
gdp_deflator.l2  9.791e-02  4.326e-02   2.263  0.02444 *  
date.l2         -3.474e-05  4.867e-05  -0.714  0.47604    
saving_rate.l3  -4.977e-03  7.196e-02  -0.069  0.94491    
gdp_deflator.l3 -5.673e-02  4.425e-02  -1.282  0.20102    
date.l3          2.894e-05  4.753e-05   0.609  0.54317    
saving_rate.l4   1.658e-01  6.035e-02   2.747  0.00645 ** 
gdp_deflator.l4 -5.754e-02  3.783e-02  -1.521  0.12943    
date.l4          5.146e-06  3.435e-05   0.150  0.88102    
const            1.631e+00  5.249e-01   3.108  0.00210 ** 
trend           -1.970e-03  7.385e-04  -2.668  0.00811 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.6861 on 258 degrees of freedom
Multiple R-Squared: 0.833,  Adjusted R-squared: 0.8245 
F-statistic: 98.96 on 13 and 258 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation gdp_deflator: 
============================================= 
gdp_deflator = saving_rate.l1 + gdp_deflator.l1 + date.l1 + saving_rate.l2 + gdp_deflator.l2 + date.l2 + saving_rate.l3 + gdp_deflator.l3 + date.l3 + saving_rate.l4 + gdp_deflator.l4 + date.l4 + const + trend 

                  Estimate Std. Error t value Pr(&gt;|t|)    
saving_rate.l1   1.883e-02  1.041e-01   0.181  0.85656    
gdp_deflator.l1  6.149e-01  6.315e-02   9.738  &lt; 2e-16 ***
date.l1          1.349e-05  6.014e-05   0.224  0.82265    
saving_rate.l2  -1.195e-01  1.239e-01  -0.964  0.33594    
gdp_deflator.l2  3.769e-02  7.393e-02   0.510  0.61066    
date.l2          5.842e-06  8.318e-05   0.070  0.94406    
saving_rate.l3   5.427e-02  1.230e-01   0.441  0.65940    
gdp_deflator.l3  1.298e-01  7.563e-02   1.716  0.08737 .  
date.l3         -6.911e-05  8.124e-05  -0.851  0.39568    
saving_rate.l4  -7.248e-02  1.031e-01  -0.703  0.48287    
gdp_deflator.l4  5.796e-02  6.465e-02   0.896  0.37084    
date.l4          8.775e-06  5.870e-05   0.149  0.88128    
const            2.407e+00  8.971e-01   2.683  0.00776 ** 
trend           -9.482e-04  1.262e-03  -0.751  0.45319    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.173 on 258 degrees of freedom
Multiple R-Squared: 0.7984, Adjusted R-squared: 0.7882 
F-statistic: 78.58 on 13 and 258 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation date: 
===================================== 
date = saving_rate.l1 + gdp_deflator.l1 + date.l1 + saving_rate.l2 + gdp_deflator.l2 + date.l2 + saving_rate.l3 + gdp_deflator.l3 + date.l3 + saving_rate.l4 + gdp_deflator.l4 + date.l4 + const + trend 

                  Estimate Std. Error t value Pr(&gt;|t|)    
saving_rate.l1   3.404e+01  1.071e+02   0.318  0.75097    
gdp_deflator.l1  8.281e+00  6.502e+01   0.127  0.89876    
date.l1          1.012e+00  6.192e-02  16.340  &lt; 2e-16 ***
saving_rate.l2  -3.016e+01  1.276e+02  -0.236  0.81334    
gdp_deflator.l2 -2.322e+02  7.613e+01  -3.050  0.00253 ** 
date.l2         -3.837e-02  8.566e-02  -0.448  0.65459    
saving_rate.l3   1.588e+02  1.266e+02   1.254  0.21100    
gdp_deflator.l3  3.224e+02  7.788e+01   4.140  4.7e-05 ***
date.l3          2.568e-03  8.365e-02   0.031  0.97553    
saving_rate.l4  -7.421e+01  1.062e+02  -0.699  0.48533    
gdp_deflator.l4 -1.040e+02  6.657e+01  -1.562  0.11947    
date.l4         -6.418e-03  6.044e-02  -0.106  0.91552    
const           -8.460e+02  9.237e+02  -0.916  0.36063    
trend            6.347e-01  1.300e+00   0.488  0.62569    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1208 on 258 degrees of freedom
Multiple R-Squared: 0.9632, Adjusted R-squared: 0.9613 
F-statistic: 518.9 on 13 and 258 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
             saving_rate gdp_deflator       date
saving_rate      0.47080      0.02528  1.839e+01
gdp_deflator     0.02528      1.37521 -9.918e+00
date            18.38808     -9.91797  1.458e+06

Correlation matrix of residuals:
             saving_rate gdp_deflator      date
saving_rate      1.00000     0.031413  0.022193
gdp_deflator     0.03141     1.000000 -0.007004
date             0.02219    -0.007004  1.000000</code></pre>
</div>
</div>
<p>We can see that some models have some variables significant but not all. We will keep the variables and make comparison in the next steps to get the better one.</p>
</section>
<section id="cross-validations" class="level2">
<h2 class="anchored" data-anchor-id="cross-validations">Cross Validations</h2>
<section id="define-length" class="level3">
<h3 class="anchored" data-anchor-id="define-length">Define length</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(dd3<span class="sc">$</span>gdp_deflator)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">85</span> <span class="co">#19*4</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>n<span class="sc">*</span><span class="fl">0.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 82.8</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">ts</span>(dd3[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="cross-validation-for-gdp-deflator" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-for-gdp-deflator">Cross Validation For gdp deflator</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>err1 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>err2 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k))</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> dat[,<span class="fu">c</span>(<span class="dv">3</span>)][<span class="dv">1</span><span class="sc">:</span>(k<span class="dv">-1</span>)<span class="sc">+</span>i] </span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> dat[,<span class="fu">c</span>(<span class="dv">3</span>)][k<span class="sc">+</span>i] </span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat, <span class="at">p=</span><span class="dv">3</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">=</span> <span class="fu">predict</span>(fit, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat, <span class="at">p=</span><span class="dv">4</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">=</span> <span class="fu">predict</span>(fit2, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#capture error for each iteration</span></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This is RMSE</span></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>  err1 <span class="ot">=</span> <span class="fu">c</span>(err1, <span class="fu">sqrt</span>((fcast1<span class="sc">$</span>fcst<span class="sc">$</span>gdp_deflator<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>  err2 <span class="ot">=</span> <span class="fu">c</span>(err2, <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>fcst<span class="sc">$</span>gdp_deflator<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="normalize-the-rmse-for-ploting" class="level4">
<h4 class="anchored" data-anchor-id="normalize-the-rmse-for-ploting">Normalize the RMSE For Ploting</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize function</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>normalize <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)))</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize e1 and e2</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>normalized_e1 <span class="ot">&lt;-</span> <span class="fu">normalize</span>(err1)</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>normalized_e2 <span class="ot">&lt;-</span> <span class="fu">normalize</span>(err2)</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the background color of the plot region to #E0E0E0</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the normalized e1 with a red line</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(normalized_e1<span class="sc">+</span> e, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">ylim=</span><span class="fu">range</span>(<span class="fu">c</span>(normalized_e1, normalized_e2 <span class="sc">+</span> e)), <span class="at">xlab=</span><span class="st">"Index"</span>, <span class="at">ylab=</span><span class="st">"Normalized Values"</span>, <span class="at">main=</span><span class="st">"Normalized RMSE Plot of e1 and e2 For GDP Deflator"</span>)</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the normalized e2 with an offset and a blue line</span></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(normalized_e2 , <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend to distinguish the lines</span></span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"e1"</span>, <span class="st">"e2"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="compare-the-errors" class="level4">
<h4 class="anchored" data-anchor-id="compare-the-errors">Compare the errors</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(err1)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> error1[<span class="sc">!</span><span class="fu">is.na</span>(error1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.nan</span>(error1)]</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(error1)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(err2)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> error2[<span class="sc">!</span><span class="fu">is.na</span>(error2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.nan</span>(error2)]</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(error2)</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>error1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.802198</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>error2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.871752</code></pre>
</div>
</div>
<p>The first one is better but not too different for GDP Deflator</p>
</section>
</section>
<section id="cross-validation-for-saving-rate" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-for-saving-rate">Cross Validation For Saving rate</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>err1 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>err2 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k))</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> dat[,<span class="fu">c</span>(<span class="dv">2</span>)][<span class="dv">1</span><span class="sc">:</span>(k<span class="dv">-1</span>)<span class="sc">+</span>i] </span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> dat[,<span class="fu">c</span>(<span class="dv">2</span>)][k<span class="sc">+</span>i] </span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat, <span class="at">p=</span><span class="dv">3</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">=</span> <span class="fu">predict</span>(fit, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat, <span class="at">p=</span><span class="dv">4</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">=</span> <span class="fu">predict</span>(fit2, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#capture error for each iteration</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This is RMSE</span></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>  err1 <span class="ot">=</span> <span class="fu">c</span>(err1, <span class="fu">sqrt</span>((fcast1<span class="sc">$</span>fcst<span class="sc">$</span>saving_rate<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>  err2 <span class="ot">=</span> <span class="fu">c</span>(err2, <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>fcst<span class="sc">$</span>saving_rate<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="normalize-the-errors-for-ploting" class="level4">
<h4 class="anchored" data-anchor-id="normalize-the-errors-for-ploting">Normalize the errors for ploting</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize function</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>normalize <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)))</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize e1 and e2</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>normalized_e1 <span class="ot">&lt;-</span> <span class="fu">normalize</span>(err1)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>normalized_e2 <span class="ot">&lt;-</span> <span class="fu">normalize</span>(err2)</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the background color of the plot region to #E0E0E0</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the normalized e1 with a red line</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(normalized_e1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">ylim=</span><span class="fu">range</span>(<span class="fu">c</span>(normalized_e1, normalized_e2 <span class="sc">+</span> e)), <span class="at">xlab=</span><span class="st">"Index"</span>, <span class="at">ylab=</span><span class="st">"Normalized Values"</span>, <span class="at">main=</span><span class="st">"Normalized RMSE Plot of e1 and e2 For Saving Rate"</span>)</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the normalized e2 with an offset and a blue line</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(normalized_e2 <span class="sc">+</span> e, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend to distinguish the lines</span></span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"e1"</span>, <span class="st">"e2"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="compare-errors" class="level4">
<h4 class="anchored" data-anchor-id="compare-errors">Compare errors</h4>
<p>Let us reorganize the errors</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(err1)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> error1[<span class="sc">!</span><span class="fu">is.na</span>(error1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.nan</span>(error1)]</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(error1)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(err2)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> error2[<span class="sc">!</span><span class="fu">is.na</span>(error2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.nan</span>(error2)]</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(error2)</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>error1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.48152</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>error2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.607221</code></pre>
</div>
</div>
<p>The first one is also better for saving rate</p>
</section>
</section>
<section id="cross-validation-for-sale-price" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-for-sale-price">Cross Validation For Sale price</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>err1 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>err2 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k))</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> dat[,<span class="fu">c</span>(<span class="dv">1</span>)][<span class="dv">1</span><span class="sc">:</span>(k<span class="dv">-1</span>)<span class="sc">+</span>i] </span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> dat[,<span class="fu">c</span>(<span class="dv">1</span>)][k<span class="sc">+</span>i] </span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat, <span class="at">p=</span><span class="dv">3</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">=</span> <span class="fu">predict</span>(fit, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat, <span class="at">p=</span><span class="dv">4</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">=</span> <span class="fu">predict</span>(fit2, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#capture error for each iteration</span></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This is RMSE</span></span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>  err1 <span class="ot">=</span> <span class="fu">c</span>(err1, <span class="fu">sqrt</span>((fcast1<span class="sc">$</span>fcst<span class="sc">$</span>sale_price<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>  err2 <span class="ot">=</span> <span class="fu">c</span>(err2, <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>fcst<span class="sc">$</span>sale_price<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="normalize-the-errors" class="level4">
<h4 class="anchored" data-anchor-id="normalize-the-errors">Normalize The Errors</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize function</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>normalize <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)))</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize e1 and e2</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>normalized_e1 <span class="ot">&lt;-</span> <span class="fu">normalize</span>(err1)</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>normalized_e2 <span class="ot">&lt;-</span> <span class="fu">normalize</span>(err2)</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fl">0.03</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the background color of the plot region to #E0E0E0</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the normalized e1 with a red line</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(normalized_e1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">ylim=</span><span class="fu">range</span>(<span class="fu">c</span>(normalized_e1, normalized_e2 <span class="sc">+</span> e)), <span class="at">xlab=</span><span class="st">"Index"</span>, <span class="at">ylab=</span><span class="st">"Normalized Values"</span>, <span class="at">main=</span><span class="st">"Normalized RMSE Plot of e1 and e2 For Sale Price"</span>)</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the normalized e2 with an offset and a blue line</span></span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(normalized_e2 <span class="sc">+</span> e, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend to distinguish the lines</span></span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"e1"</span>, <span class="st">"e2"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="compare-the-errors-1" class="level4">
<h4 class="anchored" data-anchor-id="compare-the-errors-1">Compare The Errors</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(err1)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> error1[<span class="sc">!</span><span class="fu">is.na</span>(error1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.nan</span>(error1)]</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(error1)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(err2)</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> error2[<span class="sc">!</span><span class="fu">is.na</span>(error2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.nan</span>(error2)]</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(error2)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>error1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 125445.5</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>error2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 125987.7</code></pre>
</div>
</div>
<p>Overall, we can see that in my case, all variables have smaller RMSE with VAR(3)</p>
</section>
</section>
</section>
<section id="forecasting-2" class="level2">
<h2 class="anchored" data-anchor-id="forecasting-2">Forecasting</h2>
<p>Forecast using the best one which is VAR(3)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">p=</span><span class="dv">3</span>, <span class="at">type=</span><span class="st">"const"</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>fcast1 <span class="ot">=</span> <span class="fu">predict</span>(fit1, <span class="at">n.ahead =</span> <span class="dv">8</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>fcast1<span class="sc">$</span>fcst<span class="sc">$</span>gdp_deflator</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         fcst    lower     upper       CI
[1,] 7.894615 5.607798 10.181432 2.286817
[2,] 7.282398 4.582903  9.981893 2.699495
[3,] 7.492970 4.611125 10.374815 2.881845
[4,] 7.372062 4.294439 10.449686 3.077623
[5,] 7.295611 4.073932 10.517289 3.221678
[6,] 7.253375 3.915601 10.591150 3.337774
[7,] 7.186365 3.748134 10.624597 3.438231
[8,] 7.131866 3.607845 10.655887 3.524021</code></pre>
</div>
</div>
<section id="check-corresponind-forecasting" class="level3">
<h3 class="anchored" data-anchor-id="check-corresponind-forecasting">Check Corresponind Forecasting</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>fcast1<span class="sc">$</span>fcst<span class="sc">$</span>sale_price</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         fcst     lower     upper       CI
[1,] 52039.84  11740.19  92339.49 40299.65
[2,] 34492.15 -20395.42  89379.73 54887.58
[3,] 38522.27 -27352.88 104397.41 65875.14
[4,] 39360.19 -35082.57 113802.95 74442.76
[5,] 37722.35 -44022.64 119467.33 81744.99
[6,] 37462.86 -50890.48 125816.19 88353.33
[7,] 36986.76 -57304.47 131277.99 94291.23
[8,] 36584.86 -63106.89 136276.61 99691.75</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>fcast1<span class="sc">$</span>fcst<span class="sc">$</span>saving_rate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         fcst    lower    upper       CI
[1,] 8.674407 7.292309 10.05651 1.382098
[2,] 9.136267 7.444615 10.82792 1.691652
[3,] 9.041880 7.142789 10.94097 1.899091
[4,] 9.091204 7.003047 11.17936 2.088156
[5,] 9.210690 6.970091 11.45129 2.240599
[6,] 9.265283 6.897064 11.63350 2.368219
[7,] 9.332344 6.853394 11.81129 2.478950
[8,] 9.401929 6.826736 11.97712 2.575193</code></pre>
</div>
</div>
</section>
</section>
<section id="forecast-results" class="level2">
<h2 class="anchored" data-anchor-id="forecast-results">Forecast Results</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">forecast</span>(fit1,<span class="dv">48</span>) <span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on the forecast, we can see that the model has help us forecast for each variable, for gdp deflator, and sale price, and saving rate, due to the model lacks of seasonal patterns, it did not capture the fluctuations very will. However, the forecast did capture the overall trends correctly.</p>
</section>
</section>
<section id="arimax-gini-index-household-income-household-saving-sale-price" class="level1">
<h1>4. (ARIMAX) GINI Index ~ Household Income + Household Saving + Sale Price</h1>
<section id="prepare-the-variables" class="level2">
<h2 class="anchored" data-anchor-id="prepare-the-variables">Prepare the Variables</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define start and end dates</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"1992-01-01"</span>)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-12-31"</span>)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data frames to include only data</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>df1_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(df1, DATE <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end_date)</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>df4_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(df4, DATE <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end_date)</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>df2_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(df2, DATE <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end_date)</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>df3_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(df3, DATE <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end_date)</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming the data is annual for this example. If it's quarterly, you'd use frequency = 4; if monthly, frequency = 12.</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>frequency <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ts objects</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a>saving <span class="ot">&lt;-</span> <span class="fu">ts</span>(df1_sub<span class="sc">$</span>W398RC1A027NBEA, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1992</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">ts</span>(df2_sub<span class="sc">$</span>MEHOINUSA672N, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1992</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a>sale <span class="ot">&lt;-</span> <span class="fu">ts</span>(df3_sub<span class="sc">$</span>MSPUS, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1992</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a>gini <span class="ot">&lt;-</span> <span class="fu">ts</span>(df4_sub<span class="sc">$</span>SIPOVGINIUSA, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1992</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combine-the-variables" class="level2">
<h2 class="anchored" data-anchor-id="combine-the-variables">Combine the Variables</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>dd1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(gini,saving,income,sale,df1_sub<span class="sc">$</span>DATE)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dd1)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"gini"</span>,<span class="st">"saving"</span>,<span class="st">"income"</span>,<span class="st">'sale'</span>,<span class="st">'date'</span>)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>dd1<span class="sc">$</span>gini <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">as.numeric</span>(dd1<span class="sc">$</span>gini))</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dd1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">gini</th>
<th style="text-align: right;">saving</th>
<th style="text-align: right;">income</th>
<th style="text-align: right;">sale</th>
<th style="text-align: left;">date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">38.4</td>
<td style="text-align: right;">431.693</td>
<td style="text-align: right;">58153</td>
<td style="text-align: right;">119500</td>
<td style="text-align: left;">1992-01-01</td>
</tr>
<tr class="even">
<td style="text-align: right;">40.4</td>
<td style="text-align: right;">377.899</td>
<td style="text-align: right;">57843</td>
<td style="text-align: right;">120000</td>
<td style="text-align: left;">1993-01-01</td>
</tr>
<tr class="odd">
<td style="text-align: right;">40.0</td>
<td style="text-align: right;">345.198</td>
<td style="text-align: right;">58515</td>
<td style="text-align: right;">120000</td>
<td style="text-align: left;">1994-01-01</td>
</tr>
<tr class="even">
<td style="text-align: right;">39.9</td>
<td style="text-align: right;">366.774</td>
<td style="text-align: right;">60348</td>
<td style="text-align: right;">126000</td>
<td style="text-align: left;">1995-01-01</td>
</tr>
<tr class="odd">
<td style="text-align: right;">40.3</td>
<td style="text-align: right;">353.639</td>
<td style="text-align: right;">61225</td>
<td style="text-align: right;">125000</td>
<td style="text-align: left;">1996-01-01</td>
</tr>
<tr class="even">
<td style="text-align: right;">40.5</td>
<td style="text-align: right;">339.566</td>
<td style="text-align: right;">62484</td>
<td style="text-align: right;">127000</td>
<td style="text-align: left;">1997-01-01</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>lg.dd1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"date"</span> <span class="ot">=</span>dd1<span class="sc">$</span>date,<span class="st">"gini"</span><span class="ot">=</span><span class="fu">log</span>(dd1<span class="sc">$</span>gini),<span class="st">"saving"</span><span class="ot">=</span><span class="fu">log</span>(dd1<span class="sc">$</span>saving),</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"income"</span><span class="ot">=</span><span class="fu">log</span>(dd1<span class="sc">$</span>income),<span class="st">"sale"</span><span class="ot">=</span><span class="fu">log</span>(dd1<span class="sc">$</span>sale))</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="do">#### converting to time series component #########</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>lg.dd.ts1<span class="ot">&lt;-</span><span class="fu">ts</span>(lg.dd1,<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="do">##### Facet Plot #######################</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(lg.dd.ts1[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"The Household Prices in USA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="auto-fit-the-model-2" class="level2">
<h2 class="anchored" data-anchor-id="auto-fit-the-model-2">Auto Fit the Model</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>xreg1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">saving =</span> lg.dd.ts1[, <span class="st">"saving"</span>],</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">income =</span> lg.dd.ts1[, <span class="st">"income"</span>],</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">sale =</span> lg.dd.ts1[, <span class="st">"sale"</span>])</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(lg.dd.ts1[, <span class="st">"gini"</span>], <span class="at">xreg =</span> xreg1)</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lg.dd.ts1[, "gini"] 
Regression with ARIMA(0,0,0) errors 

Coefficients:
       saving   income    sale
      -0.0304  -0.0279  0.3559
s.e.   0.0052   0.0516  0.0503

sigma^2 = 0.0001483:  log likelihood = 88.27
AIC=-168.54   AICc=-166.87   BIC=-163.07

Training set error measures:
                     ME       RMSE         MAE           MPE      MAPE
Training set 6.9935e-06 0.01153159 0.009483874 -0.0005959199 0.2563307
                  MASE       ACF1
Training set 0.7926458 -0.2180884</code></pre>
</div>
</div>
</section>
<section id="manual-fit-the-model-2" class="level2">
<h2 class="anchored" data-anchor-id="manual-fit-the-model-2">Manual Fit The Model</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>fit.reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( gini <span class="sc">~</span> saving<span class="sc">+</span> income <span class="sc">+</span> sale, <span class="at">data=</span>lg.dd.ts1)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.reg1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gini ~ saving + income + sale, data = lg.dd.ts1)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.026995 -0.007527  0.001984  0.005942  0.019001 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.660654   0.696434   0.949 0.351892    
saving      -0.024639   0.008162  -3.019 0.005773 ** 
income      -0.039670   0.055946  -0.709 0.484839    
sale         0.307851   0.073432   4.192 0.000302 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.0122 on 25 degrees of freedom
Multiple R-squared:  0.5148,    Adjusted R-squared:  0.4566 
F-statistic: 8.842 on 3 and 25 DF,  p-value: 0.0003612</code></pre>
</div>
</div>
<p>We can see that the sale and saving are pretty significant. For income, it seems that it does not provide too much impact. We can consider to remove it</p>
</section>
<section id="manual-fit-again" class="level2">
<h2 class="anchored" data-anchor-id="manual-fit-again">Manual Fit Again</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>fit.reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( gini <span class="sc">~</span> saving<span class="sc">+</span> sale, <span class="at">data=</span>lg.dd.ts1)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.reg1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gini ~ saving + sale, data = lg.dd.ts1)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.026489 -0.006684  0.002481  0.005509  0.020068 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.551544   0.672696   0.820  0.41973    
saving      -0.022918   0.007718  -2.969  0.00634 ** 
sale         0.279022   0.060561   4.607 9.48e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01208 on 26 degrees of freedom
Multiple R-squared:  0.5051,    Adjusted R-squared:  0.467 
F-statistic: 13.27 on 2 and 26 DF,  p-value: 0.000107</code></pre>
</div>
</div>
</section>
<section id="check-residuals-1" class="level2">
<h2 class="anchored" data-anchor-id="check-residuals-1">Check Residuals</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(0,0,0) errors
Q* = 4.509, df = 6, p-value = 0.6081

Model df: 0.   Total lags used: 6</code></pre>
</div>
</div>
<p>Based on the output, there’s no indication that seasonal terms are being used and the datasets did not have too much seasonal pattern. Therefore, this is an ARIMAX model.</p>
</section>
<section id="check-acf-and-pacf-1" class="level2">
<h2 class="anchored" data-anchor-id="check-acf-and-pacf-1">Check ACF and PACF</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="do">########### Converting to Time Series component #######</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>res.fit1<span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">residuals</span>(fit.reg1),<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="do">############## Then look at the residuals ############</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(res.fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggPacf</span>(res.fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Since there is no major seasonal pattern. And the dataset is stationary, We can actually use it as it is</p>
</section>
<section id="no-need-to-differencing" class="level2">
<h2 class="anchored" data-anchor-id="no-need-to-differencing">NO Need To Differencing</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the ACF and PACF plots without the theme</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>acf_plot <span class="ot">&lt;-</span> <span class="fu">ggAcf</span>(res.fit1) <span class="sc">+</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ACF "</span>) <span class="sc">+</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>pacf_plot <span class="ot">&lt;-</span> <span class="fu">ggPacf</span>(res.fit1) <span class="sc">+</span></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"PACF "</span>) <span class="sc">+</span></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#E0E0E0"</span>, <span class="at">color =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots</span></span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(acf_plot, pacf_plot, <span class="at">ncol =</span> <span class="dv">1</span>)             </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now, it is stationary for us to continue</p>
<p>From ACF and PACF, although there are not too many spikes and seasonal patterns, it seems that we can still consider: p = 1,2 q = 1,2. We use d = 0. There is no major seasonal pattern, therefore, no P,Q,D in this case.</p>
</section>
<section id="model-diagnotistics-2" class="level2">
<h2 class="anchored" data-anchor-id="model-diagnotistics-2">Model Diagnotistics</h2>
<p>Finding the model parameters.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">70</span>),<span class="at">nrow=</span><span class="dv">70</span>) </span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)<span class="co"># p=1,2,3 : 3</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)<span class="co"># q=1,2,3,4 :4</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)<span class="co"># d=1,2 :2</span></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>) <span class="co">#usual threshold</span></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(res.fit1,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d<span class="dv">-1</span>,q<span class="dv">-1</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>) </span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d<span class="dv">-1</span>,q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-28"><a href="#cb135-28" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb135-29"><a href="#cb135-29" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb135-30"><a href="#cb135-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-31"><a href="#cb135-31" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb135-32"><a href="#cb135-32" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-171.1425</td>
<td style="text-align: right;">-167.0406</td>
<td style="text-align: right;">-170.1825</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-145.8315</td>
<td style="text-align: right;">-143.1671</td>
<td style="text-align: right;">-145.3515</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-120.2833</td>
<td style="text-align: right;">-118.9874</td>
<td style="text-align: right;">-120.1233</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-172.1225</td>
<td style="text-align: right;">-166.6533</td>
<td style="text-align: right;">-170.4559</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-160.6843</td>
<td style="text-align: right;">-156.6877</td>
<td style="text-align: right;">-159.6843</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-136.1663</td>
<td style="text-align: right;">-133.5746</td>
<td style="text-align: right;">-135.6663</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-175.6608</td>
<td style="text-align: right;">-168.8243</td>
<td style="text-align: right;">-173.0521</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-160.6057</td>
<td style="text-align: right;">-155.2769</td>
<td style="text-align: right;">-158.8665</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-146.7495</td>
<td style="text-align: right;">-142.8620</td>
<td style="text-align: right;">-145.7060</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-174.5409</td>
<td style="text-align: right;">-166.3371</td>
<td style="text-align: right;">-170.7227</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-161.7076</td>
<td style="text-align: right;">-155.0466</td>
<td style="text-align: right;">-158.9804</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-145.5431</td>
<td style="text-align: right;">-140.3598</td>
<td style="text-align: right;">-143.7250</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-174.8678</td>
<td style="text-align: right;">-165.2967</td>
<td style="text-align: right;">-169.5345</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-158.8306</td>
<td style="text-align: right;">-150.8374</td>
<td style="text-align: right;">-154.8306</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-140.6901</td>
<td style="text-align: right;">-134.2109</td>
<td style="text-align: right;">-137.8329</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-171.0691</td>
<td style="text-align: right;">-165.6000</td>
<td style="text-align: right;">-169.4025</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-149.5256</td>
<td style="text-align: right;">-145.5290</td>
<td style="text-align: right;">-148.5256</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-125.4846</td>
<td style="text-align: right;">-122.8930</td>
<td style="text-align: right;">-124.9846</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-174.9728</td>
<td style="text-align: right;">-168.1363</td>
<td style="text-align: right;">-172.3641</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-160.0436</td>
<td style="text-align: right;">-154.7148</td>
<td style="text-align: right;">-158.3045</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-138.8040</td>
<td style="text-align: right;">-134.9164</td>
<td style="text-align: right;">-137.7605</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-175.2214</td>
<td style="text-align: right;">-167.0176</td>
<td style="text-align: right;">-171.4032</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-161.2007</td>
<td style="text-align: right;">-154.5397</td>
<td style="text-align: right;">-158.4735</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-145.3671</td>
<td style="text-align: right;">-140.1837</td>
<td style="text-align: right;">-143.5489</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-173.4902</td>
<td style="text-align: right;">-163.9191</td>
<td style="text-align: right;">-168.1568</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-160.8444</td>
<td style="text-align: right;">-152.8512</td>
<td style="text-align: right;">-156.8444</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-144.4574</td>
<td style="text-align: right;">-137.9782</td>
<td style="text-align: right;">-141.6003</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-173.1838</td>
<td style="text-align: right;">-162.2455</td>
<td style="text-align: right;">-165.9838</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-157.5276</td>
<td style="text-align: right;">-148.2022</td>
<td style="text-align: right;">-151.9276</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-144.0399</td>
<td style="text-align: right;">-136.2649</td>
<td style="text-align: right;">-139.8399</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-170.7698</td>
<td style="text-align: right;">-163.9333</td>
<td style="text-align: right;">-168.1611</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-156.3436</td>
<td style="text-align: right;">-151.0148</td>
<td style="text-align: right;">-154.6045</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-135.5731</td>
<td style="text-align: right;">-131.6856</td>
<td style="text-align: right;">-134.5296</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-170.4178</td>
<td style="text-align: right;">-162.2140</td>
<td style="text-align: right;">-166.5996</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-159.2853</td>
<td style="text-align: right;">-152.6243</td>
<td style="text-align: right;">-156.5580</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-144.3626</td>
<td style="text-align: right;">-139.1793</td>
<td style="text-align: right;">-142.5444</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-173.5908</td>
<td style="text-align: right;">-164.0197</td>
<td style="text-align: right;">-168.2575</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-159.2471</td>
<td style="text-align: right;">-151.2539</td>
<td style="text-align: right;">-155.2471</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-142.8931</td>
<td style="text-align: right;">-136.4140</td>
<td style="text-align: right;">-140.0360</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-171.6011</td>
<td style="text-align: right;">-160.6627</td>
<td style="text-align: right;">-164.4011</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-157.3864</td>
<td style="text-align: right;">-148.0609</td>
<td style="text-align: right;">-151.7864</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-144.3482</td>
<td style="text-align: right;">-136.5732</td>
<td style="text-align: right;">-140.1482</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-171.8233</td>
<td style="text-align: right;">-159.5177</td>
<td style="text-align: right;">-162.3496</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-155.9225</td>
<td style="text-align: right;">-145.2648</td>
<td style="text-align: right;">-148.3435</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-169.1140</td>
<td style="text-align: right;">-160.9102</td>
<td style="text-align: right;">-165.2958</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-155.1027</td>
<td style="text-align: right;">-148.4417</td>
<td style="text-align: right;">-152.3754</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-137.2481</td>
<td style="text-align: right;">-132.0647</td>
<td style="text-align: right;">-135.4299</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-168.7809</td>
<td style="text-align: right;">-159.2099</td>
<td style="text-align: right;">-163.4476</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-157.8894</td>
<td style="text-align: right;">-149.8962</td>
<td style="text-align: right;">-153.8894</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-142.7900</td>
<td style="text-align: right;">-136.3108</td>
<td style="text-align: right;">-139.9329</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-171.6359</td>
<td style="text-align: right;">-160.6975</td>
<td style="text-align: right;">-164.4359</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-156.0375</td>
<td style="text-align: right;">-146.7120</td>
<td style="text-align: right;">-150.4375</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-143.0555</td>
<td style="text-align: right;">-135.2804</td>
<td style="text-align: right;">-138.8555</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-169.6948</td>
<td style="text-align: right;">-157.3891</td>
<td style="text-align: right;">-160.2211</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-157.8215</td>
<td style="text-align: right;">-147.1639</td>
<td style="text-align: right;">-150.2426</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">-177.8730</td>
<td style="text-align: right;">-164.2001</td>
<td style="text-align: right;">-165.6508</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-167.5350</td>
<td style="text-align: right;">-157.9639</td>
<td style="text-align: right;">-162.2017</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-153.4391</td>
<td style="text-align: right;">-145.4459</td>
<td style="text-align: right;">-149.4391</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-139.8623</td>
<td style="text-align: right;">-133.3832</td>
<td style="text-align: right;">-137.0052</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-173.9016</td>
<td style="text-align: right;">-162.9633</td>
<td style="text-align: right;">-166.7016</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-156.1053</td>
<td style="text-align: right;">-146.7798</td>
<td style="text-align: right;">-150.5053</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-140.9387</td>
<td style="text-align: right;">-133.1636</td>
<td style="text-align: right;">-136.7387</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-179.3839</td>
<td style="text-align: right;">-167.0783</td>
<td style="text-align: right;">-169.9102</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-155.4640</td>
<td style="text-align: right;">-144.8063</td>
<td style="text-align: right;">-147.8850</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">-175.6302</td>
<td style="text-align: right;">-161.9573</td>
<td style="text-align: right;">-163.4080</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q       AIC       BIC      AICc
63 4 0 2 -179.3839 -167.0783 -169.9102</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q       AIC       BIC      AICc
7 0 0 2 -175.6608 -168.8243 -173.0521</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q       AIC       BIC      AICc
7 0 0 2 -175.6608 -168.8243 -173.0521</code></pre>
</div>
</div>
<p>From here, we can see that (4,0,2) and (0,0,2) is better. Therefore, we will compare them</p>
</section>
<section id="compare-with-the-two-models" class="level2">
<h2 class="anchored" data-anchor-id="compare-with-the-two-models">Compare with the two models</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">236</span>)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>model_output11 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit1, <span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">2</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>model_output12 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit1, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-86-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output11[<span class="dv">150</span><span class="sc">:</span><span class="dv">173</span>], model_output11[<span class="fu">length</span>(model_output11)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>sigma^2 estimated as 8.309e-05:  log likelihood = 92.98,  aic = -169.95

$degrees_of_freedom
[1] 22

$ttable
      Estimate     SE t.value p.value
ar1     0.8855 0.3372  2.6261  0.0154
ar2    -0.2522 0.3647 -0.6915  0.4965
ar3     0.3589 0.3174  1.1306  0.2704
ar4    -0.4707 0.2172 -2.1672  0.0413
ma1    -1.4055 0.3923 -3.5824  0.0017
ma2     0.4056 0.3622  1.1198  0.2749
xmean   0.0002 0.0004  0.6298  0.5353

$AIC
[1] -5.860371

$AICc
[1] -5.676463

$BIC
[1] -5.483186</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output12[<span class="dv">40</span><span class="sc">:</span><span class="dv">67</span>], model_output12[<span class="fu">length</span>(model_output12)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    optim.control = list(trace = trc, REPORT = 1, reltol = tol))

Coefficients:
          ma1      ma2  xmean
      -0.2594  -0.7406  2e-04
s.e.   0.3312   0.3122  4e-04

sigma^2 estimated as 0.000101:  log likelihood = 90.7,  aic = -173.4

$degrees_of_freedom
[1] 26

$ttable
      Estimate     SE t.value p.value
ma1    -0.2594 0.3312 -0.7831  0.4406
ma2    -0.7406 0.3122 -2.3721  0.0254
xmean   0.0002 0.0004  0.5482  0.5883

$AIC
[1] -5.979431

$AICc
[1] -5.946327

$BIC
[1] -5.790838

NA</code></pre>
</div>
</div>
<p>Based on this, I think the second one (0,0,2) is slightly better with less correlation and smaller AIC value.</p>
</section>
<section id="cross-validation-2" class="level2">
<h2 class="anchored" data-anchor-id="cross-validation-2">Cross validation</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(res.fit1)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>n <span class="sc">*</span><span class="fl">0.3</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.7</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">ts</span>(dd1[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The number of folds for cross-validation</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>n_folds <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>horizon <span class="ot">&lt;-</span> <span class="dv">4</span>  <span class="co"># Forecasting horizon</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>window_size <span class="ot">&lt;-</span> <span class="fu">length</span>(dat[, <span class="dv">3</span>]) <span class="sc">-</span> (n_folds <span class="sc">*</span> horizon)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty list to store forecasts</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>forecasts <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>forecasts2 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize vectors to store error metrics for each model</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_folds)</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>rmse2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_folds)</span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_folds) {</span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the training set for this fold</span></span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>  train_set <span class="ot">&lt;-</span> <span class="fu">window</span>(dat[, <span class="dv">3</span>], <span class="at">end =</span> <span class="fu">c</span>(window_size <span class="sc">+</span> ((i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> horizon)))</span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the ARIMA models on the training set</span></span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(train_set, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(train_set, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb151-21"><a href="#cb151-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-22"><a href="#cb151-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Forecast on the horizon</span></span>
<span id="cb151-23"><a href="#cb151-23" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h =</span> horizon)</span>
<span id="cb151-24"><a href="#cb151-24" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h =</span> horizon)</span>
<span id="cb151-25"><a href="#cb151-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-26"><a href="#cb151-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store forecasts</span></span>
<span id="cb151-27"><a href="#cb151-27" aria-hidden="true" tabindex="-1"></a>  forecasts[[i]] <span class="ot">&lt;-</span> fcast</span>
<span id="cb151-28"><a href="#cb151-28" aria-hidden="true" tabindex="-1"></a>  forecasts2[[i]] <span class="ot">&lt;-</span> fcast2</span>
<span id="cb151-29"><a href="#cb151-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-30"><a href="#cb151-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the test set for this fold</span></span>
<span id="cb151-31"><a href="#cb151-31" aria-hidden="true" tabindex="-1"></a>  test_set <span class="ot">&lt;-</span> <span class="fu">window</span>(dat[, <span class="dv">3</span>], <span class="at">start =</span> window_size <span class="sc">+</span> ((i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> horizon) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">end =</span> window_size <span class="sc">+</span> (i <span class="sc">*</span> horizon))</span>
<span id="cb151-32"><a href="#cb151-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-33"><a href="#cb151-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate and store the RMSE for each model</span></span>
<span id="cb151-34"><a href="#cb151-34" aria-hidden="true" tabindex="-1"></a>  rmse1[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((fcast<span class="sc">$</span>mean <span class="sc">-</span> test_set)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb151-35"><a href="#cb151-35" aria-hidden="true" tabindex="-1"></a>  rmse2[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((fcast2<span class="sc">$</span>mean <span class="sc">-</span> test_set)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb151-36"><a href="#cb151-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb151-37"><a href="#cb151-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-38"><a href="#cb151-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the average RMSE for each model</span></span>
<span id="cb151-39"><a href="#cb151-39" aria-hidden="true" tabindex="-1"></a>mean_rmse1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmse1)</span>
<span id="cb151-40"><a href="#cb151-40" aria-hidden="true" tabindex="-1"></a>mean_rmse2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmse2)</span>
<span id="cb151-41"><a href="#cb151-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-42"><a href="#cb151-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-43"><a href="#cb151-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-44"><a href="#cb151-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot RMSE values for both models</span></span>
<span id="cb151-45"><a href="#cb151-45" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rmse1, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">ylim =</span> <span class="fu">range</span>(<span class="fu">c</span>(rmse1, rmse2)), </span>
<span id="cb151-46"><a href="#cb151-46" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Fold"</span>, <span class="at">ylab =</span> <span class="st">"RMSE"</span>, <span class="at">pch =</span> <span class="dv">19</span>, </span>
<span id="cb151-47"><a href="#cb151-47" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Cross-Validation RMSE for ARIMA Models"</span>)</span>
<span id="cb151-48"><a href="#cb151-48" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(rmse2, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">18</span>)</span>
<span id="cb151-49"><a href="#cb151-49" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(rmse2, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">18</span>)</span>
<span id="cb151-50"><a href="#cb151-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-51"><a href="#cb151-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend to the plot</span></span>
<span id="cb151-52"><a href="#cb151-52" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Model 1 (ARIMA(4,0,2))"</span>, <span class="st">"Model 2 (ARIMA(0,0,2))"</span>), </span>
<span id="cb151-53"><a href="#cb151-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">18</span>), <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Output </span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>mean_rmse1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2804.59</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>mean_rmse2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2507.994</code></pre>
</div>
</div>
<p>Based on the cross validation, we can see that the conclusion aligns, the fit1 which is (0,0,2) performs better with smaller errors.</p>
</section>
<section id="fit-the-model-1" class="level2">
<h2 class="anchored" data-anchor-id="fit-the-model-1">Fit the model</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>xreg1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">saving =</span> lg.dd.ts1[, <span class="st">"saving"</span>],</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">sale =</span> lg.dd.ts1[, <span class="st">"sale"</span>])</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(lg.dd.ts1[, <span class="st">"gini"</span>],<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">xreg=</span>xreg1)</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lg.dd.ts1[, "gini"] 
Regression with ARIMA(0,0,2) errors 

Coefficients:
          ma1      ma2  intercept   saving    sale
      -0.4973  -0.5027     0.5375  -0.0204  0.2789
s.e.   0.2694   0.2576     0.1358   0.0007  0.0119

sigma^2 = 0.0001067:  log likelihood = 92.76
AIC=-173.52   AICc=-169.7   BIC=-165.31

Training set error measures:
                        ME       RMSE         MAE         MPE     MAPE
Training set -9.655453e-05 0.00939564 0.007461685 -0.00333216 0.201711
                  MASE        ACF1
Training set 0.6236347 -0.06097811</code></pre>
</div>
</div>
<p>The equation: Given that <code>y_t</code> represents the log-transformed <code>homevalue</code> at time <code>t</code>, the ARIMA(0,0,2) can be:</p>
<p>( y_t = c + <em>1 e</em>{t-1} + <em>2 e</em>{t-2} + _1 _t + _2 _t + e_t )</p>
<p>Based on the summary, my equation is</p>
<p>( y_t = 0.5375 - 0.4973 e_{t-1} - 0.5027 e_{t-2} - 0.0204 _t + 0.2789 _t + e_t )</p>
</section>
<section id="forecast" class="level2">
<h2 class="anchored" data-anchor-id="forecast">Forecast</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>sfit<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(lg.dd.ts1[, <span class="st">"sale"</span>]) </span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sfit) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lg.dd.ts1[, "sale"] 
ARIMA(1,1,0) with drift 

Coefficients:
          ar1   drift
      -0.6624  0.0097
s.e.   0.1365  0.0016

sigma^2 = 0.0002195:  log likelihood = 79.3
AIC=-152.6   AICc=-151.6   BIC=-148.6

Training set error measures:
                       ME       RMSE        MAE         MPE      MAPE      MASE
Training set 0.0003253088 0.01402717 0.01068364 0.002634758 0.0903859 0.2864612
                   ACF1
Training set -0.1025856</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>fs<span class="ot">&lt;-</span><span class="fu">forecast</span>(sfit,<span class="dv">80</span>) <span class="co">#obtaining forecasts</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>s2fit<span class="ot">&lt;-</span><span class="fu">auto.arima</span>(lg.dd.ts1[, <span class="st">"saving"</span>]) <span class="co">#fitting an ARIMA model to the Import variable</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(s2fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lg.dd.ts1[, "saving"] 
ARIMA(0,1,0) with drift 

Coefficients:
       drift
      0.0701
s.e.  0.0447

sigma^2 = 0.05808:  log likelihood = 0.62
AIC=2.76   AICc=3.24   BIC=5.42

Training set error measures:
                       ME      RMSE       MAE        MPE     MAPE      MASE
Training set 0.0002068136 0.2325379 0.1666254 -0.1667371 2.642544 0.4511904
                    ACF1
Training set -0.04495977</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>fs2<span class="ot">&lt;-</span><span class="fu">forecast</span>(s2fit,<span class="dv">80</span>)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>fxreg <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">sale =</span> fs2<span class="sc">$</span>mean,<span class="at">saving =</span> fs<span class="sc">$</span>mean) <span class="co">#fimp$mean gives the forecasted values</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit1, <span class="at">xreg=</span>fxreg,<span class="dv">80</span>) </span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast, <span class="at">main=</span><span class="st">"Forecast of Home Values"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Home"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="var-home-value-saving-rate-gdp-deflator-sale-price" class="level1">
<h1>5. (VAR) Home Value ~ Saving Rate + Gdp Deflator + Sale Price</h1>
<section id="time-series-transformation" class="level2">
<h2 class="anchored" data-anchor-id="time-series-transformation">Time Series Transformation</h2>
<div class="cell">

</div>
</section>
<section id="select-the-variables-with-common-dates" class="level2">
<h2 class="anchored" data-anchor-id="select-the-variables-with-common-dates">Select the Variables with common Dates</h2>
<p>Home Value ~ Saving Rate + Gdp Deflator + Sale Price</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define start and end dates</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2000-01-01"</span>)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-12-31"</span>)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data frames to include only data from 1992 through 2020</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>df3_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(df3, DATE <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end_date)</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>df6_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(df6, DATE <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end_date)</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>df7_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(df7, DATE <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end_date)</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>df9_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(df9, DATE <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> DATE <span class="sc">&lt;=</span> end_date)</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming the data is annual for this example. If it's quarterly, you'd use frequency = 4; if monthly, frequency = 12.</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>frequency <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ts objects</span></span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>sale <span class="ot">&lt;-</span> <span class="fu">ts</span>(df3_sub<span class="sc">$</span>MSPUS, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>saving <span class="ot">&lt;-</span> <span class="fu">ts</span>(df6_sub<span class="sc">$</span>PSAVERT, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a>gdp <span class="ot">&lt;-</span> <span class="fu">ts</span>(df7_sub<span class="sc">$</span>A191RI1Q225SBEA, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a>homevalue <span class="ot">&lt;-</span> <span class="fu">ts</span>(df9_sub<span class="sc">$</span>USAUCSFRCONDOSMSAMID, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>DATE <span class="ot">&lt;-</span> <span class="fu">ts</span>(df7_sub<span class="sc">$</span>DATE, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">1</span>), <span class="at">frequency =</span> frequency)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combine-the-variables-1" class="level2">
<h2 class="anchored" data-anchor-id="combine-the-variables-1">Combine the Variables</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>dd3<span class="ot">&lt;-</span><span class="fu">data.frame</span>(homevalue,saving,gdp,sale,DATE)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dd3)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"homevalue"</span>,<span class="st">"saving"</span>,<span class="st">"gdp_deflator"</span>, <span class="st">"sale"</span>,<span class="st">'date'</span>)</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dd3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">homevalue</th>
<th style="text-align: right;">saving</th>
<th style="text-align: right;">gdp_deflator</th>
<th style="text-align: right;">sale</th>
<th style="text-align: right;">date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">121428.3</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">165300</td>
<td style="text-align: right;">10957</td>
</tr>
<tr class="even">
<td style="text-align: right;">121642.0</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">163200</td>
<td style="text-align: right;">11048</td>
</tr>
<tr class="odd">
<td style="text-align: right;">121906.9</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">168800</td>
<td style="text-align: right;">11139</td>
</tr>
<tr class="even">
<td style="text-align: right;">122475.1</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">172900</td>
<td style="text-align: right;">11231</td>
</tr>
<tr class="odd">
<td style="text-align: right;">123129.1</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">169800</td>
<td style="text-align: right;">11323</td>
</tr>
<tr class="even">
<td style="text-align: right;">123830.3</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">179000</td>
<td style="text-align: right;">11413</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="plot-the-figure-together" class="level2">
<h2 class="anchored" data-anchor-id="plot-the-figure-together">Plot the Figure Together</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>lg.dd3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"date"</span> <span class="ot">=</span>dd3<span class="sc">$</span>date,<span class="st">"sale"</span><span class="ot">=</span><span class="fu">log</span>(dd3<span class="sc">$</span>sale),<span class="st">"saving"</span><span class="ot">=</span><span class="fu">log</span>(dd3<span class="sc">$</span>saving),<span class="st">"homevalue"</span><span class="ot">=</span><span class="fu">log</span>(dd3<span class="sc">$</span>homevalue),</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"gdp_deflator"</span><span class="ot">=</span><span class="fu">log</span>(dd3<span class="sc">$</span>gdp))</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="do">#### converting to time series component #########</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>lg.dd.ts3<span class="ot">&lt;-</span><span class="fu">ts</span>(lg.dd3,<span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="do">##### Facet Plot #######################</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(lg.dd.ts3[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"The GDP Deflator, Sale Price, Saving Rate, Home value in USA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="fitting-a-var-model" class="level2">
<h2 class="anchored" data-anchor-id="fitting-a-var-model">Fitting a VAR model</h2>
<p>Finding out the best p:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VARselect</span>(dd3[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">lag.max=</span><span class="dv">14</span>, <span class="at">type=</span><span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$selection
AIC(n)  HQ(n)  SC(n) FPE(n) 
    14     14      1     14 

$criteria
                  1            2            3            4            5
AIC(n) 1.623230e+01 1.585994e+01 1.597680e+01 1.591038e+01 1.530104e+01
HQ(n)  1.654480e+01 1.638078e+01 1.670598e+01 1.684788e+01 1.644688e+01
SC(n)  1.702204e+01 1.717618e+01 1.781953e+01 1.827960e+01 1.819676e+01
FPE(n) 1.123135e+07 7.794514e+06 8.902039e+06 8.575733e+06 4.886908e+06
                  6            7            8            9           10
AIC(n) 1.540760e+01 1.514539e+01 1.518739e+01 1.460313e+01 1.459530e+01
HQ(n)  1.676178e+01 1.670790e+01 1.695824e+01 1.658231e+01 1.678281e+01
SC(n)  1.882981e+01 1.909409e+01 1.966259e+01 1.960482e+01 2.012348e+01
FPE(n) 5.834120e+06 4.967706e+06 5.969293e+06 4.042891e+06 5.231765e+06
                 11           12           13           14
AIC(n) 1.364742e+01 1.256891e+01 1.182785e+01      9.56155
HQ(n)  1.604327e+01 1.517310e+01 1.464037e+01     12.58241
SC(n)  1.970209e+01 1.915008e+01 1.893551e+01     17.19571
FPE(n) 2.917799e+06 1.647224e+06 1.628958e+06 519454.19470</code></pre>
</div>
</div>
<p>From the results, we can see that 13,14 have relatively smaller criterias:</p>
<p>We can fit several models with p=13, 14.=&gt; VAR(13), VAR(14)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(dd3[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">p=</span><span class="dv">13</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: saving, gdp_deflator, sale, date 
Deterministic variables: both 
Sample size: 68 
Log Likelihood: -567.72 
Roots of the characteristic polynomial:
1.035 1.021 1.021 1.008 1.008 1.004 1.004     1     1 0.9997 0.9997 0.9985 0.9985 0.9915 0.9915 0.9857 0.9834 0.9834 0.9832 0.9832 0.9815 0.9815 0.9749 0.9749 0.9734 0.9734 0.9729 0.9729 0.9669 0.9669 0.9637 0.9637 0.9621 0.9621 0.9476 0.9476 0.9337 0.9337 0.9328 0.9328 0.9302 0.9302 0.9299 0.9299 0.909 0.909 0.8471 0.7737 0.695 0.695 0.4355 0.4355
Call:
vars::VAR(y = dd3[, c(2:5)], p = 13, type = "both")


Estimation results for equation saving: 
======================================= 
saving = saving.l1 + gdp_deflator.l1 + sale.l1 + date.l1 + saving.l2 + gdp_deflator.l2 + sale.l2 + date.l2 + saving.l3 + gdp_deflator.l3 + sale.l3 + date.l3 + saving.l4 + gdp_deflator.l4 + sale.l4 + date.l4 + saving.l5 + gdp_deflator.l5 + sale.l5 + date.l5 + saving.l6 + gdp_deflator.l6 + sale.l6 + date.l6 + saving.l7 + gdp_deflator.l7 + sale.l7 + date.l7 + saving.l8 + gdp_deflator.l8 + sale.l8 + date.l8 + saving.l9 + gdp_deflator.l9 + sale.l9 + date.l9 + saving.l10 + gdp_deflator.l10 + sale.l10 + date.l10 + saving.l11 + gdp_deflator.l11 + sale.l11 + date.l11 + saving.l12 + gdp_deflator.l12 + sale.l12 + date.l12 + saving.l13 + gdp_deflator.l13 + sale.l13 + date.l13 + const + trend 

                   Estimate Std. Error t value Pr(&gt;|t|)  
saving.l1         2.908e-01  2.872e-01   1.013   0.3285  
gdp_deflator.l1   1.711e-01  3.511e-01   0.487   0.6336  
sale.l1           2.098e-05  3.099e-05   0.677   0.5094  
date.l1           1.046e+00  6.562e-01   1.594   0.1333  
saving.l2        -1.198e-01  2.610e-01  -0.459   0.6533  
gdp_deflator.l2   1.933e-02  3.535e-01   0.055   0.9572  
sale.l2          -2.719e-05  2.607e-05  -1.043   0.3146  
date.l2          -3.554e-01  6.401e-01  -0.555   0.5875  
saving.l3        -1.422e-01  2.480e-01  -0.574   0.5753  
gdp_deflator.l3   5.727e-02  3.110e-01   0.184   0.8565  
sale.l3          -4.226e-06  2.668e-05  -0.158   0.8764  
date.l3           5.122e-01  6.753e-01   0.758   0.4608  
saving.l4        -2.747e-02  2.182e-01  -0.126   0.9016  
gdp_deflator.l4   6.959e-01  2.947e-01   2.362   0.0332 *
sale.l4          -3.909e-05  2.674e-05  -1.462   0.1658  
date.l4          -8.648e-01  6.756e-01  -1.280   0.2213  
saving.l5         1.842e-01  2.431e-01   0.758   0.4612  
gdp_deflator.l5   5.206e-02  3.233e-01   0.161   0.8744  
sale.l5           2.488e-05  2.213e-05   1.124   0.2798  
date.l5           3.609e-02  6.480e-01   0.056   0.9564  
saving.l6         4.881e-02  2.016e-01   0.242   0.8122  
gdp_deflator.l6   8.258e-02  2.831e-01   0.292   0.7748  
sale.l6          -2.184e-05  2.360e-05  -0.925   0.3705  
date.l6          -2.468e-01  6.530e-01  -0.378   0.7111  
saving.l7        -5.310e-01  2.362e-01  -2.248   0.0412 *
gdp_deflator.l7   5.376e-02  2.009e-01   0.268   0.7929  
sale.l7           1.010e-05  2.576e-05   0.392   0.7008  
date.l7           1.775e+00  7.591e-01   2.339   0.0347 *
saving.l8         3.975e-01  3.213e-01   1.237   0.2363  
gdp_deflator.l8   3.341e-01  1.765e-01   1.893   0.0792 .
sale.l8          -6.328e-05  4.354e-05  -1.453   0.1682  
date.l8          -1.411e-01  7.180e-01  -0.196   0.8471  
saving.l9        -1.211e-01  3.235e-01  -0.374   0.7138  
gdp_deflator.l9   5.550e-02  1.902e-01   0.292   0.7747  
sale.l9           3.448e-05  3.337e-05   1.033   0.3190  
date.l9           4.678e-01  8.289e-01   0.564   0.5815  
saving.l10       -2.254e-01  2.921e-01  -0.772   0.4530  
gdp_deflator.l10 -1.552e-01  1.714e-01  -0.905   0.3805  
sale.l10         -2.976e-05  3.162e-05  -0.941   0.3624  
date.l10          1.580e-01  9.071e-01   0.174   0.8642  
saving.l11       -2.268e-02  2.522e-01  -0.090   0.9296  
gdp_deflator.l11  1.209e-01  1.778e-01   0.680   0.5075  
sale.l11          9.539e-05  3.521e-05   2.709   0.0169 *
date.l11         -8.571e-01  7.812e-01  -1.097   0.2911  
saving.l12        3.879e-01  2.473e-01   1.569   0.1390  
gdp_deflator.l12  1.344e-01  1.553e-01   0.865   0.4014  
sale.l12         -2.117e-05  4.142e-05  -0.511   0.6172  
date.l12          7.070e-01  6.852e-01   1.032   0.3196  
saving.l13        4.278e-02  2.301e-01   0.186   0.8552  
gdp_deflator.l13  2.689e-01  2.413e-01   1.114   0.2838  
sale.l13         -1.205e-05  3.414e-05  -0.353   0.7293  
date.l13         -2.870e-01  6.661e-01  -0.431   0.6731  
const            -2.031e+04  3.379e+04  -0.601   0.5573  
trend            -1.780e+02  3.017e+02  -0.590   0.5646  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.6358 on 14 degrees of freedom
Multiple R-Squared: 0.9397, Adjusted R-squared: 0.7116 
F-statistic: 4.119 on 53 and 14 DF,  p-value: 0.002798 


Estimation results for equation gdp_deflator: 
============================================= 
gdp_deflator = saving.l1 + gdp_deflator.l1 + sale.l1 + date.l1 + saving.l2 + gdp_deflator.l2 + sale.l2 + date.l2 + saving.l3 + gdp_deflator.l3 + sale.l3 + date.l3 + saving.l4 + gdp_deflator.l4 + sale.l4 + date.l4 + saving.l5 + gdp_deflator.l5 + sale.l5 + date.l5 + saving.l6 + gdp_deflator.l6 + sale.l6 + date.l6 + saving.l7 + gdp_deflator.l7 + sale.l7 + date.l7 + saving.l8 + gdp_deflator.l8 + sale.l8 + date.l8 + saving.l9 + gdp_deflator.l9 + sale.l9 + date.l9 + saving.l10 + gdp_deflator.l10 + sale.l10 + date.l10 + saving.l11 + gdp_deflator.l11 + sale.l11 + date.l11 + saving.l12 + gdp_deflator.l12 + sale.l12 + date.l12 + saving.l13 + gdp_deflator.l13 + sale.l13 + date.l13 + const + trend 

                   Estimate Std. Error t value Pr(&gt;|t|)   
saving.l1        -4.611e-01  2.481e-01  -1.859  0.08420 . 
gdp_deflator.l1   4.021e-01  3.032e-01   1.326  0.20603   
sale.l1           2.180e-05  2.676e-05   0.815  0.42889   
date.l1           4.124e-01  5.667e-01   0.728  0.47874   
saving.l2         3.869e-01  2.254e-01   1.716  0.10819   
gdp_deflator.l2   6.262e-02  3.053e-01   0.205  0.84044   
sale.l2          -1.508e-06  2.251e-05  -0.067  0.94753   
date.l2          -7.359e-01  5.528e-01  -1.331  0.20441   
saving.l3        -3.211e-02  2.141e-01  -0.150  0.88296   
gdp_deflator.l3   2.799e-02  2.686e-01   0.104  0.91848   
sale.l3           4.193e-07  2.305e-05   0.018  0.98574   
date.l3          -2.387e-01  5.832e-01  -0.409  0.68851   
saving.l4        -4.318e-01  1.885e-01  -2.291  0.03798 * 
gdp_deflator.l4   3.419e-01  2.545e-01   1.344  0.20043   
sale.l4           1.016e-05  2.309e-05   0.440  0.66679   
date.l4          -1.510e-02  5.835e-01  -0.026  0.97972   
saving.l5         4.398e-03  2.099e-01   0.021  0.98358   
gdp_deflator.l5   4.860e-02  2.792e-01   0.174  0.86430   
sale.l5          -4.313e-05  1.911e-05  -2.257  0.04050 * 
date.l5          -6.851e-02  5.597e-01  -0.122  0.90431   
saving.l6         4.401e-01  1.741e-01   2.527  0.02415 * 
gdp_deflator.l6   6.141e-02  2.445e-01   0.251  0.80532   
sale.l6           2.741e-05  2.039e-05   1.344  0.20018   
date.l6           9.817e-01  5.640e-01   1.741  0.10366   
saving.l7        -6.433e-01  2.040e-01  -3.154  0.00704 **
gdp_deflator.l7  -9.428e-02  1.735e-01  -0.543  0.59539   
sale.l7          -5.432e-05  2.225e-05  -2.441  0.02852 * 
date.l7          -5.684e-01  6.556e-01  -0.867  0.40052   
saving.l8         5.461e-03  2.775e-01   0.020  0.98458   
gdp_deflator.l8  -8.684e-02  1.525e-01  -0.570  0.57800   
sale.l8           4.609e-05  3.760e-05   1.226  0.24054   
date.l8           1.083e+00  6.201e-01   1.747  0.10248   
saving.l9         3.778e-01  2.794e-01   1.352  0.19781   
gdp_deflator.l9   1.485e-01  1.642e-01   0.904  0.38123   
sale.l9          -3.166e-05  2.882e-05  -1.098  0.29056   
date.l9          -1.140e+00  7.159e-01  -1.592  0.13369   
saving.l10       -7.754e-02  2.522e-01  -0.307  0.76306   
gdp_deflator.l10  1.545e-01  1.480e-01   1.043  0.31449   
sale.l10         -2.887e-05  2.730e-05  -1.057  0.30832   
date.l10          3.145e-03  7.834e-01   0.004  0.99685   
saving.l11       -6.629e-02  2.178e-01  -0.304  0.76536   
gdp_deflator.l11 -9.043e-02  1.536e-01  -0.589  0.56541   
sale.l11          3.491e-05  3.041e-05   1.148  0.27019   
date.l11          8.235e-01  6.747e-01   1.221  0.24243   
saving.l12       -1.859e-01  2.136e-01  -0.871  0.39861   
gdp_deflator.l12  2.547e-01  1.342e-01   1.898  0.07846 . 
sale.l12          7.403e-06  3.578e-05   0.207  0.83905   
date.l12         -9.841e-01  5.918e-01  -1.663  0.11856   
saving.l13        2.576e-01  1.987e-01   1.296  0.21588   
gdp_deflator.l13 -2.652e-01  2.084e-01  -1.272  0.22397   
sale.l13          1.495e-05  2.948e-05   0.507  0.61990   
date.l13          6.931e-01  5.752e-01   1.205  0.24820   
const            -2.276e+03  2.918e+04  -0.078  0.93894   
trend            -2.257e+01  2.606e+02  -0.087  0.93221   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.5491 on 14 degrees of freedom
Multiple R-Squared: 0.9365, Adjusted R-squared: 0.696 
F-statistic: 3.895 on 53 and 14 DF,  p-value: 0.003752 


Estimation results for equation sale: 
===================================== 
sale = saving.l1 + gdp_deflator.l1 + sale.l1 + date.l1 + saving.l2 + gdp_deflator.l2 + sale.l2 + date.l2 + saving.l3 + gdp_deflator.l3 + sale.l3 + date.l3 + saving.l4 + gdp_deflator.l4 + sale.l4 + date.l4 + saving.l5 + gdp_deflator.l5 + sale.l5 + date.l5 + saving.l6 + gdp_deflator.l6 + sale.l6 + date.l6 + saving.l7 + gdp_deflator.l7 + sale.l7 + date.l7 + saving.l8 + gdp_deflator.l8 + sale.l8 + date.l8 + saving.l9 + gdp_deflator.l9 + sale.l9 + date.l9 + saving.l10 + gdp_deflator.l10 + sale.l10 + date.l10 + saving.l11 + gdp_deflator.l11 + sale.l11 + date.l11 + saving.l12 + gdp_deflator.l12 + sale.l12 + date.l12 + saving.l13 + gdp_deflator.l13 + sale.l13 + date.l13 + const + trend 

                   Estimate Std. Error t value Pr(&gt;|t|)  
saving.l1        -4.084e+03  2.979e+03  -1.371   0.1920  
gdp_deflator.l1  -9.744e+02  3.642e+03  -0.268   0.7929  
sale.l1           7.623e-01  3.214e-01   2.372   0.0326 *
date.l1           2.490e+03  6.806e+03   0.366   0.7199  
saving.l2        -4.804e+02  2.707e+03  -0.177   0.8617  
gdp_deflator.l2   4.768e+03  3.666e+03   1.300   0.2145  
sale.l2           5.903e-02  2.703e-01   0.218   0.8303  
date.l2          -6.124e+02  6.639e+03  -0.092   0.9278  
saving.l3         1.587e+03  2.572e+03   0.617   0.5471  
gdp_deflator.l3  -5.637e+03  3.226e+03  -1.747   0.1024  
sale.l3           2.499e-01  2.768e-01   0.903   0.3818  
date.l3          -7.087e+02  7.005e+03  -0.101   0.9208  
saving.l4        -2.482e+03  2.264e+03  -1.097   0.2913  
gdp_deflator.l4   3.322e+03  3.056e+03   1.087   0.2955  
sale.l4          -3.578e-01  2.773e-01  -1.290   0.2179  
date.l4           1.388e+04  7.007e+03   1.981   0.0676 .
saving.l5        -5.417e+02  2.521e+03  -0.215   0.8330  
gdp_deflator.l5   1.615e+03  3.353e+03   0.482   0.6376  
sale.l5          -1.824e-01  2.295e-01  -0.795   0.4400  
date.l5          -9.008e+03  6.721e+03  -1.340   0.2015  
saving.l6         1.384e+03  2.091e+03   0.662   0.5188  
gdp_deflator.l6   7.061e+02  2.936e+03   0.240   0.8134  
sale.l6          -7.230e-02  2.448e-01  -0.295   0.7721  
date.l6           9.888e+02  6.773e+03   0.146   0.8860  
saving.l7        -2.816e+03  2.450e+03  -1.149   0.2696  
gdp_deflator.l7  -8.100e+02  2.084e+03  -0.389   0.7033  
sale.l7           3.045e-01  2.672e-01   1.139   0.2737  
date.l7           3.220e+03  7.873e+03   0.409   0.6887  
saving.l8        -2.854e+03  3.332e+03  -0.856   0.4062  
gdp_deflator.l8  -9.438e+02  1.831e+03  -0.515   0.6143  
sale.l8          -9.160e-02  4.516e-01  -0.203   0.8422  
date.l8          -4.669e+03  7.447e+03  -0.627   0.5408  
saving.l9         4.690e+03  3.356e+03   1.398   0.1840  
gdp_deflator.l9   5.201e+03  1.973e+03   2.637   0.0195 *
sale.l9           1.949e-01  3.461e-01   0.563   0.5823  
date.l9           1.035e+04  8.598e+03   1.204   0.2486  
saving.l10       -1.195e+03  3.029e+03  -0.394   0.6993  
gdp_deflator.l10 -6.464e+02  1.778e+03  -0.364   0.7216  
sale.l10         -6.476e-01  3.279e-01  -1.975   0.0683 .
date.l10         -4.637e+03  9.408e+03  -0.493   0.6298  
saving.l11       -4.289e+03  2.616e+03  -1.639   0.1234  
gdp_deflator.l11 -1.225e+03  1.845e+03  -0.664   0.5173  
sale.l11          5.896e-01  3.652e-01   1.615   0.1287  
date.l11          7.608e+03  8.103e+03   0.939   0.3637  
saving.l12        1.989e+03  2.565e+03   0.776   0.4509  
gdp_deflator.l12 -9.021e+02  1.611e+03  -0.560   0.5844  
sale.l12         -1.698e-02  4.296e-01  -0.040   0.9690  
date.l12         -1.176e+04  7.107e+03  -1.654   0.1203  
saving.l13        1.331e+03  2.387e+03   0.558   0.5859  
gdp_deflator.l13  2.295e+03  2.503e+03   0.917   0.3747  
sale.l13         -2.559e-01  3.541e-01  -0.723   0.4817  
date.l13          9.671e+03  6.909e+03   1.400   0.1833  
const            -1.721e+08  3.504e+08  -0.491   0.6310  
trend            -1.535e+06  3.130e+06  -0.490   0.6314  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 6595 on 14 degrees of freedom
Multiple R-Squared: 0.9948, Adjusted R-squared: 0.9751 
F-statistic: 50.47 on 53 and 14 DF,  p-value: 3.505e-10 


Estimation results for equation date: 
===================================== 
date = saving.l1 + gdp_deflator.l1 + sale.l1 + date.l1 + saving.l2 + gdp_deflator.l2 + sale.l2 + date.l2 + saving.l3 + gdp_deflator.l3 + sale.l3 + date.l3 + saving.l4 + gdp_deflator.l4 + sale.l4 + date.l4 + saving.l5 + gdp_deflator.l5 + sale.l5 + date.l5 + saving.l6 + gdp_deflator.l6 + sale.l6 + date.l6 + saving.l7 + gdp_deflator.l7 + sale.l7 + date.l7 + saving.l8 + gdp_deflator.l8 + sale.l8 + date.l8 + saving.l9 + gdp_deflator.l9 + sale.l9 + date.l9 + saving.l10 + gdp_deflator.l10 + sale.l10 + date.l10 + saving.l11 + gdp_deflator.l11 + sale.l11 + date.l11 + saving.l12 + gdp_deflator.l12 + sale.l12 + date.l12 + saving.l13 + gdp_deflator.l13 + sale.l13 + date.l13 + const + trend 

                   Estimate Std. Error t value Pr(&gt;|t|)    
saving.l1         9.351e-02  8.226e-02   1.137  0.27471    
gdp_deflator.l1   1.711e-02  1.005e-01   0.170  0.86728    
sale.l1          -1.142e-05  8.874e-06  -1.287  0.21899    
date.l1           1.523e-02  1.879e-01   0.081  0.93656    
saving.l2        -9.768e-02  7.475e-02  -1.307  0.21237    
gdp_deflator.l2  -1.439e-01  1.012e-01  -1.422  0.17696    
sale.l2           1.466e-05  7.464e-06   1.964  0.06976 .  
date.l2          -4.554e-01  1.833e-01  -2.485  0.02624 *  
saving.l3        -5.419e-02  7.100e-02  -0.763  0.45800    
gdp_deflator.l3   1.575e-01  8.905e-02   1.769  0.09868 .  
sale.l3           4.743e-06  7.641e-06   0.621  0.54474    
date.l3          -2.674e-01  1.934e-01  -1.383  0.18847    
saving.l4         1.874e-01  6.249e-02   2.998  0.00959 ** 
gdp_deflator.l4  -1.150e-01  8.438e-02  -1.363  0.19454    
sale.l4          -5.368e-06  7.656e-06  -0.701  0.49469    
date.l4          -2.522e-01  1.935e-01  -1.304  0.21338    
saving.l5        -9.269e-02  6.961e-02  -1.332  0.20428    
gdp_deflator.l5   3.426e-02  9.257e-02   0.370  0.71686    
sale.l5          -1.229e-06  6.336e-06  -0.194  0.84902    
date.l5          -1.950e-01  1.856e-01  -1.051  0.31127    
saving.l6        -4.992e-03  5.774e-02  -0.086  0.93233    
gdp_deflator.l6   3.084e-02  8.107e-02   0.380  0.70932    
sale.l6          -3.542e-06  6.760e-06  -0.524  0.60848    
date.l6          -6.598e-01  1.870e-01  -3.528  0.00334 ** 
saving.l7        -1.778e-02  6.763e-02  -0.263  0.79650    
gdp_deflator.l7  -1.476e-02  5.753e-02  -0.257  0.80119    
sale.l7           5.976e-07  7.378e-06   0.081  0.93659    
date.l7          -2.933e-01  2.174e-01  -1.349  0.19861    
saving.l8         5.116e-02  9.201e-02   0.556  0.58692    
gdp_deflator.l8  -7.410e-02  5.055e-02  -1.466  0.16480    
sale.l8           1.489e-05  1.247e-05   1.194  0.25226    
date.l8           4.650e-03  2.056e-01   0.023  0.98228    
saving.l9        -1.112e-01  9.265e-02  -1.200  0.25004    
gdp_deflator.l9  -6.423e-02  5.446e-02  -1.179  0.25794    
sale.l9          -6.880e-06  9.556e-06  -0.720  0.48339    
date.l9          -6.280e-01  2.374e-01  -2.646  0.01920 *  
saving.l10        1.487e-01  8.364e-02   1.777  0.09724 .  
gdp_deflator.l10  1.083e-01  4.909e-02   2.206  0.04455 *  
sale.l10         -1.814e-06  9.053e-06  -0.200  0.84405    
date.l10          2.086e-02  2.598e-01   0.080  0.93714    
saving.l11        1.941e-02  7.223e-02   0.269  0.79208    
gdp_deflator.l11  4.475e-02  5.093e-02   0.879  0.39444    
sale.l11         -1.522e-05  1.008e-05  -1.509  0.15343    
date.l11         -8.110e-01  2.237e-01  -3.625  0.00276 ** 
saving.l12       -1.298e-01  7.081e-02  -1.833  0.08822 .  
gdp_deflator.l12 -9.417e-02  4.448e-02  -2.117  0.05267 .  
sale.l12          1.914e-05  1.186e-05   1.614  0.12886    
date.l12         -3.757e-02  1.962e-01  -0.191  0.85092    
saving.l13        6.755e-02  6.589e-02   1.025  0.32267    
gdp_deflator.l13 -3.158e-02  6.910e-02  -0.457  0.65469    
sale.l13         -5.844e-06  9.775e-06  -0.598  0.55952    
date.l13         -6.054e-01  1.907e-01  -3.174  0.00676 ** 
const             5.316e+04  9.675e+03   5.494 7.90e-05 ***
trend             4.716e+02  8.641e+01   5.457 8.44e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.1821 on 14 degrees of freedom
Multiple R-Squared:     1,  Adjusted R-squared:     1 
F-statistic: 1.243e+08 on 53 and 14 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
                 saving gdp_deflator       sale       date
saving          0.40430     -0.02814     -128.6    0.03227
gdp_deflator   -0.02814      0.30155     1527.7    0.02139
sale         -128.63360   1527.68477 43494825.8 -140.74083
date            0.03227      0.02139     -140.7    0.03315

Correlation matrix of residuals:
               saving gdp_deflator     sale    date
saving        1.00000     -0.08061 -0.03067  0.2787
gdp_deflator -0.08061      1.00000  0.42182  0.2139
sale         -0.03067      0.42182  1.00000 -0.1172
date          0.27873      0.21394 -0.11720  1.0000</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(dd3[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)], <span class="at">p=</span><span class="dv">14</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: saving, gdp_deflator, sale, date 
Deterministic variables: both 
Sample size: 67 
Log Likelihood: -468.587 
Roots of the characteristic polynomial:
1.016 1.016 1.009 1.007 1.007 1.005 1.005 1.001 1.001     1     1 0.9992 0.9992 0.9966 0.9966 0.9939 0.9939 0.9908 0.9908 0.9863 0.9863 0.9859 0.9859 0.9855 0.9855 0.9851 0.9851 0.9789 0.9762 0.9762 0.9755 0.9755 0.9669 0.9669 0.9593 0.9593 0.9561 0.9561 0.9555 0.9555 0.9545 0.9545 0.9493 0.9489 0.9489 0.9425 0.9425 0.9253 0.9253 0.9249 0.9249 0.8538 0.8383 0.8383 0.7951 0.5564
Call:
vars::VAR(y = dd3[, c(2:5)], p = 14, type = "both")


Estimation results for equation saving: 
======================================= 
saving = saving.l1 + gdp_deflator.l1 + sale.l1 + date.l1 + saving.l2 + gdp_deflator.l2 + sale.l2 + date.l2 + saving.l3 + gdp_deflator.l3 + sale.l3 + date.l3 + saving.l4 + gdp_deflator.l4 + sale.l4 + date.l4 + saving.l5 + gdp_deflator.l5 + sale.l5 + date.l5 + saving.l6 + gdp_deflator.l6 + sale.l6 + date.l6 + saving.l7 + gdp_deflator.l7 + sale.l7 + date.l7 + saving.l8 + gdp_deflator.l8 + sale.l8 + date.l8 + saving.l9 + gdp_deflator.l9 + sale.l9 + date.l9 + saving.l10 + gdp_deflator.l10 + sale.l10 + date.l10 + saving.l11 + gdp_deflator.l11 + sale.l11 + date.l11 + saving.l12 + gdp_deflator.l12 + sale.l12 + date.l12 + saving.l13 + gdp_deflator.l13 + sale.l13 + date.l13 + saving.l14 + gdp_deflator.l14 + sale.l14 + date.l14 + const + trend 

                   Estimate Std. Error t value Pr(&gt;|t|)  
saving.l1         1.463e-01  2.654e-01   0.551   0.5949  
gdp_deflator.l1   4.820e-01  3.451e-01   1.397   0.1960  
sale.l1           1.220e-05  3.068e-05   0.398   0.7001  
date.l1           7.393e-01  9.500e-01   0.778   0.4564  
saving.l2        -9.046e-02  3.074e-01  -0.294   0.7752  
gdp_deflator.l2  -5.264e-01  3.864e-01  -1.362   0.2062  
sale.l2           8.937e-06  3.454e-05   0.259   0.8017  
date.l2          -2.666e-01  6.697e-01  -0.398   0.6999  
saving.l3        -5.992e-01  3.002e-01  -1.996   0.0771 .
gdp_deflator.l3   2.768e-01  3.652e-01   0.758   0.4678  
sale.l3          -1.071e-05  2.917e-05  -0.367   0.7218  
date.l3           6.780e-01  7.349e-01   0.923   0.3803  
saving.l4         1.815e-01  2.328e-01   0.780   0.4557  
gdp_deflator.l4   5.535e-01  3.862e-01   1.433   0.1855  
sale.l4          -3.200e-05  2.680e-05  -1.194   0.2631  
date.l4          -1.277e+00  6.798e-01  -1.878   0.0931 .
saving.l5         1.830e-01  3.068e-01   0.597   0.5655  
gdp_deflator.l5   3.652e-01  3.758e-01   0.972   0.3566  
sale.l5          -1.319e-05  2.858e-05  -0.461   0.6555  
date.l5          -3.563e-01  7.888e-01  -0.452   0.6622  
saving.l6        -1.334e-01  2.455e-01  -0.543   0.6000  
gdp_deflator.l6   3.820e-01  3.002e-01   1.273   0.2351  
sale.l6           2.371e-07  2.365e-05   0.010   0.9922  
date.l6          -8.171e-01  6.998e-01  -1.168   0.2729  
saving.l7        -6.584e-01  2.305e-01  -2.856   0.0189 *
gdp_deflator.l7   2.827e-01  2.916e-01   0.969   0.3578  
sale.l7          -1.994e-05  2.543e-05  -0.784   0.4531  
date.l7           1.395e+00  9.481e-01   1.472   0.1752  
saving.l8         7.202e-01  3.210e-01   2.244   0.0515 .
gdp_deflator.l8   3.057e-01  1.972e-01   1.550   0.1556  
sale.l8          -3.316e-05  4.185e-05  -0.792   0.4486  
date.l8           5.727e-01  8.882e-01   0.645   0.5352  
saving.l9        -2.317e-01  3.587e-01  -0.646   0.5344  
gdp_deflator.l9   2.613e-01  2.002e-01   1.305   0.2242  
sale.l9          -5.261e-05  4.653e-05  -1.131   0.2874  
date.l9          -1.794e-01  8.084e-01  -0.222   0.8293  
saving.l10       -2.787e-01  3.470e-01  -0.803   0.4425  
gdp_deflator.l10 -1.458e-01  2.135e-01  -0.683   0.5117  
sale.l10          6.185e-06  3.344e-05   0.185   0.8574  
date.l10          1.604e+00  1.151e+00   1.394   0.1968  
saving.l11       -2.069e-02  3.097e-01  -0.067   0.9482  
gdp_deflator.l11  9.249e-03  1.897e-01   0.049   0.9622  
sale.l11          7.680e-05  3.803e-05   2.020   0.0742 .
date.l11         -1.994e+00  8.221e-01  -2.425   0.0383 *
saving.l12        3.251e-01  2.492e-01   1.305   0.2244  
gdp_deflator.l12  2.376e-01  1.676e-01   1.418   0.1900  
sale.l12          2.661e-06  4.714e-05   0.056   0.9562  
date.l12          4.892e-01  1.058e+00   0.463   0.6547  
saving.l13        2.713e-01  2.801e-01   0.969   0.3581  
gdp_deflator.l13  1.783e-01  2.297e-01   0.776   0.4575  
sale.l13         -1.524e-05  4.259e-05  -0.358   0.7287  
date.l13          9.146e-02  7.736e-01   0.118   0.9085  
saving.l14       -2.111e-01  2.352e-01  -0.897   0.3929  
gdp_deflator.l14  5.930e-01  2.528e-01   2.346   0.0436 *
sale.l14          2.412e-05  3.334e-05   0.723   0.4878  
date.l14         -6.787e-01  8.703e-01  -0.780   0.4555  
const            -4.824e+02  5.852e+04  -0.008   0.9936  
trend            -8.263e-02  5.245e+02   0.000   0.9999  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.5664 on 9 degrees of freedom
Multiple R-Squared: 0.9692, Adjusted R-squared: 0.7742 
F-statistic: 4.971 on 57 and 9 DF,  p-value: 0.00691 


Estimation results for equation gdp_deflator: 
============================================= 
gdp_deflator = saving.l1 + gdp_deflator.l1 + sale.l1 + date.l1 + saving.l2 + gdp_deflator.l2 + sale.l2 + date.l2 + saving.l3 + gdp_deflator.l3 + sale.l3 + date.l3 + saving.l4 + gdp_deflator.l4 + sale.l4 + date.l4 + saving.l5 + gdp_deflator.l5 + sale.l5 + date.l5 + saving.l6 + gdp_deflator.l6 + sale.l6 + date.l6 + saving.l7 + gdp_deflator.l7 + sale.l7 + date.l7 + saving.l8 + gdp_deflator.l8 + sale.l8 + date.l8 + saving.l9 + gdp_deflator.l9 + sale.l9 + date.l9 + saving.l10 + gdp_deflator.l10 + sale.l10 + date.l10 + saving.l11 + gdp_deflator.l11 + sale.l11 + date.l11 + saving.l12 + gdp_deflator.l12 + sale.l12 + date.l12 + saving.l13 + gdp_deflator.l13 + sale.l13 + date.l13 + saving.l14 + gdp_deflator.l14 + sale.l14 + date.l14 + const + trend 

                   Estimate Std. Error t value Pr(&gt;|t|)  
saving.l1        -5.310e-01  2.657e-01  -1.998   0.0768 .
gdp_deflator.l1   5.984e-01  3.456e-01   1.731   0.1174  
sale.l1           2.347e-06  3.072e-05   0.076   0.9408  
date.l1           7.860e-03  9.513e-01   0.008   0.9936  
saving.l2         2.042e-01  3.078e-01   0.663   0.5238  
gdp_deflator.l2  -2.973e-01  3.870e-01  -0.768   0.4621  
sale.l2           2.167e-05  3.459e-05   0.627   0.5465  
date.l2          -2.858e-01  6.707e-01  -0.426   0.6800  
saving.l3        -2.568e-01  3.007e-01  -0.854   0.4152  
gdp_deflator.l3   2.612e-01  3.657e-01   0.714   0.4932  
sale.l3           1.394e-05  2.921e-05   0.477   0.6444  
date.l3          -2.505e-02  7.359e-01  -0.034   0.9736  
saving.l4        -2.762e-01  2.331e-01  -1.185   0.2665  
gdp_deflator.l4   2.561e-01  3.867e-01   0.662   0.5244  
sale.l4           4.054e-08  2.684e-05   0.002   0.9988  
date.l4          -2.489e-01  6.808e-01  -0.366   0.7231  
saving.l5         3.847e-02  3.072e-01   0.125   0.9031  
gdp_deflator.l5   1.682e-01  3.764e-01   0.447   0.6655  
sale.l5          -7.211e-05  2.862e-05  -2.520   0.0328 *
date.l5           1.852e-01  7.899e-01   0.234   0.8199  
saving.l6         1.954e-01  2.458e-01   0.795   0.4471  
gdp_deflator.l6   3.326e-01  3.006e-01   1.107   0.2972  
sale.l6           3.402e-05  2.369e-05   1.436   0.1847  
date.l6           2.362e-01  7.008e-01   0.337   0.7438  
saving.l7        -5.999e-01  2.309e-01  -2.598   0.0288 *
gdp_deflator.l7   1.030e-01  2.920e-01   0.353   0.7325  
sale.l7          -6.390e-05  2.547e-05  -2.509   0.0334 *
date.l7          -8.538e-01  9.494e-01  -0.899   0.3919  
saving.l8         1.751e-01  3.214e-01   0.545   0.5991  
gdp_deflator.l8  -1.805e-01  1.975e-01  -0.914   0.3846  
sale.l8           7.564e-05  4.191e-05   1.805   0.1046  
date.l8           1.581e+00  8.895e-01   1.777   0.1093  
saving.l9         6.421e-02  3.592e-01   0.179   0.8621  
gdp_deflator.l9   2.489e-01  2.004e-01   1.242   0.2457  
sale.l9          -7.093e-05  4.660e-05  -1.522   0.1623  
date.l9          -1.109e+00  8.095e-01  -1.370   0.2038  
saving.l10        2.516e-02  3.475e-01   0.072   0.9439  
gdp_deflator.l10  3.055e-01  2.138e-01   1.429   0.1868  
sale.l10         -2.801e-05  3.349e-05  -0.836   0.4246  
date.l10          6.123e-01  1.152e+00   0.531   0.6081  
saving.l11       -2.733e-02  3.101e-01  -0.088   0.9317  
gdp_deflator.l11 -8.317e-02  1.900e-01  -0.438   0.6719  
sale.l11          1.825e-05  3.808e-05   0.479   0.6432  
date.l11          5.851e-01  8.233e-01   0.711   0.4953  
saving.l12       -3.538e-01  2.495e-01  -1.418   0.1899  
gdp_deflator.l12  1.778e-01  1.678e-01   1.059   0.3171  
sale.l12          1.953e-05  4.720e-05   0.414   0.6888  
date.l12         -1.210e+00  1.059e+00  -1.142   0.2828  
saving.l13        2.470e-01  2.805e-01   0.880   0.4015  
gdp_deflator.l13 -3.622e-01  2.300e-01  -1.575   0.1497  
sale.l13          4.599e-05  4.265e-05   1.078   0.3090  
date.l13          6.696e-01  7.747e-01   0.864   0.4099  
saving.l14        2.484e-01  2.356e-01   1.054   0.3192  
gdp_deflator.l14  4.051e-01  2.531e-01   1.600   0.1440  
sale.l14         -1.083e-05  3.339e-05  -0.324   0.7531  
date.l14         -9.017e-02  8.716e-01  -0.103   0.9199  
const            -3.195e+02  5.860e+04  -0.005   0.9958  
trend            -4.929e+00  5.253e+02  -0.009   0.9927  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.5672 on 9 degrees of freedom
Multiple R-Squared: 0.9563, Adjusted R-squared: 0.6792 
F-statistic: 3.452 on 57 and 9 DF,  p-value: 0.02509 


Estimation results for equation sale: 
===================================== 
sale = saving.l1 + gdp_deflator.l1 + sale.l1 + date.l1 + saving.l2 + gdp_deflator.l2 + sale.l2 + date.l2 + saving.l3 + gdp_deflator.l3 + sale.l3 + date.l3 + saving.l4 + gdp_deflator.l4 + sale.l4 + date.l4 + saving.l5 + gdp_deflator.l5 + sale.l5 + date.l5 + saving.l6 + gdp_deflator.l6 + sale.l6 + date.l6 + saving.l7 + gdp_deflator.l7 + sale.l7 + date.l7 + saving.l8 + gdp_deflator.l8 + sale.l8 + date.l8 + saving.l9 + gdp_deflator.l9 + sale.l9 + date.l9 + saving.l10 + gdp_deflator.l10 + sale.l10 + date.l10 + saving.l11 + gdp_deflator.l11 + sale.l11 + date.l11 + saving.l12 + gdp_deflator.l12 + sale.l12 + date.l12 + saving.l13 + gdp_deflator.l13 + sale.l13 + date.l13 + saving.l14 + gdp_deflator.l14 + sale.l14 + date.l14 + const + trend 

                   Estimate Std. Error t value Pr(&gt;|t|)  
saving.l1        -5.784e+03  2.978e+03  -1.942   0.0840 .
gdp_deflator.l1   1.594e+02  3.873e+03   0.041   0.9681  
sale.l1           6.880e-01  3.443e-01   1.998   0.0767 .
date.l1           1.287e+04  1.066e+04   1.208   0.2580  
saving.l2        -2.261e+03  3.450e+03  -0.656   0.5285  
gdp_deflator.l2   1.876e+03  4.337e+03   0.433   0.6755  
sale.l2           6.351e-01  3.876e-01   1.638   0.1357  
date.l2           3.733e+03  7.516e+03   0.497   0.6313  
saving.l3         1.248e+03  3.369e+03   0.370   0.7196  
gdp_deflator.l3  -1.625e+03  4.098e+03  -0.396   0.7010  
sale.l3          -4.350e-02  3.273e-01  -0.133   0.8972  
date.l3           7.415e+03  8.247e+03   0.899   0.3920  
saving.l4        -1.349e+02  2.612e+03  -0.052   0.9599  
gdp_deflator.l4   9.301e+02  4.334e+03   0.215   0.8348  
sale.l4          -4.541e-01  3.008e-01  -1.510   0.1654  
date.l4           1.650e+04  7.629e+03   2.163   0.0588 .
saving.l5        -2.476e+03  3.443e+03  -0.719   0.4902  
gdp_deflator.l5   6.603e+03  4.218e+03   1.565   0.1519  
sale.l5          -5.115e-01  3.207e-01  -1.595   0.1452  
date.l5          -6.944e+03  8.852e+03  -0.784   0.4530  
saving.l6         1.271e+03  2.755e+03   0.461   0.6555  
gdp_deflator.l6   2.518e+03  3.369e+03   0.747   0.4739  
sale.l6           1.281e-01  2.654e-01   0.483   0.6409  
date.l6          -4.265e+02  7.853e+03  -0.054   0.9579  
saving.l7        -3.353e+03  2.587e+03  -1.296   0.2272  
gdp_deflator.l7  -1.840e+03  3.273e+03  -0.562   0.5877  
sale.l7           1.813e-01  2.854e-01   0.635   0.5411  
date.l7           1.409e+04  1.064e+04   1.324   0.2180  
saving.l8        -1.446e+03  3.602e+03  -0.401   0.6975  
gdp_deflator.l8  -1.376e+03  2.214e+03  -0.621   0.5497  
sale.l8           8.313e-02  4.697e-01   0.177   0.8634  
date.l8           9.431e+03  9.968e+03   0.946   0.3688  
saving.l9         4.737e+03  4.025e+03   1.177   0.2695  
gdp_deflator.l9   6.886e+03  2.246e+03   3.066   0.0134 *
sale.l9          -5.729e-01  5.222e-01  -1.097   0.3011  
date.l9           8.875e+03  9.072e+03   0.978   0.3535  
saving.l10        1.197e+03  3.894e+03   0.308   0.7654  
gdp_deflator.l10  1.482e+03  2.396e+03   0.618   0.5516  
sale.l10         -3.825e-01  3.753e-01  -1.019   0.3346  
date.l10          9.854e+03  1.292e+04   0.763   0.4650  
saving.l11       -7.255e+03  3.475e+03  -2.088   0.0664 .
gdp_deflator.l11 -3.763e+03  2.129e+03  -1.767   0.1110  
sale.l11          6.217e-01  4.267e-01   1.457   0.1791  
date.l11          2.048e+02  9.226e+03   0.022   0.9828  
saving.l12        7.267e+02  2.796e+03   0.260   0.8008  
gdp_deflator.l12 -8.956e+02  1.881e+03  -0.476   0.6453  
sale.l12          5.491e-01  5.290e-01   1.038   0.3264  
date.l12         -2.756e+03  1.187e+04  -0.232   0.8216  
saving.l13        5.873e+03  3.144e+03   1.868   0.0946 .
gdp_deflator.l13  2.631e+03  2.577e+03   1.021   0.3339  
sale.l13         -4.564e-01  4.780e-01  -0.955   0.3646  
date.l13          1.527e+04  8.682e+03   1.759   0.1125  
saving.l14       -3.648e+03  2.640e+03  -1.382   0.2003  
gdp_deflator.l14  4.575e+03  2.837e+03   1.613   0.1413  
sale.l14         -2.910e-02  3.742e-01  -0.078   0.9397  
date.l14          1.203e+04  9.767e+03   1.232   0.2493  
const            -1.019e+09  6.567e+08  -1.551   0.1553  
trend            -9.144e+06  5.886e+06  -1.553   0.1547  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 6356 on 9 degrees of freedom
Multiple R-Squared: 0.9968, Adjusted R-squared: 0.9762 
F-statistic: 48.56 on 57 and 9 DF,  p-value: 5.12e-07 


Estimation results for equation date: 
===================================== 
date = saving.l1 + gdp_deflator.l1 + sale.l1 + date.l1 + saving.l2 + gdp_deflator.l2 + sale.l2 + date.l2 + saving.l3 + gdp_deflator.l3 + sale.l3 + date.l3 + saving.l4 + gdp_deflator.l4 + sale.l4 + date.l4 + saving.l5 + gdp_deflator.l5 + sale.l5 + date.l5 + saving.l6 + gdp_deflator.l6 + sale.l6 + date.l6 + saving.l7 + gdp_deflator.l7 + sale.l7 + date.l7 + saving.l8 + gdp_deflator.l8 + sale.l8 + date.l8 + saving.l9 + gdp_deflator.l9 + sale.l9 + date.l9 + saving.l10 + gdp_deflator.l10 + sale.l10 + date.l10 + saving.l11 + gdp_deflator.l11 + sale.l11 + date.l11 + saving.l12 + gdp_deflator.l12 + sale.l12 + date.l12 + saving.l13 + gdp_deflator.l13 + sale.l13 + date.l13 + saving.l14 + gdp_deflator.l14 + sale.l14 + date.l14 + const + trend 

                   Estimate Std. Error t value Pr(&gt;|t|)    
saving.l1         8.299e-02  7.324e-02   1.133 0.286439    
gdp_deflator.l1   1.194e-01  9.525e-02   1.254 0.241473    
sale.l1          -1.590e-05  8.467e-06  -1.878 0.093170 .  
date.l1          -4.492e-01  2.622e-01  -1.713 0.120843    
saving.l2        -7.984e-02  8.484e-02  -0.941 0.371238    
gdp_deflator.l2  -2.103e-01  1.067e-01  -1.972 0.080143 .  
sale.l2           9.861e-06  9.533e-06   1.034 0.327939    
date.l2          -4.547e-01  1.848e-01  -2.460 0.036172 *  
saving.l3        -1.341e-01  8.286e-02  -1.619 0.139954    
gdp_deflator.l3   1.625e-01  1.008e-01   1.612 0.141445    
sale.l3           1.319e-05  8.049e-06   1.638 0.135816    
date.l3          -3.961e-01  2.028e-01  -1.953 0.082614 .  
saving.l4         1.795e-01  6.425e-02   2.794 0.020915 *  
gdp_deflator.l4  -9.927e-02  1.066e-01  -0.931 0.375966    
sale.l4          -5.617e-06  7.398e-06  -0.759 0.467135    
date.l4          -5.027e-01  1.876e-01  -2.679 0.025241 *  
saving.l5        -1.752e-02  8.467e-02  -0.207 0.840662    
gdp_deflator.l5  -4.003e-02  1.037e-01  -0.386 0.708537    
sale.l5          -5.790e-06  7.888e-06  -0.734 0.481610    
date.l5          -2.319e-01  2.177e-01  -1.065 0.314529    
saving.l6        -7.085e-02  6.775e-02  -1.046 0.322971    
gdp_deflator.l6   1.248e-01  8.285e-02   1.506 0.166408    
sale.l6          -2.178e-06  6.528e-06  -0.334 0.746331    
date.l6          -8.145e-01  1.931e-01  -4.217 0.002248 ** 
saving.l7        -1.446e-02  6.363e-02  -0.227 0.825273    
gdp_deflator.l7  -8.114e-03  8.049e-02  -0.101 0.921911    
sale.l7          -2.832e-06  7.019e-06  -0.404 0.695986    
date.l7          -7.434e-01  2.617e-01  -2.841 0.019371 *  
saving.l8         1.013e-01  8.858e-02   1.144 0.282109    
gdp_deflator.l8  -4.556e-02  5.444e-02  -0.837 0.424296    
sale.l8           2.081e-05  1.155e-05   1.801 0.105199    
date.l8          -1.276e-01  2.451e-01  -0.521 0.615182    
saving.l9        -1.781e-01  9.900e-02  -1.799 0.105569    
gdp_deflator.l9  -5.781e-02  5.524e-02  -1.047 0.322605    
sale.l9          -1.051e-05  1.284e-05  -0.818 0.434331    
date.l9          -7.510e-01  2.231e-01  -3.366 0.008311 ** 
saving.l10        1.108e-01  9.577e-02   1.157 0.276891    
gdp_deflator.l10  8.634e-02  5.892e-02   1.465 0.176890    
sale.l10          1.325e-06  9.229e-06   0.144 0.888979    
date.l10         -6.388e-02  3.176e-01  -0.201 0.845087    
saving.l11        7.038e-02  8.547e-02   0.823 0.431554    
gdp_deflator.l11  6.357e-02  5.237e-02   1.214 0.255697    
sale.l11         -1.509e-05  1.050e-05  -1.438 0.184362    
date.l11         -8.454e-01  2.269e-01  -3.726 0.004727 ** 
saving.l12       -1.632e-01  6.878e-02  -2.372 0.041738 *  
gdp_deflator.l12 -8.413e-02  4.625e-02  -1.819 0.102280    
sale.l12          7.241e-06  1.301e-05   0.557 0.591356    
date.l12         -4.219e-01  2.919e-01  -1.445 0.182287    
saving.l13        4.446e-02  7.732e-02   0.575 0.579376    
gdp_deflator.l13 -8.406e-02  6.339e-02  -1.326 0.217429    
sale.l13          1.197e-05  1.176e-05   1.019 0.335032    
date.l13         -6.007e-01  2.135e-01  -2.813 0.020262 *  
saving.l14        5.157e-02  6.493e-02   0.794 0.447430    
gdp_deflator.l14  8.936e-02  6.977e-02   1.281 0.232283    
sale.l14         -1.014e-05  9.203e-06  -1.101 0.299312    
date.l14         -5.418e-01  2.402e-01  -2.255 0.050550 .  
const             8.139e+04  1.615e+04   5.040 0.000700 ***
trend             7.255e+02  1.448e+02   5.011 0.000728 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.1563 on 9 degrees of freedom
Multiple R-Squared:     1,  Adjusted R-squared:     1 
F-statistic: 1.5e+08 on 57 and 9 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
                 saving gdp_deflator       sale      date
saving        3.208e-01     -0.16908 -1.498e+03  0.002709
gdp_deflator -1.691e-01      0.32167  2.226e+03 -0.011232
sale         -1.498e+03   2225.66391  4.040e+07 44.867011
date          2.709e-03     -0.01123  4.487e+01  0.024434

Correlation matrix of residuals:
              saving gdp_deflator     sale     date
saving        1.0000      -0.5264 -0.41625  0.03060
gdp_deflator -0.5264       1.0000  0.61741 -0.12670
sale         -0.4162       0.6174  1.00000  0.04516
date          0.0306      -0.1267  0.04516  1.00000</code></pre>
</div>
</div>
<p>We can see that some models have some variables significant but not all. We will keep the variables and make comparison in the next steps to get the better one.</p>
</section>
<section id="cross-validations-1" class="level2">
<h2 class="anchored" data-anchor-id="cross-validations-1">Cross Validations</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(dd3<span class="sc">$</span>gdp_deflator)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>n<span class="sc">*</span><span class="fl">0.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24.3</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">25</span> <span class="co">#19*4</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>n<span class="sc">-</span>k</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>dd3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   homevalue saving gdp_deflator   sale  date
1   121428.3    5.0          2.7 165300 10957
2   121642.0    4.5          2.5 163200 11048
3   121906.9    4.3          2.4 168800 11139
4   122475.1    4.8          2.2 172900 11231
5   123129.1    4.8          2.6 169800 11323
6   123830.3    4.8          2.4 179000 11413
7   124572.9    5.1          1.6 172500 11504
8   125374.5    5.2          1.3 171100 11596
9   126208.3    4.5          1.3 188700 11688
10  127045.3    4.8          1.4 187200 11778
11  127878.3    4.7          1.9 178100 11869
12  128712.4    4.4          2.3 190100 11961
13  129478.1    4.9          2.0 186000 12053
14  130156.2    5.0          1.4 191800 12143
15  130810.2    5.3          2.3 191900 12234
16  131517.4    5.1          2.5 198800 12326
17  132280.5    4.5          2.9 212700 12418
18  133063.4    4.4          3.3 217600 12509
19  133869.0    5.6          2.6 213500 12600
20  134710.7    6.6          3.1 228800 12692
21  135559.8    7.0          3.2 232500 12784
22  136405.3    3.1          2.9 233700 12874
23  137193.3    3.5          3.7 236400 12965
24  137932.1    3.8          3.3 243600 13057
25  138585.5    5.7          2.8 247700 13149
26  139210.5    5.5          3.6 246300 13239
27  139847.6    5.6          2.8 235600 13330
28  140540.8    5.5          1.5 245400 13422
29  141306.4    6.2          3.9 257400 13514
30  142135.7    6.2          2.7 242200 13604
31  143044.9    5.4          2.1 241800 13695
32  144015.6    5.4          1.7 238400 13787
33  144999.2    5.9          1.4 233900 13879
34  145981.3    5.8          2.0 235300 13970
35  146916.7    5.8          3.1 226500 14061
36  147827.4    5.4          1.0 222500 14153
37  148651.4    5.4         -0.2 208400 14245
38  149440.0    5.3         -0.7 220900 14335
39  150228.1    5.0          0.4 214300 14426
40  151086.1    5.1          1.3 219000 14518
41  152030.1    5.5          1.1 222900 14610
42  153009.4    5.3          2.0 219500 14700
43  154040.0    6.1          1.2 224100 14791
44  155134.6    5.9          2.4 224300 14883
45  156292.9    5.1          2.1 226900 14975
46  157461.6    5.3          2.7 228100 15065
47  158548.5    5.3          2.5 223500 15156
48  159570.5    5.2          0.5 221100 15248
49  160546.3    4.9          2.4 238400 15340
50  161588.7    4.9          1.6 238700 15431
51  162738.7    4.7          2.1 248800 15522
52  164024.4    5.1          2.0 251700 15614
53  165472.1    5.1          1.6 258400 15706
54  167048.8    5.6          1.1 268100 15796
55  168747.7    5.0          1.9 264800 15887
56  170471.2    5.0          2.4 273600 15979
57  172172.7    4.4          1.7 275200 16071
58  173803.4    4.3          2.3 288000 16161
59  175333.8    3.8          1.8 281000 16252
60  176841.6    6.6          0.7 298900 16344
61  178300.5    3.2         -0.1 289200 16436
62  179788.9    2.9          2.2 289100 16526
63  181324.4    3.1          1.2 295800 16617
64  183054.1    2.7          0.0 302500 16709
65  184891.6    3.2         -0.3 299800 16801
66  186816.3    2.6          2.9 306000 16892
67  188755.2    2.1          1.1 303800 16983
68  190716.5    2.6          2.1 310900 17075
69  192645.2    2.7          2.1 313100 17167
70  194471.9    2.9          1.3 318200 17257
71  196139.6    3.2          2.0 320500 17348
72  197646.4    3.1          2.8 337900 17440
73  198936.7    3.7          2.5 331800 17532
74  200135.0    3.9          3.5 315600 17622
75  201342.0    4.1          1.4 330900 17713
76  202638.9    3.8          1.8 322800 17805
77  203918.9    3.6          1.6 313000 17897
78  205047.8    3.7          2.2 322500 17987
79  205932.3    3.1          1.3 318400 18078
80  206612.8    3.3          1.5 327100 18170
81  207058.4    3.2          1.6 329000 18262</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">ts</span>(dd3[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="cross-validation-for-home-value" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-for-home-value">Cross Validation For Home Value</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>err1 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>err2 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k))</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> dat[,<span class="fu">c</span>(<span class="dv">1</span>)][<span class="dv">1</span><span class="sc">:</span>(k<span class="dv">-1</span>)<span class="sc">+</span>i] </span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> dat[,<span class="fu">c</span>(<span class="dv">1</span>)][k<span class="sc">+</span>i] </span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat, <span class="at">p=</span><span class="dv">13</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">=</span> <span class="fu">predict</span>(fit, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat, <span class="at">p=</span><span class="dv">14</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb179-16"><a href="#cb179-16" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb179-17"><a href="#cb179-17" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">=</span> <span class="fu">predict</span>(fit2, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb179-18"><a href="#cb179-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb179-19"><a href="#cb179-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#capture error for each iteration</span></span>
<span id="cb179-20"><a href="#cb179-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This is RMSE</span></span>
<span id="cb179-21"><a href="#cb179-21" aria-hidden="true" tabindex="-1"></a>  err1 <span class="ot">=</span> <span class="fu">c</span>(err1, <span class="fu">sqrt</span>((fcast1<span class="sc">$</span>fcst<span class="sc">$</span>gdp_deflator<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb179-22"><a href="#cb179-22" aria-hidden="true" tabindex="-1"></a>  err2 <span class="ot">=</span> <span class="fu">c</span>(err2, <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>fcst<span class="sc">$</span>gdp_deflator<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb179-23"><a href="#cb179-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-24"><a href="#cb179-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="rmse-plot" class="level4">
<h4 class="anchored" data-anchor-id="rmse-plot">RMSE Plot</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize function</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>normalize <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)))</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize e1 and e2</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>normalized_e1 <span class="ot">&lt;-</span> <span class="fu">normalize</span>(err1)</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>normalized_e2 <span class="ot">&lt;-</span> <span class="fu">normalize</span>(err2)</span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the background color of the plot region to #E0E0E0</span></span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the normalized e1 with a red line</span></span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(normalized_e1<span class="sc">+</span> e, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">ylim=</span><span class="fu">range</span>(<span class="fu">c</span>(normalized_e1, normalized_e2 <span class="sc">+</span> e)), <span class="at">xlab=</span><span class="st">"Index"</span>, <span class="at">ylab=</span><span class="st">"Normalized Values"</span>, <span class="at">main=</span><span class="st">"Normalized RMSE Plot of e1 and e2 For Home Value"</span>)</span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-18"><a href="#cb180-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the normalized e2 with an offset and a blue line</span></span>
<span id="cb180-19"><a href="#cb180-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(normalized_e2 , <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb180-20"><a href="#cb180-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-21"><a href="#cb180-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend to distinguish the lines</span></span>
<span id="cb180-22"><a href="#cb180-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"e1"</span>, <span class="st">"e2"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="rsme-comparesions" class="level4">
<h4 class="anchored" data-anchor-id="rsme-comparesions">RSME Comparesions</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(err1)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> error1[<span class="sc">!</span><span class="fu">is.na</span>(error1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.nan</span>(error1)]</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(error1)</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(err2)</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> error2[<span class="sc">!</span><span class="fu">is.na</span>(error2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.nan</span>(error2)]</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(error2)</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>error1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 170107.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>error2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 170105.8</code></pre>
</div>
</div>
</section>
</section>
<section id="cross-validation-for-saving-rate-1" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-for-saving-rate-1">Cross Validation For Saving Rate</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>err1 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>err2 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k))</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> dat[,<span class="fu">c</span>(<span class="dv">2</span>)][<span class="dv">1</span><span class="sc">:</span>(k<span class="dv">-1</span>)<span class="sc">+</span>i] </span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> dat[,<span class="fu">c</span>(<span class="dv">2</span>)][k<span class="sc">+</span>i] </span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat, <span class="at">p=</span><span class="dv">13</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">=</span> <span class="fu">predict</span>(fit, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat, <span class="at">p=</span><span class="dv">14</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">=</span> <span class="fu">predict</span>(fit2, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb185-18"><a href="#cb185-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-19"><a href="#cb185-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#capture error for each iteration</span></span>
<span id="cb185-20"><a href="#cb185-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This is RMSE</span></span>
<span id="cb185-21"><a href="#cb185-21" aria-hidden="true" tabindex="-1"></a>  err1 <span class="ot">=</span> <span class="fu">c</span>(err1, <span class="fu">sqrt</span>((fcast1<span class="sc">$</span>fcst<span class="sc">$</span>gdp_deflator<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb185-22"><a href="#cb185-22" aria-hidden="true" tabindex="-1"></a>  err2 <span class="ot">=</span> <span class="fu">c</span>(err2, <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>fcst<span class="sc">$</span>gdp_deflator<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb185-23"><a href="#cb185-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-24"><a href="#cb185-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="rmse-plot-1" class="level4">
<h4 class="anchored" data-anchor-id="rmse-plot-1">RMSE PLOT</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize function</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>normalize <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)))</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize e1 and e2</span></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>normalized_e1 <span class="ot">&lt;-</span> <span class="fu">normalize</span>(err1)</span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>normalized_e2 <span class="ot">&lt;-</span> <span class="fu">normalize</span>(err2)</span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the background color of the plot region to #E0E0E0</span></span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the normalized e1 with a red line</span></span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(normalized_e1<span class="sc">+</span> e, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">ylim=</span><span class="fu">range</span>(<span class="fu">c</span>(normalized_e1, normalized_e2 <span class="sc">+</span> e)), <span class="at">xlab=</span><span class="st">"Index"</span>, <span class="at">ylab=</span><span class="st">"Normalized Values"</span>, <span class="at">main=</span><span class="st">"Normalized RMSE Plot of e1 and e2 For Saving Rate"</span>)</span>
<span id="cb186-17"><a href="#cb186-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-18"><a href="#cb186-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the normalized e2 with an offset and a blue line</span></span>
<span id="cb186-19"><a href="#cb186-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(normalized_e2 , <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb186-20"><a href="#cb186-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-21"><a href="#cb186-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend to distinguish the lines</span></span>
<span id="cb186-22"><a href="#cb186-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"e1"</span>, <span class="st">"e2"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="rmse-compares" class="level4">
<h4 class="anchored" data-anchor-id="rmse-compares">RMSE Compares</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(err1)</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> error1[<span class="sc">!</span><span class="fu">is.na</span>(error1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.nan</span>(error1)]</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(error1)</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(err2)</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> error2[<span class="sc">!</span><span class="fu">is.na</span>(error2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.nan</span>(error2)]</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(error2)</span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>error1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.784849</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>error2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.109366</code></pre>
</div>
</div>
</section>
</section>
<section id="cross-validation-for-gdp-deflator-1" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-for-gdp-deflator-1">Cross Validation For GDP Deflator</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>err1 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>err2 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k))</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> dat[,<span class="fu">c</span>(<span class="dv">3</span>)][<span class="dv">1</span><span class="sc">:</span>(k<span class="dv">-1</span>)<span class="sc">+</span>i] </span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> dat[,<span class="fu">c</span>(<span class="dv">3</span>)][k<span class="sc">+</span>i] </span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat, <span class="at">p=</span><span class="dv">13</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">=</span> <span class="fu">predict</span>(fit, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat, <span class="at">p=</span><span class="dv">14</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">=</span> <span class="fu">predict</span>(fit2, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#capture error for each iteration</span></span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This is RMSE</span></span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a>  err1 <span class="ot">=</span> <span class="fu">c</span>(err1, <span class="fu">sqrt</span>((fcast1<span class="sc">$</span>fcst<span class="sc">$</span>gdp_deflator<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb191-22"><a href="#cb191-22" aria-hidden="true" tabindex="-1"></a>  err2 <span class="ot">=</span> <span class="fu">c</span>(err2, <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>fcst<span class="sc">$</span>gdp_deflator<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb191-23"><a href="#cb191-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-24"><a href="#cb191-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="rmse-plots" class="level4">
<h4 class="anchored" data-anchor-id="rmse-plots">RMSE Plots</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize function</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>normalize <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)))</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize e1 and e2</span></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>normalized_e1 <span class="ot">&lt;-</span> <span class="fu">normalize</span>(err1)</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>normalized_e2 <span class="ot">&lt;-</span> <span class="fu">normalize</span>(err2)</span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the background color of the plot region to #E0E0E0</span></span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the normalized e1 with a red line</span></span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(normalized_e1<span class="sc">+</span> e, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">ylim=</span><span class="fu">range</span>(<span class="fu">c</span>(normalized_e1, normalized_e2 <span class="sc">+</span> e)), <span class="at">xlab=</span><span class="st">"Index"</span>, <span class="at">ylab=</span><span class="st">"Normalized Values"</span>, <span class="at">main=</span><span class="st">"Normalized RMSE Plot of e1 and e2 For GDP Deflator"</span>)</span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-18"><a href="#cb192-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the normalized e2 with an offset and a blue line</span></span>
<span id="cb192-19"><a href="#cb192-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(normalized_e2 , <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb192-20"><a href="#cb192-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-21"><a href="#cb192-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend to distinguish the lines</span></span>
<span id="cb192-22"><a href="#cb192-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"e1"</span>, <span class="st">"e2"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="rmse-compares-1" class="level4">
<h4 class="anchored" data-anchor-id="rmse-compares-1">RMSE Compares</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(err1)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> error1[<span class="sc">!</span><span class="fu">is.na</span>(error1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.nan</span>(error1)]</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(error1)</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(err2)</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> error2[<span class="sc">!</span><span class="fu">is.na</span>(error2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.nan</span>(error2)]</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(error2)</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>error1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.594482</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>error2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.038616</code></pre>
</div>
</div>
</section>
</section>
<section id="cross-validation-for-sale-price-1" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-for-sale-price-1">Cross Validation For Sale Price</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>err1 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>err2 <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>k))</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> dat[,<span class="fu">c</span>(<span class="dv">4</span>)][<span class="dv">1</span><span class="sc">:</span>(k<span class="dv">-1</span>)<span class="sc">+</span>i] </span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> dat[,<span class="fu">c</span>(<span class="dv">4</span>)][k<span class="sc">+</span>i] </span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat, <span class="at">p=</span><span class="dv">13</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a>  fcast1 <span class="ot">=</span> <span class="fu">predict</span>(fit, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat, <span class="at">p=</span><span class="dv">14</span>, <span class="at">type=</span><span class="st">'both'</span>)</span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h=</span><span class="dv">4</span>)</span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">=</span> <span class="fu">predict</span>(fit2, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#capture error for each iteration</span></span>
<span id="cb197-20"><a href="#cb197-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This is RMSE</span></span>
<span id="cb197-21"><a href="#cb197-21" aria-hidden="true" tabindex="-1"></a>  err1 <span class="ot">=</span> <span class="fu">c</span>(err1, <span class="fu">sqrt</span>((fcast1<span class="sc">$</span>fcst<span class="sc">$</span>gdp_deflator<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb197-22"><a href="#cb197-22" aria-hidden="true" tabindex="-1"></a>  err2 <span class="ot">=</span> <span class="fu">c</span>(err2, <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>fcst<span class="sc">$</span>gdp_deflator<span class="sc">-</span>xtest)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb197-23"><a href="#cb197-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-24"><a href="#cb197-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="rmse-plots-1" class="level4">
<h4 class="anchored" data-anchor-id="rmse-plots-1">RMSE Plots</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize function</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>normalize <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)))</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize e1 and e2</span></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>normalized_e1 <span class="ot">&lt;-</span> <span class="fu">normalize</span>(err1)</span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>normalized_e2 <span class="ot">&lt;-</span> <span class="fu">normalize</span>(err2)</span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the background color of the plot region to #E0E0E0</span></span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"#E0E0E0"</span>)</span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the normalized e1 with a red line</span></span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(normalized_e1<span class="sc">+</span> e, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">ylim=</span><span class="fu">range</span>(<span class="fu">c</span>(normalized_e1, normalized_e2 <span class="sc">+</span> e)), <span class="at">xlab=</span><span class="st">"Index"</span>, <span class="at">ylab=</span><span class="st">"Normalized Values"</span>, <span class="at">main=</span><span class="st">"Normalized RMSE Plot of e1 and e2 For Sale Price"</span>)</span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the normalized e2 with an offset and a blue line</span></span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(normalized_e2 , <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend to distinguish the lines</span></span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"e1"</span>, <span class="st">"e2"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="rmse-values-compares" class="level4">
<h4 class="anchored" data-anchor-id="rmse-values-compares">RMSE Values Compares</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(err1)</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> error1[<span class="sc">!</span><span class="fu">is.na</span>(error1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.nan</span>(error1)]</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>error1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(error1)</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(err2)</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> error2[<span class="sc">!</span><span class="fu">is.na</span>(error2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.nan</span>(error2)]</span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>error2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(error2)</span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>error1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 268955.8</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>error2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 268954.3</code></pre>
</div>
</div>
<p>The second one VAR(14) is better for Home Value and Sale Price, However, overall, not too different The first one VAR(13) is better for GDP Deflator and Saving Rate Therefore, VAR(13) is relatively better than VAR(14)</p>
</section>
</section>
</section>
<section id="forecasts" class="level2">
<h2 class="anchored" data-anchor-id="forecasts">Forecasts</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(dat[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">p=</span><span class="dv">13</span>, <span class="at">type=</span><span class="st">"const"</span>)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>fcast1 <span class="ot">=</span> <span class="fu">predict</span>(fit1, <span class="at">n.ahead =</span> <span class="dv">8</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>fcast1<span class="sc">$</span>fcst<span class="sc">$</span>gdp_deflator</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         fcst     lower    upper       CI
[1,] 3.718453 2.6102444 4.826661 1.108208
[2,] 5.602610 4.4620373 6.743183 1.140573
[3,] 7.872473 6.4972147 9.247731 1.375258
[4,] 4.592520 3.0702843 6.114757 1.522236
[5,] 5.953920 4.3310094 7.576831 1.622911
[6,] 2.901753 0.8499155 4.953590 2.051837
[7,] 4.187176 2.0589012 6.315450 2.128275
[8,] 2.717952 0.3920197 5.043885 2.325933</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>fcast1<span class="sc">$</span>fcst<span class="sc">$</span>sale</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         fcst    lower    upper       CI
[1,] 348102.2 336133.1 360071.2 11969.06
[2,] 353458.9 339669.3 367248.4 13789.55
[3,] 350327.6 336109.4 364545.8 14218.21
[4,] 321335.8 304967.9 337703.7 16367.93
[5,] 309302.3 291867.5 326737.0 17434.72
[6,] 286105.4 268004.7 304206.1 18100.70
[7,] 271981.5 253762.0 290200.9 18219.43
[8,] 248976.4 229541.9 268410.9 19434.55</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>fcast1<span class="sc">$</span>fcst<span class="sc">$</span>saving</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          fcst     lower     upper       CI
[1,]  3.774885  2.665978  4.883793 1.108907
[2,]  4.885199  3.206902  6.563496 1.678297
[3,]  9.928629  8.142069 11.715188 1.786559
[4,] 10.166946  8.366419 11.967473 1.800527
[5,] 12.688735 10.877602 14.499869 1.811134
[6,] 10.564305  8.658945 12.469664 1.905360
[7,]  9.590800  7.567340 11.614261 2.023461
[8,]  8.682248  6.444347 10.920149 2.237901</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>fcast1<span class="sc">$</span>fcst<span class="sc">$</span>homevalue</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         fcst    lower    upper         CI
[1,] 207370.9 207313.3 207428.5   57.61206
[2,] 207451.6 207280.8 207622.4  170.81360
[3,] 207354.1 206979.7 207728.4  374.33551
[4,] 207004.8 206375.3 207634.3  629.46283
[5,] 206534.7 205611.8 207457.5  922.84057
[6,] 206003.4 204767.3 207239.5 1236.10298
[7,] 205538.6 203971.4 207105.8 1567.18724
[8,] 205002.0 203098.4 206905.6 1903.59212</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>fcast1<span class="sc">$</span>fcst<span class="sc">$</span>sale</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         fcst    lower    upper       CI
[1,] 348102.2 336133.1 360071.2 11969.06
[2,] 353458.9 339669.3 367248.4 13789.55
[3,] 350327.6 336109.4 364545.8 14218.21
[4,] 321335.8 304967.9 337703.7 16367.93
[5,] 309302.3 291867.5 326737.0 17434.72
[6,] 286105.4 268004.7 304206.1 18100.70
[7,] 271981.5 253762.0 290200.9 18219.43
[8,] 248976.4 229541.9 268410.9 19434.55</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">forecast</span>(fit1,<span class="dv">48</span>) <span class="sc">%&gt;%</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ASV_files/figure-html/unnamed-chunk-123-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>