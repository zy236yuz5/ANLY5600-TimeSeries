{"title":"Exploratory Data Analysis","markdown":{"yaml":{"title":"Exploratory Data Analysis","navbar":{"left":["about.qmd","Introduction.qmd","DataSources.qmd","DataVis.qmd","EDA.qmd","ARModels.qmd","ASV.qmd","SAF.qmd","GARCH.qmd","TS.qmd","conclusion.qmd","dv.qmd"]},"format":{"html":{"theme":"sandstone","css":"./styles/layout.css","code-fold":true,"toc":true}}},"headingText":"The Household Income Data Analysis","containsRefs":false,"markdown":"\n\n\nFor Exploratory Data Analysis (EDA), we aim to have a deeper understanding of the time series data. This section involves multiple medthods and datasets for us to gain insights and understandings such as decompositions, lag plots, ACF, PACF, ADF tests, detrending, and others. For these methods, we are going to identify correlations, trends, seasonalities, and stationaries. Which can help us to make analysis and apply models in later sections. To be more specific, the lag plots and decomposing methods will allow us to discover dependencies and components. ACF and PACF can help us see the correlations and stationary, and the Augmented Dickey-Fuller Test to empirically probe its stationarity. \n\n\nAs we did in previous section, we start with the household income. In here, we have a basic look about the household income time series.\n\n```{r, echo = FALSE, message = FALSE, warning = FALSE}\nlibrary(reticulate)\nlibrary(ggplot2)\nlibrary(forecast)\nlibrary(astsa) \nlibrary(xts)\nlibrary(tseries)\nlibrary(fpp2)\nlibrary(fma)\nlibrary(lubridate)\nlibrary(tidyverse)\nlibrary(TSstudio)\nlibrary(quantmod)\nlibrary(tidyquant)\nlibrary(plotly)\nlibrary(ggplot2)\nlibrary(lubridate)\n```\n\n```{r, echo=FALSE, results='hide',warning=FALSE,message=FALSE}\ndf <- read.csv(\"../Dataset/project/household_saving.csv\")\ndf$DATE <- as.Date(df$DATE)\n\n```\n\n```{r,warning=FALSE,echo=FALSE}\nlibrary(ggplot2)\n\n\nggplot(data = df, aes(x = DATE, y = W398RC1A027NBEA)) +\n  geom_line(color = \"DarkViolet\") +\n  labs(title = \"Time Series Plot of Household Income\",\n       x = \"Date\", \n       y = \"The Household Income\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n\n```\n\nFrom the plot, we can visually inspect:\nTrend: There is clearly positive trend.\nSeasonality: It seems that it does not contain patterns.\nVariation: Fluctuations in the data exists.\nPeriodic fluctuations: The fluctuations are randomly presented.\nmultiplicative or additive： Only based on the timeseries plot, I think this follows multiplicative, because it has varying amplitude/frequency.\n\n<br>\n<br>\n\nThen, we want to see if there is any correlations. By utilizing lag plot, we can see if there are any correlations present:\n\n### LAG Plot\n```{r,warning=FALSE,echo=FALSE}\n# Lag plot\nlagged_data <- data.frame(value = df$W398RC1A027NBEA[-1],\n                          lagged_value = df$W398RC1A027NBEA[-length(df$W398RC1A027NBEA)])\n\n# Enhanced Lag Plot\nggplot(data = lagged_data, aes(x = lagged_value, y = value)) +\n  geom_point(color = \"DarkViolet\", alpha = 0.5) +\n  labs(title = \"Lag Plot\",\n       x = \"Value at t-1\",\n       y = \"Value at t\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n\n\n```\n\n\nBased on the lag plot, there's a positive correlation since the points cluster along a diagonal line from bottom-left to top-right. This shows linearity. However, it could also mean that the dataset is not stationary.\n\nIn order to determine if the dataset is stationary. we should use other methods as well. Before doing that, we should first check the trend, seasonality through decompositions.\n\n### Decomposition\n```{r, echo=FALSE}\n#library(ggfortify)\n\n# Decomposition using ggplot2 styling\ndecomposed <- decompose(ts(df$W398RC1A027NBEA, frequency=12), type = \"additive\")\nautoplot(decomposed) + \n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\n\nNow, based on the decomposition plot, we can see that it is correct that the data follows an upwarding trend. However, it seems that there is seasonal pattern involves with flutuations. In addition, it has varying amplitude/frequency. Therefore, I think this follows multiplicative.\n\nThen, we should utilize ACF and PACF to see about the correlation and stationary.\n\n### ACF & PACF\n```{r, echo=FALSE}\nlibrary(forecast)\n\n# ACF Plot\nggAcf(df$W398RC1A027NBEA) +\n  labs(title = \"ACF of Household Income Time Series\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n# PACF Plot\nggPacf(df$W398RC1A027NBEA) +\n  labs(title = \"PACF of Household Income Time Series\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\nFrom here, we can see that the dataset has a correlation, which also means that it is not stationary. In order to prove this conclusion, we utilize the adf test to ensure the results are the same.\n\n\n### Validation with ADF Test\n```{r, echo=FALSE}\nlibrary(tseries)\nadf.test(df$W398RC1A027NBEA)\n\n\n```\n\nBased on the result, we can see that the p-value is greater than the thershold value, this means that we fail to reject the Null hypothesis. The time series dataset is not stationary.\n\nThen, to explore more, we utilize detrended and log-transformation to see about the patterns\n\n\n### Detrended and Log-transformed\n```{r, echo=FALSE}\ndetrended_data <- data.frame(Date = df$DATE[-1], Detrended = diff(df$W398RC1A027NBEA))\n\n# Enhanced Detrended Plot\nggplot(data = detrended_data, aes(x = Date, y = Detrended)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Detrended Household Income Time Series\",\n       x = \"Date\",\n       y = \"Detrended Value\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\n\n```{r,warning=FALSE, echo=FALSE}\nlog_transformed_data <- data.frame(Date = df$DATE, LogTransformed = log(df$W398RC1A027NBEA))\n\n# Enhanced Log-transformed Plot with Custom Background\nggplot(data = log_transformed_data, aes(x = Date, y = LogTransformed)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Log-transformed Time Series of Household Income\",\n       x = \"Date\",\n       y = \"Log-transformed Value\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\nFrom here, we can see that after detrending and dfferencing, the household income remains fluctuations espectially during 2020 period, which could be the cause of the Covid-19. In addition, Log-transformed time series, in order to remove the hetroscadastisity, we can see that the trend remains. I think the reason is possibly because log-transformation can assuage issues related to non-constant variance, which means that the inherent trend within the data may persist.\n\n### Make it Stationary by using differencing\n```{r}\ndiff_series <- diff(df$W398RC1A027NBEA)\n\n# Plotting the differenced series\nggplot(data = data.frame(Date = df$DATE[-1], Diff = diff_series), aes(x = Date, y = Diff)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Differenced Household Income Time Series\",\n       x = \"Date\",\n       y = \"Differenced Value\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n# ACF Plot for differenced series\nggAcf(diff_series) +\n  labs(title = \"ACF of Differenced Household Income Time Series\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\nFrom here, we can see that after detrending and dfferencing has succeeded in making the datasets stationary: spikes all fall within the blue shaded confidence intervals, which represent the region where correlations are not statistically significant.\n\n\n### Moving Average\n\n<iframe src=\"./image/EDA/income.html\" width=\"840\" height=\"600\"></iframe>\n\nThe graph plots the Household Income from 1995 to 2020.\nThe blue line represents the original data.\nMA(2), MA(4), and MA(8) are the moving averages taken over 2, 4, and 8 periods respectively. As the period of the moving average increases, the smoothed line becomes less responsive to short-term fluctuations.\n\n## The Median House Sale Price Data Analysis\n\nSince our key is to discover the impact of the income and house price, we certainly need to make analysis for the sale price data. \n\n### The Time Series\n```{r, echo=FALSE, results='hide',warning=FALSE,message=FALSE}\ndf <- read.csv(\"../Dataset/project/MSPUS.csv\")\ndf$DATE <- as.Date(df$DATE)\n```\n\n\n\n```{r,warning=FALSE,echo=FALSE}\nlibrary(ggplot2)\n\n\nggplot(data = df, aes(x = DATE, y = MSPUS)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Time Series Plot of Median Sale Price\",\n       x = \"Date\", \n       y = \"The Sale Price\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n\n```\n\nFrom the plot, the results are the same with the previous section. It has an upwarding trend. \n\nTo be more specific, from the plot, we can visually inspect:\nTrend: There is clearly positive trend.\nSeasonality: It seems that it does not contain patterns.\nVariation: Fluctuations in the data exists but not too much.\nPeriodic fluctuations: The fluctuations are presented in 2010 and 2021.\nmultiplicative or additive： Only based on the timeseries plot, I think this follows additive, because it does not have too much variance.\n\n\nThen, we want to see if there is any correlations. By utilizing lag plot, we can see if there are any correlations present:\n\n\n### Lag Plots\n```{r,warning=FALSE,echo=FALSE}\n# Lag plot\nlagged_data <- data.frame(value = df$MSPUS[-1],\n                          lagged_value = df$MSPUS[-length(df$MSPUS)])\n\n# Enhanced Lag Plot\nggplot(data = lagged_data, aes(x = lagged_value, y = value)) +\n  geom_point(color = \"blue\", alpha = 0.5) +\n  labs(title = \"Lag Plot\",\n       x = \"Value at t-1\",\n       y = \"Value at t\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n\n\n```\n\nBased on the lag plot, there's a positive correlation since the points cluster along a diagonal line from bottom-left to top-right. In addition, this aligns with the same conclusion and it has a strong positive correlation. This shows linearity. \n\n### Decomposition for the data\n```{r, echo=FALSE}\n#library(ggfortify)\n\n# Decomposition using ggplot2 styling\ndecomposed <- decompose(ts(df$MSPUS, frequency=12), type = \"additive\")\nautoplot(decomposed) + \n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\nNow, based on the decomposition plot, we can see that it is correct that the data follows an upwarding trend.  In addition, it has roughly constant amplitude/frequency. Therefore, I think this follows additive.\n\nThen, we should utilize ACF and PACF to see about the correlation and stationary.\n\n### ACF and PACF of the data\n```{r, echo=FALSE}\nlibrary(forecast)\n\n# ACF Plot\nggAcf(df$MSPUS) +\n  labs(title = \"ACF of Median Sale Price Time Series\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n# PACF Plot\nggPacf(df$MSPUS) +\n  labs(title = \"PACF of Median Sale Price Time Series\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\nFrom here, we can see that the dataset has a correlation, which also means that it is not stationary. In order to prove this conclusion, we utilize the adf test to ensure the results are the same.\n\n### ADF Test\n```{r, echo=FALSE}\nlibrary(tseries)\nadf.test(df$MSPUS)\n\n\n```\n\nBased on the result, we can see that the p-value is greater than the thershold value, this means that we fail to reject the Null hypothesis. The time series dataset is not stationary.\n\nThen, to explore more, we utilize detrended and log-transformation to see about the patterns\n\n### Detrended and Log transformation\n```{r, echo=FALSE}\ndetrended_data <- data.frame(Date = df$DATE[-1], Detrended = diff(df$MSPUS))\n\n# Enhanced Detrended Plot\nggplot(data = detrended_data, aes(x = Date, y = Detrended)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Detrended Median Sale Price Time Series\",\n       x = \"Date\",\n       y = \"Detrended Value\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\n\n\n```{r,warning=FALSE, echo=FALSE}\nlog_transformed_data <- data.frame(Date = df$DATE, LogTransformed = log(df$MSPUS))\n\n# Enhanced Log-transformed Plot with Custom Background\nggplot(data = log_transformed_data, aes(x = Date, y = LogTransformed)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Log-transformed Time Series of Median Sale Price\",\n       x = \"Date\",\n       y = \"Log-transformed Value\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\nFrom here, we can see that after detrending, the sale prices remains fluctuations espectially from 2000 to 2020 period. In addition, Log-transformed time series, in order to remove the hetroscadastisity, we can see that the trend remains. I think the reason is possibly because log-transformation can assuage issues related to non-constant variance, which means that the inherent trend within the data may persist.\n\n### Make it Stationary by using differencing\n```{r}\ndiff_series <- diff(df$MSPUS)\n\n# Plotting the differenced series\nggplot(data = data.frame(Date = df$DATE[-1], Diff = diff_series), aes(x = Date, y = Diff)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Differenced Sale Price Time Series\",\n       x = \"Date\",\n       y = \"Differenced Value\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n# ACF Plot for differenced series\nggAcf(diff_series) +\n  labs(title = \"ACF of Differenced Sale Price Time Series\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\nFrom here, we can see that after detrending and dfferencing has succeeded in making the datasets stationary: Most of the spikes fall within the blue shaded confidence intervals, which means that the dataset is stationary now compared to the orginal one.\n\n### Moving Average\n\n<iframe src=\"./image/EDA/HSP.html\" width=\"840\" height=\"600\"></iframe>\n\n\nThe graph shows the House Sale Price from 1970 to 2020.\nThe blue line represents the original data.\nMA(2), MA(8), and MA(16) depict the moving averages over 2, 8, and 16 periods respectively. The smoothed lines show the underlying trend of house sale prices over time. The higher the period of the moving average, the smoother the line, which can help in understanding long-term trends.\n\n## The Housing Affordability Index Data Analysis\n\nThen, after we have a basic understanding about the income and sale price. We need to dive into the impact. We utilize the housing affordability index to see the impact of the income and sale price. Let us firt explore the houseing affordability index first.\n\n### Time Series Plot for Housing Affordability Index\n```{r, echo=FALSE, results='hide',warning=FALSE,message=FALSE}\ndf <- read.csv(\"../Dataset/project/PSAVERT.csv\")\ndf$DATE <- as.Date(df$DATE)\n\n```\n\n```{r,warning=FALSE}\nlibrary(ggplot2)\n\n\nggplot(data = df, aes(x = DATE, y = PSAVERT)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Time Series Plot of Housing Affordability Index\",\n       x = \"Date\", \n       y = \"The Housing Affordability Index\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n\n```\n\nFrom the plot, we can visually inspect:\nTrend: It seems that it did not have a consistent trend. From 1960 to 1970, it has upwarding trend. But then it has dewarding trend. And has a huge fluctuations during 2020, Covid period.\nSeasonality: I think there are small patterns that show seasonality in dataset.\nVariation: Fluctuations in the data exist.\nPeriodic fluctuations: Spikes or drops at consistent intervals exist.\nMultiplicative or additive: I think the dataset could follow an additive pattern. Because it seems that it has constant amplitude and frequency although with some fluctuations. In order to prove these, we need to explore more using different methods.\n\n### Lag Plot for Houseing Affordability\n```{r}\n# Lag plot\nlagged_data <- data.frame(value = df$PSAVERT[-1],\n                          lagged_value = df$PSAVERT[-length(df$PSAVERT)])\n\n# Enhanced Lag Plot\nggplot(data = lagged_data, aes(x = lagged_value, y = value)) +\n  geom_point(color = \"blue\", alpha = 0.5) +\n  labs(title = \"Lag Plot\",\n       x = \"Value at t-1\",\n       y = \"Value at t\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n\n\n```\n\nBased on the lag plot, there's a positive correlation since the points cluster along a diagonal line from bottom-left to top-right. This shows linearity. However, it could also mean that the dataset is not stationary.\n\nIn order to determine if the dataset is stationary. we should use other methods as well. Before doing that, we should first check the trend, seasonality through decompositions.\n\n### Decomposition of the Housing Affordability\n```{r}\n#library(ggfortify)\n\n# Decomposition using ggplot2 styling\ndecomposed <- decompose(ts(df$PSAVERT, frequency=12), type = \"additive\")\nautoplot(decomposed) + \n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\nNow, based on the decomposition plot, we can see that it is correct that the data did not follow a specific trend. However, it seems that there is seasonal pattern involves with flutuations. In addition, mostly it has constant amplitude/frequency. Therefore, I think this follows additive pattern.\n\nThen, we should utilize ACF and PACF to see about the correlation and stationary.\n\n\n### ACF and PACF Analysis\n```{r}\nlibrary(forecast)\n\n# ACF Plot\nggAcf(df$PSAVERT) +\n  labs(title = \"ACF of Housing Affordability Index Time Series\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n# PACF Plot\nggPacf(df$PSAVERT) +\n  labs(title = \"PACF of Housing Affordability Index Time Series\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\nThe ACF plot can help determine if the series is stationary. From here, we can see that the dataset has a correlation, and it is decaying slowly which also means that it is not stationary. In order to prove this conclusion, we utilize the adf test to ensure the results are the same. \n\n### ADF Test\n```{r}\nlibrary(tseries)\nadf.test(df$PSAVERT)\n\n\n```\n\nBased on the ADF test, since the p-value is smaller than the threshold value, we should reject the null hypothesis, which means that the dataset is stationary! However, the value is close to 0.05. In addition, the ADF test is not as reliable as the ACF test. Therefore, since the ACF decays slowly, and it showed strong correlation. This means that, the dataset is not stationary.\n\n\n### Detrened and Log-transformation\nThen, to explore more, we utilize detrended and log-transformation to see about the patterns\n\n\n```{r}\ndetrended_data <- data.frame(Date = df$DATE[-1], Detrended = diff(df$PSAVERT))\n\n# Enhanced Detrended Plot\nggplot(data = detrended_data, aes(x = Date, y = Detrended)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Detrended Time Series\",\n       x = \"Date\",\n       y = \"Detrended Value\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\n\n```{r,warning=FALSE}\nlog_transformed_data <- data.frame(Date = df$DATE, LogTransformed = log(df$PSAVERT))\n\n# Enhanced Log-transformed Plot with Custom Background\nggplot(data = log_transformed_data, aes(x = Date, y = LogTransformed)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Log-transformed Time Series of Housing Affordability Index\",\n       x = \"Date\",\n       y = \"Log-transformed Value\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\nFrom here, we can see that after detrending, the household income remains fluctuations espectially during 2020 period, which could be the cause of the Covid-19. In addition, Log-transformed time series, in order to remove the hetroscadastisity, we can see that the trend remains. I think the reason is possibly because log-transformation can assuage issues related to non-constant variance, which means that the inherent trend within the data may persist.\n\n### ENsure it Stationary by using differencing\n```{r}\ndiff_series <- diff(df$PSAVERT)\n\n# Plotting the differenced series\nggplot(data = data.frame(Date = df$DATE[-1], Diff = diff_series), aes(x = Date, y = Diff)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Differenced Housing Affordability IndexTime Series\",\n       x = \"Date\",\n       y = \"Differenced Value\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n# ACF Plot for differenced series\nggAcf(diff_series) +\n  labs(title = \"ACF of Differenced Housing Affordability Index Time Series\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\nFrom here, we can see that after detrending and dfferencing has succeeded in making the datasets stationary: Most of the spikes fall within the blue shaded confidence intervals, which means that the dataset is stationary now compared to the orginal one.\n\n### Moving Average\n\n<iframe src=\"./image/EDA/idex.html\" width=\"840\" height=\"600\"></iframe>\n\n\nThis graph presents the Housing Affordability Index from 1960 to 2020.\nThe blue line is the original data.\nMA(2), MA(10), and MA(20) represent moving averages over 2, 10, and 20 periods. The plot illustrates how housing affordability has changed over time, and the smoothed lines can help identify broader trends or shifts in the data.\n\n## The GDP Exploratory Data Analysis\n\nThen, after making analysis for income, sale price, and houseing affordability. We should have a look at for analyzing the GDP, which can represent the economy as a whole. By analyzing the GDP data, we can have a more generalized view and gain more insights about the patterns, seasonalities, and stationaries.\n\n### Time Series Plot of GDP\n```{r, echo = FALSE}\ndf <- read.csv(\"../Dataset/project/A191RI1Q225SBEA.csv\")\ndf$DATE <- as.Date(df$DATE)\n```\n```{r, echo = FALSE,warning=FALSE}\nlibrary(ggplot2)\n\n\nggplot(data = df, aes(x = DATE, y = A191RI1Q225SBEA)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Time Series Plot of GDP\",\n       x = \"Date\", \n       y = \"Percent Change from Preceding Period\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n\n```\n\nFrom the plot, we can visually inspect:\nTrend: It seems that it did not have a consistent trend. From 1960 to 1980, it has upwarding trend. But then it has dewarding trend. And has a huge fluctuations during 2020, Covid period. Which is similar to the houseing affordability index. I think we can see that there is a positive correlation between GDP and housing affordability index. When GDP gets higher, people can afford a house more easily.\nSeasonality: I think there are small patterns that show seasonality in dataset.\nVariation: Fluctuations in the data exist.\nPeriodic fluctuations: Spikes or drops at consistent intervals exist.\nMultiplicative or additive: I think the dataset could follow a multiplicative pattern. Because it seems that it does not have constant amplitude and frequency. In order to prove these, we need to explore more using different methods.\n\n### Lag for GDP\n```{r, echo = FALSE}\n# Lag plot\nlagged_data <- data.frame(value = df$A191RI1Q225SBEA[-1],\n                          lagged_value = df$A191RI1Q225SBEA[-length(df$A191RI1Q225SBEA)])\n\n# Enhanced Lag Plot\nggplot(data = lagged_data, aes(x = lagged_value, y = value)) +\n  geom_point(color = \"blue\", alpha = 0.5) +\n  labs(title = \"Lag Plot\",\n       x = \"Value at t-1\",\n       y = \"Value at t\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n```\n\nBased on the lag plot, there's a correlation but not too strong. This shows potential linearity. However, it could also mean that the dataset is not stationary but we can not decide yet.\n\nIn order to determine if the dataset is stationary. we should use other methods as well. Before doing that, we should first check the trend, seasonality through decompositions.\n\n### Decomposition of the Data\n```{r, echo = FALSE}\n\n# Decomposition using ggplot2 styling\ndecomposed <- decompose(ts(df$A191RI1Q225SBEA, frequency=12), type = \"multiplicative\")\nautoplot(decomposed) + \n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n```\n\nNow, based on the decomposition plot, we can see that it is correct that the data did not follow a specific trend. However, it seems that there is seasonal pattern involves with flutuations. In addition, it has almost constant amplitude/frequency. Therefore, I think this follows multiplicative.\n\nThen, we should utilize ACF and PACF to see about the correlation and stationary.\n\n### ACF and PACF\n```{r, echo = FALSE}\nlibrary(forecast)\n\n# ACF Plot\nggAcf(df$A191RI1Q225SBEA) +\n  labs(title = \"ACF of GDP Time Series\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n# PACF Plot\nggPacf(df$A191RI1Q225SBEA) +\n  labs(title = \"PACF of GDP Time Series\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\nFrom here, we can see that the acf decays very quickly, which also means that it is stationary. In order to prove this conclusion, we utilize the adf test to ensure the results are the same.\n\n```{r, echo = FALSE}\nlibrary(tseries)\nadf.test(df$A191RI1Q225SBEA)\n```\n\nBased on the result, we can see that the p-value is smaller than the thershold value, this means that we reject the Null hypothesis. The time series dataset is stationary.\n\nThen, to explore more, we utilize detrended and log-transformation to see about the patterns\n\n### Detrended and Log-transformation\n```{r, echo = FALSE}\ndetrended_data <- data.frame(Date = df$DATE[-1], Detrended = diff(df$A191RI1Q225SBEA))\n\n# Enhanced Detrended Plot\nggplot(data = detrended_data, aes(x = Date, y = Detrended)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Detrended Time Series\",\n       x = \"Date\",\n       y = \"Detrended Value\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\n\n```{r, warning=FALSE, echo = FALSE}\nlog_transformed_data <- data.frame(Date = df$DATE, LogTransformed = log(df$A191RI1Q225SBEA))\n\n# Enhanced Log-transformed Plot with Custom Background\nggplot(data = log_transformed_data, aes(x = Date, y = LogTransformed)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Log-transformed Time Series of GDP\",\n       x = \"Date\",\n       y = \"Log-transformed Value\") +\n  theme_minimal() +\n  theme(panel.background = element_rect(fill = \"#E0E0E0\"),\n        panel.grid.major = element_line(color = \"grey\", size = 0.1),\n        panel.grid.minor = element_line(color = \"grey\", size = 0.05),\n        plot.background = element_rect(fill = \"#E0E0E0\"))\n\n```\n\nSince, the original dataset is already stationary. Therefore, no further action is needed to make it stationary. The detrend and log transformation is just to explore the dataset.\n\n### Moving Average\n\n<iframe src=\"./image/EDA/gdpma.html\" width=\"840\" height=\"600\"></iframe>\n\n\nThe \"Original\" line shows the raw GDP changes.\nThe MA(5), MA(20), and MA(50) represent moving averages with windows of 5, 20, and 50 time units, respectively. It's clear that as the window size increases, the smoothed line becomes less responsive to short-term fluctuations.\n\n## The Sale Price Disparity Analysis\n\nLastly, after analyzing the corresponding numeric datasets, we will explore more about the disparitis by using the Mean Sale price datasets which involves with different regions and states. From here, by making analysis on the pattern and seasonality, it can help us provide with more insights and knowledge in determining the impact of the disparities of the income and sale prices.\n\n### Time Series Decomposition Plot\n```{python, echo=FALSE}\nimport  pandas  as  pd\n\nimport matplotlib.pyplot as plt\nimport altair as alt\nimport warnings\nwarnings.filterwarnings('ignore')\n\n```\n\n\n```{python, echo=FALSE}\n# directory containing the CSV files\n\npath2 = '../Dataset/project/Merged_downsample.csv'\n\ndf_selected = pd.read_csv(path2)\nplt.rcParams.update(plt.rcParamsDefault)\nimport matplotlib as mpl\n\n# Set global figure settings\nmpl.rcParams['figure.facecolor'] = '#E0E0E0'\nmpl.rcParams['axes.facecolor'] = '#E0E0E0'\nmpl.rcParams['savefig.facecolor'] = '#E0E0E0'\nwarnings.filterwarnings('ignore')\n```\n\n\n```{python,echo=FALSE}\nfrom statsmodels.tsa.seasonal import seasonal_decompose\n\n# Decomposing\nresult = seasonal_decompose(df_selected['Mean Sale Price'].values, model='additive', period=12)\nfig = result.plot()\nfig.set_facecolor('#E0E0E0')\nplt.show()\n\nwarnings.filterwarnings('ignore')\n```\n\nFrom the decomposition plot, we can visually inspect:\nTrend: There is no clear trend.\nSeasonality: It seems that it has seasonal patterns.\nVariation: Fluctuations in the data exists.\nPeriodic fluctuations: The fluctuations are randomly presented.\nmultiplicative or additive： I think this follows multiplicative, because it has varying amplitude/frequency.\n\nThen, we want to see if there is any correlations. By utilizing lag plot, we can see if there are any correlations present:\n\n### Lag Plot \n```{python, echo=FALSE}\nfrom pandas.plotting import lag_plot\n\nplt.figure(figsize=(6, 6))\nlag_plot(df_selected['Mean Sale Price'])\nplt.title('Lag Plot of Mean Sale Price')\nplt.grid(True, which='both', linestyle='--', linewidth=0.5)\nplt.show()\n\n```\n\nBased on the lag plot, there's a strong positive correlation since the points cluster along a diagonal line from bottom-left to top-right. This shows linearity. \n\nIn order to explore more, we utilize the acf and pacf to check the accuracy.\n\n### ACF and PACF plots\n```{python, echo=FALSE}\nfrom statsmodels.graphics.tsaplots import plot_acf, plot_pacf\n\n# ACF plot\nfig, ax = plt.subplots(figsize=(10, 4))\nplot_acf(df_selected['Mean Sale Price'], ax=ax)\nplt.title('ACF of Mean Sale Price')\nplt.show()\n\n# PACF plot\nfig, ax = plt.subplots(figsize=(10, 4))\nplot_pacf(df_selected['Mean Sale Price'], ax=ax)\nplt.title('PACF of Mean Sale Price')\nplt.show()\n\n\n```\n\nFrom here, we can see that the dataset has a correlation and decays slowly. Howeverm for PACF, it decays dramatically. Therefore, we can say that it is stationary. In order to prove this conclusion, we utilize the adf test to ensure the results are the same.\n\n\n### ADF tests\n```{python, echo=FALSE}\nfrom statsmodels.tsa.stattools import adfuller\n\nadf_result = adfuller(df_selected['Mean Sale Price'].values)\nprint(f'ADF Statistic: {adf_result[0]}')\nprint(f'p-value: {adf_result[1]}')\nprint('Critical Values:')\nfor key, value in adf_result[4].items():\n    print(f'\\t{key}: {value}')\n\n```\n\nBased on the result, we can see that the p-value is smaller than the thershold value, this means that we can reject the Null hypothesis. The time series dataset is stationary.\n\nThen, we wish to make analysis for different values to see if they have correlations among each other. A heatmap can also help us to determine the correlations among the sale price, rental price, and homevalue of the dataset.\n\n### Correlation heatmap\n```{python, echo=FALSE}\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n# Filter only numeric columns\ndf_selected = df_selected.rename(columns={\n    \"mean\": \"Mean Rental Price\",\n    \"Log_Mean_Sale_Price\": \"Log Mean Sale Price\"\n})\n\n\nnumeric_cols = df_selected.select_dtypes(include=[float, int])\n\n```\n\n\n```{python, echo=FALSE}\n\n\n# Calculate correlations\ncorr = numeric_cols.corr()\n\n# Set up the matplotlib figure with the desired theme\nplt.figure(figsize=(10, 8))\nsns.set_theme(style=\"white\", rc={\"axes.facecolor\": \"#E0E0E0\", \"grid.color\": \"#E0E0E0\"})\nsns.set_context(\"talk\")\n\n# Draw the heatmap with a color map of choice\nsns.heatmap(corr, annot=True, cmap='coolwarm', linewidths=0.5, linecolor='black')\n\n# Adjust the plot's aesthetics\nplt.title('Correlation Heatmap')\nplt.show()\n\n```\n\n\n### Moving Average\n\n<iframe src=\"./image/EDA/s1.html\" width=\"840\" height=\"600\"></iframe>\n\n\n<iframe src=\"./image/EDA/s2.html\" width=\"840\" height=\"600\"></iframe>\n\n<iframe src=\"./image/EDA/h1.html\" width=\"840\" height=\"600\"></iframe>\n\n<iframe src=\"./image/EDA/h2.html\" width=\"840\" height=\"600\"></iframe>\n\nFrom here, we can see that there is a strong  positive correlation between the Sale price and home value. The higher of the home value, the higher of the sale price. However, the rental price did not have too much correlations with the other two. The possible reason could be the cause of the geographic difference and this could also affect the housing affordability.\n\nIn conclusion, in this section, we provide different observations. And these observations underscore the nature of real estate pricing, incomes, GDP changes througout the years as well as the housing affordability. In addition, different patterns and features are found to identify the trend, seasonality, patterns, and correlations. which allow us to have a more understanding about the dataset.\n\n\n# References and Codes\n- Codes: [Rmd, Python & Qmd](https://github.com/zy236yuz5/ANLY5600-TimeSeries)\n- U.S. Bureau of Economic Analysis, Household saving [W398RC1A027NBEA], retrieved from FRED, Federal Reserve Bank of St. Louis; https://fred.stlouisfed.org/series/W398RC1A027NBEA, September 19, 2023.\n- U.S. Census Bureau, Real Median Household Income in the United States [MEHOINUSA672N], retrieved from FRED, Federal Reserve Bank of St. Louis; https://fred.stlouisfed.org/series/MEHOINUSA672N, September 19, 2023.\n- U.S. Bureau of Economic Analysis, Gross Domestic Product: Implicit Price Deflator [A191RI1Q225SBEA], retrieved from FRED, Federal Reserve Bank of St. Louis; https://fred.stlouisfed.org/series/A191RI1Q225SBEA, September 18, 2023.\n- Zillow Group. Accessed April 19, 2023. “Zillow Research Data.” https://www.zillow.com/research/data/."},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles/layout.css","./styles/layout.css"],"toc":true,"output-file":"EDA.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","theme":"sandstone","title":"Exploratory Data Analysis","navbar":{"left":["about.qmd","Introduction.qmd","DataSources.qmd","DataVis.qmd","EDA.qmd","ARModels.qmd","ASV.qmd","SAF.qmd","GARCH.qmd","TS.qmd","conclusion.qmd","dv.qmd"]}},"extensions":{"book":{"multiFile":true}}}}}